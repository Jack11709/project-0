"use strict";$(function(){function e(){b?(g=$(".track1.player").index(),q=g,console.log(q),g>=21&&(f.play(),$(".feedback").addClass("hide"),y.addClass("player"),y.addClass("winner"),$(".controller").addClass("hide"),$(".playerOneWin").removeClass("hide"),$(".reset").removeClass("hide"),$(".resultBox").removeClass("hide"))):b||(g=$(".track2.player").index())>=21&&(f.play(),$(".feedback").addClass("hide"),u.addClass("player"),u.addClass("winner"),$(".controller").addClass("hide"),$(".playerTwoWin").removeClass("hide"),$(".reset").removeClass("hide"),$(".resultBox").removeClass("hide"))}function a(){b?(s(),b=!1,x=$(".track2"),c.text("Player 2's Turn")):b||(s(),b=!0,x=$(".track1"),c.text("Player 1's Turn"))}function s(){b?(g=$(".track1.player").index(),P>0?(h.play(),r()):0===P&&(l(),P=2)):b||(g=$(".track2.player").index(),w>0?(v.play(),r()):0===w&&(l(),w=2))}function r(){x.eq(g).removeClass("player"),x.eq(g+(Math.floor(3*Math.random())+1)).addClass("player"),e()}function l(){x.eq(g).removeClass("player"),x.eq(g+5).addClass("player"),e()}function d(){0===S?(S=2,b=!0,g=$(".track1.player").index(),c.text("Player 2 has been salted! Player 1 moves again!"),r()):0===_&&(_=2,c.text("Player 1 has been salted! Player 2 moves again!"),g=$(".track2.player").index(),r())}var o=$(".start"),n=$(".move"),t=$(".boost"),i=$(".salt"),c=$(".turn"),y=$(".finish1"),u=$(".finish2"),p=$(".theme")[0];p.src="sounds/closing_theme.mp3";var m=$(".boostSound")[0];m.src="sounds/boost_sound.mp3";var C=$(".saltSound")[0];C.src="sounds/salt_sound.mp3";var h=$(".moveSound")[0];h.src="sounds/move_sound.mp3";var v=$(".moveSound2")[0];v.src="sounds/move_sound2.mp3";var k=$(".errorSound")[0];k.src="sounds/error_sound.mp3";var f=$(".winSound")[0];f.src="sounds/winning_sound.mp3";var x=$(".track1"),b=!0,P=1,w=1,S=1,_=1,g=null,q=null;n.on("click",a),t.on("click",function(){b?1===P?(m.play(),P=0,a()):2===P&&(k.play(),c.text("Player 1 boost already used!")):b||(1===w?(m.play(),w=0,a()):2===w&&(k.play(),c.text("Player 2 boost already used!")))}),i.on("click",function(){b?1===S?(C.play(),S=0,d()):2===S&&(k.play(),c.text("Player 1 has already used Salt!")):b||(1===_?(C.play(),_=0,d()):2===_&&(k.play(),c.text("Player 2 has already used Salt!")))}),o.on("click",function(){$(".instructions").addClass("hide"),$(".board").removeClass("hide"),$(".controller").removeClass("hide"),$(".feedback").removeClass("hide"),p.play()}),$(".reset").on("click",function(){$(".track1").removeClass("player winner"),$(".start1").addClass("player"),P=1,S=1,$(".track2").removeClass("player winner"),$(".start2").addClass("player"),w=1,_=1,$(".controller").removeClass("hide"),$(".feedback").removeClass("hide"),$(".resultBox").addClass("hide"),$(".playerOneWin").addClass("hide"),$(".playerTwoWin").addClass("hide"),p.src="",p.src="sounds/closing_theme.mp3",p.play()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiY2hlY2tXaW5uZXIiLCJwbGF5ZXJPbmVUdXJuIiwiaW5kZXgiLCJwbGF5ZXJPbmVUcmFja2VyIiwiY29uc29sZSIsImFkZENsYXNzIiwiJHdpblNvdW5kIiwiJGZpbmlzaDEiLCJyZW1vdmVDbGFzcyIsInBsYXkiLCIkZmluaXNoMiIsImRldGVybWluZVR1cm4iLCJsb2NhdGVHYXJ5IiwiJHR1cm5UZXh0IiwibW92ZUdhcnkiLCIkbW92ZVNvdW5kIiwiUGxheWVyT25lQm9vc3RSZW1haW5pbmciLCJQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyIsIiRtb3ZlU291bmRUd28iLCIkdHJhY2siLCJlcSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImJvb3N0R2FyeSIsInNhbHRHYXJ5IiwiUGxheWVyT25lU2FsdFJlbWFpbmluZyIsIlBsYXllclR3b1NhbHRSZW1haW5pbmciLCIkc3RhcnQiLCIkbW92ZSIsIiRib29zdCIsIiRzYWx0IiwiJGF1ZGlvVGhlbWUiLCJzcmMiLCIkYm9vc3RTb3VuZCIsIiRzYWx0U291bmQiLCIkZXJyb3JTb3VuZCIsIm9uIl0sIm1hcHBpbmdzIjoiWUFBQUEsR0FBRSxXQW1DQSxRQUFTQyxLQURUQyxHQUNBQyxFQUFTRixFQUFBQSxrQkFBYUUsUUFDcEJDLEVBQWlCRCxFQUNmQSxRQUFRSCxJQUFFSSxHQUNWQSxHQUFBQSxLQUNBQyxFQUFZRCxPQUNaSixFQUFHRyxhQUFZRyxTQUFBLFFBQ2JDLEVBQUFBLFNBQUEsVUFDQVAsRUFBRU0sU0FBYUEsVUFDZkUsRUFBQUEsZUFBQUYsU0FBQSxRQUNBRSxFQUFBQSxpQkFBa0JDLFlBQWxCLFFBQ0FULEVBQUUsVUFBQVMsWUFBZUgsUUFDakJOLEVBQUUsY0FBQVMsWUFBaUJBLFVBRWpCUCxJQUNIQyxFQUFBSCxFQUFBLGtCQUFBRyxVQUNRRCxLQUNUQyxFQUFVTyxPQUNWVixFQUFHRyxhQUFZRyxTQUFBLFFBQ2JDLEVBQUFBLFNBQUEsVUFDQVAsRUFB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QUNBRixFQUFBQSxPQUhGWixFQUlVYyxLQUFBQSx1Q0FPZEMsRUFBQVMsR0FBQSxRQUFBLFdBR0V0QyxFQUFFLGlCQUFpQk0sU0FBUyxRQUQ5QnVCLEVBQUFBLFVBQVVwQixZQUFTLFFBQ2pCVCxFQUFFLGVBQUZTLFlBQTRCLFFBQzVCVCxFQUFFLGFBQVVTLFlBQVksUUFFeEJULEVBQUVVLFNBS0pWLEVBQUEsVUFBQXNDLEdBQUEsUUFBQSxXQUdFdEMsRUFBRSxXQUFXUyxZQUFZLGlCQUR6QlQsRUFBQSxXQUFhTSxTQUFRLFVBQ3JCTixFQUF5QixFQUN6QkEsRUFBc0IsRUFDdEJpQixFQUFBQSxXQUFBQSxZQUFBQSxpQkFDQVUsRUFBQUEsV0FBQUEsU0FBQUEsVUFDQTNCLEVBQXlCLEVBQ3pCQSxFQUFzQixFQUN0QmtCLEVBQUFBLGVBQUFBLFlBQUEsUUFDQVUsRUFBQUEsYUFBQUEsWUFBQSxRQUNBNUIsRUFBRSxjQUFGTSxTQUFpQkcsUUFDakJULEVBQUUsaUJBQWFTLFNBQVksUUFDM0JULEVBQUUsaUJBQWNNLFNBQVMsUUFDekJOLEVBQUVrQyxJQUFGLEdBQ0FsQyxFQUFFa0MsSUFBRiwyQkFDQUQsRUFBWUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJCgoKSA9PiB7XG4gIC8vIExpc3Qgb2YgdmFyaWFibGVzIG5lZWRlZCBmb3IgdGhlIGdhbWVcbiAgY29uc3QgJHN0YXJ0ID0gJCgnLnN0YXJ0Jyk7XG4gIGNvbnN0ICRtb3ZlID0gJCgnLm1vdmUnKTtcbiAgY29uc3QgJGJvb3N0ID0gJCgnLmJvb3N0Jyk7XG4gIGNvbnN0ICRzYWx0ID0gJCgnLnNhbHQnKTtcbiAgY29uc3QgJHR1cm5UZXh0ID0gJCgnLnR1cm4nKTtcbiAgY29uc3QgJGZpbmlzaDEgPSAkKCcuZmluaXNoMScpO1xuICBjb25zdCAkZmluaXNoMiA9ICQoJy5maW5pc2gyJyk7XG4gIC8vIEF1ZGlvIHZhcmlhYmxlcy5cbiAgY29uc3QgJGF1ZGlvVGhlbWUgPSAkKCcudGhlbWUnKVswXTtcbiAgJGF1ZGlvVGhlbWUuc3JjID0gJ3NvdW5kcy9jbG9zaW5nX3RoZW1lLm1wMyc7XG4gIGNvbnN0ICRib29zdFNvdW5kID0gJCgnLmJvb3N0U291bmQnKVswXTtcbiAgJGJvb3N0U291bmQuc3JjID0gJ3NvdW5kcy9ib29zdF9zb3VuZC5tcDMnO1xuICBjb25zdCAkc2FsdFNvdW5kID0gJCgnLnNhbHRTb3VuZCcpWzBdO1xuICAkc2FsdFNvdW5kLnNyYyA9ICdzb3VuZHMvc2FsdF9zb3VuZC5tcDMnO1xuICBjb25zdCAkbW92ZVNvdW5kID0gJCgnLm1vdmVTb3VuZCcpWzBdO1xuICAkbW92ZVNvdW5kLnNyYyA9ICdzb3VuZHMvbW92ZV9zb3VuZC5tcDMnO1xuICBjb25zdCAkbW92ZVNvdW5kVHdvID0gJCgnLm1vdmVTb3VuZDInKVswXTtcbiAgJG1vdmVTb3VuZFR3by5zcmMgPSAnc291bmRzL21vdmVfc291bmQyLm1wMyc7XG4gIGNvbnN0ICRlcnJvclNvdW5kID0gJCgnLmVycm9yU291bmQnKVswXTtcbiAgJGVycm9yU291bmQuc3JjID0gJ3NvdW5kcy9lcnJvcl9zb3VuZC5tcDMnO1xuICBjb25zdCAkd2luU291bmQgPSAkKCcud2luU291bmQnKVswXTtcbiAgJHdpblNvdW5kLnNyYyA9ICdzb3VuZHMvd2lubmluZ19zb3VuZC5tcDMnO1xuICAvLyBWYXJpYWJsZXMgdGhhdCB1cGRhdGUgZHVyaW5nIHRoZSBnYW1lLCBiYXNlZCBvbiB0dXJuL2FiaWx0aWVzIHVzZWQuXG4gIGxldCAkdHJhY2sgPSAkKCcudHJhY2sxJyk7XG4gIGxldCBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgbGV0IFBsYXllck9uZUJvb3N0UmVtYWluaW5nID0gMTtcbiAgbGV0IFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID0gMTtcbiAgbGV0IFBsYXllck9uZVNhbHRSZW1haW5pbmcgPSAxO1xuICBsZXQgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9IDE7XG4gIGxldCBpbmRleCA9IG51bGw7XG4gIGxldCBwbGF5ZXJPbmVUcmFja2VyID0gbnVsbDtcblxuICAvLyBmdW5jdGlvbiB0aGF0IGNoZWNrcyB0byBzZWUgaWYgZWl0aGVyIHBsYXllciBpcyBpbiBhIHdpbm5pbmcgcG9zaXRpb24sIHBvc3Rpb24gaXMgZGV0ZXJtaW5lcyBpZiB0aGUgaW5kZXggb2YgdGhlIG9jY3VwaWVkIHNwYWNlIGlzIGVxdWFsIHRvIG9yIGdyZWF0ZXIgdGhhbiAyMSh0aGUgZmluaXNoIGxpbmUpLCB0aGVyZSBhcmUgaGlkZGVuIHJ1biBvZmYgYm94ZXMgdGhhdCBhbHNvIGV2YXVsYXRlIHRoZSB3aW5uZXIgaWYgdGhlIGZpbmFsIG1vdmUgd291bGQgb2YgdGFrZSB0aGVuIHBsYXllciBwYXNzZWQgaW5kZXggMjEuXG4gIGZ1bmN0aW9uIGNoZWNrV2lubmVyKCl7XG4gICAgaWYocGxheWVyT25lVHVybil7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgIHBsYXllck9uZVRyYWNrZXIgPSBpbmRleDtcbiAgICAgIGNvbnNvbGUubG9nKHBsYXllck9uZVRyYWNrZXIpO1xuICAgICAgaWYoaW5kZXggPj0gMjEpe1xuICAgICAgICAkd2luU291bmQucGxheSgpO1xuICAgICAgICAkKCcuZmVlZGJhY2snKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAkZmluaXNoMS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICAgICRmaW5pc2gxLmFkZENsYXNzKCd3aW5uZXInKTtcbiAgICAgICAgJCgnLmNvbnRyb2xsZXInKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAkKCcucGxheWVyT25lV2luJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgJCgnLnJlc2V0JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgJCgnLnJlc3VsdEJveCcpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmKCFwbGF5ZXJPbmVUdXJuKXtcbiAgICAgIGluZGV4ID0gJCgnLnRyYWNrMi5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgaWYoaW5kZXggPj0gMjEpe1xuICAgICAgICAkd2luU291bmQucGxheSgpO1xuICAgICAgICAkKCcuZmVlZGJhY2snKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAkZmluaXNoMi5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICAgICRmaW5pc2gyLmFkZENsYXNzKCd3aW5uZXInKTtcbiAgICAgICAgJCgnLmNvbnRyb2xsZXInKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAkKCcucGxheWVyVHdvV2luJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgJCgnLnJlc2V0JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgJCgnLnJlc3VsdEJveCcpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbi8vIHRoaXMgZnVuY3Rpb24gZGV0ZXJtaW5lcyB3aG9zIHR1cm4gaXQgaXMgYW5kIHVwZGF0ZXMgdGhlIG9uIHNjcmVlbiBwb3JtcHQgYWNjb3JkaW5nbHksIGl0IGlzIGZpcmVkIGRpcmVjdGx5IGFmdGVyIHRoZSBjbGljayBldmVudCBvbiBtb3ZlLCBhbmQgaXQgZmlyZWQgaWYgYSBib29zdCBoYXBwZW5zIGFmdGVyIHVwZGF0aW5nIHRoZSBib29zdCBib29sZWFuLCBpdCB3b3JrcyBvbiB0aGUgb25lIHZhcmlhYmxlIHdoaWNoIGdldHMgdXBkYXRlZCBvZiBwbGF5ZXJPbmVUdXJuIGZyb20gdHJ1ZSB0byBmYWxzZS5cbiAgZnVuY3Rpb24gZGV0ZXJtaW5lVHVybigpe1xuICAgIGlmKHBsYXllck9uZVR1cm4pe1xuICAgICAgbG9jYXRlR2FyeSgpO1xuICAgICAgcGxheWVyT25lVHVybiA9IGZhbHNlO1xuICAgICAgJHRyYWNrID0gJCgnLnRyYWNrMicpO1xuICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAyXFwncyBUdXJuJyk7XG4gICAgfSBlbHNlIGlmKCFwbGF5ZXJPbmVUdXJuKXtcbiAgICAgIGxvY2F0ZUdhcnkoKTtcbiAgICAgIHBsYXllck9uZVR1cm4gPSB0cnVlO1xuICAgICAgJHRyYWNrID0gJCgnLnRyYWNrMScpO1xuICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxXFwncyBUdXJuJyk7XG4gICAgfVxuICB9XG5cbi8vIFRoaXMgZnVuY3Rpb24gbG9jYXRlcyBnYXJ5IG9uIHRoZSBib2FyZCwgdGhlIHNlcGVyYXRlIHBhcnRzIG9mIHRoZSBpZiBlbHNlIHN0YXRlbWVudCBydW4gYmFzZWQgb24gd2hpY2ggcGxheWVycyB0dXJuIGl0IGlzLCBvbmNlIGRvaW5nIHNvIGl0IGZpcmVzIG9mZiB0aGUgbW92ZUdhcnkgZnVuY3Rpb24uIE9yIGlmIGl0IGRldGVjdHMgdGhlIGJvb3N0IGhhcyBiZWVuIHVzZWQoYnkgaXQgdXBkYXRpbmcgZnJvbSAxIHRvIDAgb24gdGhlIGJvb3N0IGJ1dHRvbiBjbGljaykgaWYgZmlyZXMgb2ZmIHRoZSBib29zdEdhcnkgZnVuY3Rpb24gaW5zdGVhZCwgaXQgdGhlbiB1cGRhdGVzIHRoZSBib29zdCBjb3VudCB0byAyIHdoaWNoIGluZm9ybXMgdGhlIHVzZXIgdGhlIGJvb3N0IGhhcyBiZWVuIHVzZWQgd2hlbiBjbGlja2VkLlxuICBmdW5jdGlvbiBsb2NhdGVHYXJ5KCl7XG4gICAgaWYocGxheWVyT25lVHVybil7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgIGlmKFBsYXllck9uZUJvb3N0UmVtYWluaW5nID4gMCl7XG4gICAgICAgICRtb3ZlU291bmQucGxheSgpO1xuICAgICAgICBtb3ZlR2FyeSgpO1xuICAgICAgfSBlbHNlIGlmKFBsYXllck9uZUJvb3N0UmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgIGJvb3N0R2FyeSgpO1xuICAgICAgICBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9IDI7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICghcGxheWVyT25lVHVybil7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazIucGxheWVyJykuaW5kZXgoKTtcbiAgICAgIGlmKFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID4gMCl7XG4gICAgICAgICRtb3ZlU291bmRUd28ucGxheSgpO1xuICAgICAgICBtb3ZlR2FyeSgpO1xuICAgICAgfWVsc2UgaWYoUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPT09IDApIHtcbiAgICAgICAgYm9vc3RHYXJ5KCk7XG4gICAgICAgIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID0gMjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBUaGlzIGZ1bmN0aW9uIG1vdmVzIGdhcnksIGl0IGZpcnN0IGRldGVybWluZXMgaWYgaXQgaXMgYSByZWd1bGFyIG1vdmUgb3IgYSBib29zdCBtb3ZlLCBpZiBpdCBpcyBhIHJlZ3VsYXIgbW92ZSBpdCBtb3ZlcyB0aGUgY3VycmVudCBwbGF5ZXJzIEdhcnkgYmV0d2VlbiAxIGFuZCAzIGluZGV4IHNwYWNlcyBhbG9uZywgZmluYWxseSwgaXQgcnVucyB0aGUgY2hlY2tXaW5uZXIgZnVuY3Rpb24gdG8gc2VlIGlmIGEgd2luIGNvbmRpdGlvbiBoYXMgYmVlbiBtZXQuXG4gIGZ1bmN0aW9uIG1vdmVHYXJ5KCkge1xuICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICR0cmFjay5lcShpbmRleCArIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKSArIDEgKSApLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICBjaGVja1dpbm5lcigpO1xuICB9XG5cbi8vIFRoaXMgZnVuY3Rpb24gZmlyZXMgb2ZmIGlmIHRoZSBib29zdCBidXR0b24gaXMgY2xpY2tlZCBvbiwgdGhlIGNsaWNrIGV2ZW50IHVwZGF0ZXMgdGhlIGJvb3N0IGNvdW50IGFuZCB0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuIHRoZSBsb2NhdGVHYXJ5IGlzIHJ1bm5pbmcuIEl0IGd1YXJlbnRlZXMgdGhlIHVzZXIgYSBtb3ZlIG9mIDUgc3BhY2VzIHRoZW4gcnVucyB0aGUgY2hlY2sgd2lubmVyIGZ1bmN0aW9uIHRvIHNlZSBpZiBhIHdpbiBjb25kaXRpb24gaGFzIGJlZW4gbWV0LlxuICBmdW5jdGlvbiBib29zdEdhcnkoKSB7XG4gICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgJHRyYWNrLmVxKGluZGV4ICsgNSkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgIGNoZWNrV2lubmVyKCk7XG4gIH1cblxuLy8gdGhlIHNhbHRHYXJ5IGZ1bmN0aW9uLlxuICBmdW5jdGlvbiBzYWx0R2FyeSgpIHtcbiAgICBpZihQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAwKXtcbiAgICAgIFBsYXllck9uZVNhbHRSZW1haW5pbmcgPSAyO1xuICAgICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMiBoYXMgYmVlbiBzYWx0ZWQhIFBsYXllciAxIG1vdmVzIGFnYWluIScpO1xuICAgICAgbW92ZUdhcnkoKTtcbiAgICB9IGVsc2UgaWYoUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMCl7XG4gICAgICBQbGF5ZXJUd29TYWx0UmVtYWluaW5nID0gMjtcbiAgICAgIC8vIHBsYXllck9uZVR1cm4gPSBmYWxzZTtcbiAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMSBoYXMgYmVlbiBzYWx0ZWQhIFBsYXllciAyIG1vdmVzIGFnYWluIScpO1xuICAgICAgaW5kZXggPSAkKCcudHJhY2syLnBsYXllcicpLmluZGV4KCk7XG4gICAgICBtb3ZlR2FyeSgpO1xuICAgIH1cbiAgfVxuLy8gdmFyaW91cyBldmVudCBsaXN0ZW5lcnMgYmVsb3cuXG5cbi8vIFRoaXMgaXMgdGhlIGNsaWNrIGV2ZW50IGZvciB0aGUgbW92ZSBidXR0b24sIHdoZW4gY2xpY2tlZCBpdCBmaXJlcyBvZmYgdGhlIGRldGVybWluZVR1cm4gZnVuY3Rpb24gd2hpY2ggc2V0cyBpbiBtb3Rpb24gdGhlIGxvY2F0ZUdhcnkgYW5kIG1vdmVHYXJ5IGZ1bmN0aW9ucy5cbiAgJG1vdmUub24oJ2NsaWNrJywgZGV0ZXJtaW5lVHVybik7XG5cbi8vIHRoaXMgaXMgdGhlIGNsaWNrIGV2ZW50IGZvciB0aGUgYm9vc3QgYnV0dG9uLCB3aGVuIGNsaWNrZWQgaXQgY2hlY2tzIGZpcnN0IHRvIHNlZSBpZiB0aGUgcGxheWVyIGhhcyBhbHJlYWR5IHVzZWQgdGhlaXIgYm9vc3QsIGlmIG5vdCBpdCB1cGRhdGVzIHRoYXQgaW5mb3JtYXRpb24gYW5kIHJ1bnMgdGhlIGRldGVybWluZVR1cm4gZnVuY3Rpb24gbGlrZSBhIG5vcm1hbCBtb3ZlLCB3aGVuIHRoaXMgcmVhY2hlcyB0aGUgbG9jYXRlR2FyeSBmdW5jdGlvbiwgaXQgdGFrZXMgbm90ZSB0aGF0IHRoZSBib29zdCBoYXMgYmVlbiB1c2VkIHRvIGZpcmUgb2ZmIHRoZSBib29zdEdhcnkgZnVuY3Rpb24gaW5zdGVhZCBvZiB0aGUgbW92ZUdhcnkgZnVuY3Rpb24uIEl0IHRoZW4gdXBkYXRlcyB0aGUgYm9vc3QgcmVtYWluaW5nIGFnYWluLCBzbyB0aGF0IGlmIGFub3RoZXIgYm9vc3QgaXMgYXR0ZW1wdGVkLCBpdCBpbmZvcm1zIHRoZSB1c2VyIHRoYXQgdGhlaXIgYm9vc3QgaGFzIGFscmVhZHkgYmVlbiB1c2VkLlxuICAkYm9vc3Qub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgIGlmKHBsYXllck9uZVR1cm4pe1xuICAgICAgaWYoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAkYm9vc3RTb3VuZC5wbGF5KCk7XG4gICAgICAgIFBsYXllck9uZUJvb3N0UmVtYWluaW5nID0gMDtcbiAgICAgICAgZGV0ZXJtaW5lVHVybigpO1xuICAgICAgfSBlbHNlIGlmKFBsYXllck9uZUJvb3N0UmVtYWluaW5nID09PSAyKXtcbiAgICAgICAgJGVycm9yU291bmQucGxheSgpO1xuICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDEgYm9vc3QgYWxyZWFkeSB1c2VkIScpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoIXBsYXllck9uZVR1cm4pe1xuICAgICAgaWYoUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAkYm9vc3RTb3VuZC5wbGF5KCk7XG4gICAgICAgIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID0gMDtcbiAgICAgICAgZGV0ZXJtaW5lVHVybigpO1xuICAgICAgfSBlbHNlIGlmKFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAyKXtcbiAgICAgICAgJGVycm9yU291bmQucGxheSgpO1xuICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDIgYm9vc3QgYWxyZWFkeSB1c2VkIScpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgLy8gYmVsb3cgaXMgdGhlIGV2ZW50IGxpc3RlbmVyIGZvciB0aGUgc2FsdCBhYmlsaXR5LiBVc2luZyB0aGlzIHdpbGwgc3RvcCB5b3VyIG9wcG9uZW50cyBuZXh0IHR1cm4gYW5kIGdpdmUgZ2FyeSBhIG5vcm1hbCBnYXJ5TW92ZSB3aGlsZSB1c2luZyBpdC4gSWYgYSBwbGF5ZXIgaGFzIGFscmVhZHkgdXNlZCB0aGVpciBzYWx0IGl0IGluZm9ybXMgdGhlbSBvbiB0aGUgJHR1cm5UZXh0IGZlZWRiYWNrLlxuICAkc2FsdC5vbignY2xpY2snLCgpID0+IHtcbiAgICBpZihwbGF5ZXJPbmVUdXJuKXtcbiAgICAgIGlmKFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAkc2FsdFNvdW5kLnBsYXkoKTtcbiAgICAgICAgUGxheWVyT25lU2FsdFJlbWFpbmluZyA9IDA7XG4gICAgICAgIHNhbHRHYXJ5KCk7XG4gICAgICB9IGVsc2UgaWYoUGxheWVyT25lU2FsdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICRlcnJvclNvdW5kLnBsYXkoKTtcbiAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIGhhcyBhbHJlYWR5IHVzZWQgU2FsdCEnKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYoIXBsYXllck9uZVR1cm4pe1xuICAgICAgaWYoUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICRzYWx0U291bmQucGxheSgpO1xuICAgICAgICBQbGF5ZXJUd29TYWx0UmVtYWluaW5nID0gMDtcbiAgICAgICAgc2FsdEdhcnkoKTtcbiAgICAgIH0gZWxzZSBpZihQbGF5ZXJUd29TYWx0UmVtYWluaW5nID09PSAyKXtcbiAgICAgICAgJGVycm9yU291bmQucGxheSgpO1xuICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDIgaGFzIGFscmVhZHkgdXNlZCBTYWx0IScpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgLy8gQ2xpY2sgZXZlbnQgdG8gc3RhcnQgdGhlIGdhbWUsIHJlbW92ZXMgdGhlIGluc3RydWN0aW9uIHBhZ2UgYW5kIHRoZW4gc2hvd3MgdGhlIHJhY2V0cmFjaywgZmVlZGJhY2sgYm94IGFuZCBjb250cm9sbGVyLlxuXG4gICRzdGFydC5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgJCgnLmluc3RydWN0aW9ucycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJCgnLmJvYXJkJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuY29udHJvbGxlcicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgJCgnLmZlZWRiYWNrJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAvLyAkYXVkaW9UaGVtZS5zcmMgPSAnc291bmRzL2Nsb3NpbmdfdGhlbWUubXAzJztcbiAgICAkYXVkaW9UaGVtZS5wbGF5KCk7XG4gIH0pO1xuXG4gIC8vIEV2ZW50IGxpc3RlbmVyIGZvciB0aGUgcmVzZXQgYnV0dG9uLCBpdCBiYXNpY2FsbHkgaGlkZXMgYWxsIG9mIHRoZSBmZWVkYmFjayBmcm9tIHRoZSByZW1haW5pbmcgZ2FtZSBhbmQgbW92ZXMgYm90aCBwbGF5ZXIgaWNvbnMgYmFjayB0byB0aGUgc3RhcnQgbGluZSwgaXQgYWxzbyByZXNldHMgdGhlIHNhbHQgYW5kIGJvb3N0IGNvdW50ZXJzIHRvIDEgc28gdGhhdCB0aGV5IGNhbiBub3cgYmUgdXNlZCBhZ2Fpbi5cblxuICAkKCcucmVzZXQnKS5vbignY2xpY2snLCgpID0+IHtcbiAgICAkKCcudHJhY2sxJykucmVtb3ZlQ2xhc3MoJ3BsYXllciB3aW5uZXInKTtcbiAgICAkKCcuc3RhcnQxJykuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgIFBsYXllck9uZUJvb3N0UmVtYWluaW5nID0gMTtcbiAgICBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0xO1xuICAgICQoJy50cmFjazInKS5yZW1vdmVDbGFzcygncGxheWVyIHdpbm5lcicpO1xuICAgICQoJy5zdGFydDInKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPSAxO1xuICAgIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPSAxO1xuICAgICQoJy5jb250cm9sbGVyJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuZmVlZGJhY2snKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICQoJy5yZXN1bHRCb3gnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICQoJy5wbGF5ZXJPbmVXaW4nKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICQoJy5wbGF5ZXJUd29XaW4nKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICRhdWRpb1RoZW1lLnNyYyA9ICcnO1xuICAgICRhdWRpb1RoZW1lLnNyYyA9ICdzb3VuZHMvY2xvc2luZ190aGVtZS5tcDMnO1xuICAgICRhdWRpb1RoZW1lLnBsYXkoKTtcbiAgfSk7XG59KTtcbiJdfQ==
