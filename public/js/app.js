"use strict";$(function(){function a(){G?(W=$(".track1.player").index())>=21&&(P.play(),$(".feedback").addClass("hide"),C.addClass("player"),C.addClass("winner"),$(".controller").addClass("hide"),$(".playerOneWin").removeClass("hide"),$(".reset").removeClass("hide"),$(".resultBox").removeClass("hide")):G||(W=$(".track2.player").index())>=21&&(P.play(),$(".feedback").addClass("hide"),v.addClass("player"),v.addClass("winner"),$(".controller").addClass("hide"),$(".reset").removeClass("hide"),$(".resultBox").removeClass("hide"),O?O&&$(".aiWin").removeClass("hide"):$(".playerTwoWin").removeClass("hide"))}function e(){G?(s(),G=!1,g=$(".track2"),u.text("Player 2's Turn")):G||(s(),G=!0,g=$(".track1"),u.text("Player 1's Turn"))}function s(){G?(W=$(".track1.player").index(),w>0?(k.play(),l()):0===w&&(r(),w=2)):G||(W=$(".track2.player").index(),S>0?(q.play(),l()):0===S&&(r(),S=2))}function l(){O?O&&(k.play(),u.text("Player 1 get's moving!"),g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),a(),(W=$(".track1.player").index())<21&&t()):(g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),a())}function r(){O?O&&(x.play(),g.eq(W).removeClass("player"),g.eq(W+5).addClass("player"),a(),t()):(g.eq(W).removeClass("player"),g.eq(W+5).addClass("player"),a())}function o(){O?O&&0===_&&(G=!0,g=$(".track1"),W=$(".track1.player").index(),u.text("Mecha Gary has been salted! Player 1 moves again!"),g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),_=2,a()):0===_?(_=2,G=!0,W=$(".track1.player").index(),u.text("Player 2 has been salted! Player 1 moves again!"),l()):0===T&&(T=2,u.text("Player 1 has been salted! Player 2 moves again!"),W=$(".track2.player").index(),l())}function t(){B=W,g=$(".track2"),W=$(".track2.player").index(),setTimeout(function(){B<=4?(q.play(),g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),u.text("Mecha Gary has made his move!"),G=!1,a(),G=!0):B>4&&B<15?(j=Math.ceil(5*Math.random()),j<=2?(q.play(),g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),u.text("Mecha Gary has made his move!"),G=!1,a(),G=!0):j<=4&&1===S?(x.play(),g.eq(W).removeClass("player"),g.eq(W+5).addClass("player"),u.text("Mecha Gary has boosted!"),G=!1,S=2,a(),G=!0):j<=4&&2===w?(q.play(),g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),u.text("Mecha Gary has made his move!"),G=!1,a(),G=!0):5===j&&1===T?(u.text("Mecha Gary has salted you, he moves again!"),M.play(),T=2,g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),setTimeout(function(){t()},1e3),G=!1,a(),G=!0):5===j&&2===T&&(q.play(),g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),u.text("Mecha Gary has made his move!"),G=!1,a(),G=!0)):B>=15&&(j=Math.ceil(5*Math.random()),j<=3&&1===S?(x.play(),g.eq(W).removeClass("player"),g.eq(W+5).addClass("player"),u.text("Mecha Gary has boosted!"),G=!1,S=2,a()):j<=3&&2===S&&1===T?(u.text("Mecha Gary has salted you, he moves again!"),M.play(),T=2,g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),setTimeout(function(){t()},750),G=!1,a(),G=!0):j<=3&&2===S?(q.play(),g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),u.text("Mecha Gary has made his move!"),G=!1,a(),G=!0):j<=5&&1===_?(u.text("Mecha Gary has salted you, he moves again!"),M.play(),T=2,g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),setTimeout(function(){t()},750),G=!1,a(),G=!0):j<=5&&2===_&&(q.play(),g.eq(W).removeClass("player"),g.eq(W+(Math.floor(3*Math.random())+1)).addClass("player"),u.text("Mecha Gary has made his move!"),G=!1,a(),G=!0))},1500)}function d(){O?O&&h.on("click",function(){console.log("1p move run"),g=$(".track1"),W=$(".track1.player").index(),l()}):h.on("click",function(){console.log("2p move run"),e()})}function n(){O?O&&p.on("click",function(){1===w?(console.log("1p boost run"),g=$(".track1"),W=$(".track1.player").index(),w=2,u.text("Player 1 uses boost!"),r()):2===w&&(b.play(),u.text("Player 1 has already used boost!"))}):p.on("click",function(){G?1===w?(x.play(),w=0,e()):2===w&&(b.play(),u.text("Player 1 boost already used!")):G||(1===S?(x.play(),S=0,e()):2===S&&(b.play(),u.text("Player 2 boost already used!")))})}function y(){O?O&&m.on("click",function(){1===_?(_=0,M.play(),o()):2===_&&(b.play(),u.text("Player 1 has already used Salt!"))}):m.on("click",function(){G?1===_?(M.play(),_=0,o()):2===_&&(b.play(),u.text("Player 1 has already used Salt!")):G||(1===T?(M.play(),T=0,o()):2===T&&(b.play(),u.text("Player 2 has already used Salt!")))})}var i=$(".startbtn2"),c=$(".startbtn1"),h=$(".move"),p=$(".boost"),m=$(".salt"),u=$(".turn"),C=$(".finish1"),v=$(".finish2"),f=$(".theme")[0];f.src="sounds/closing_theme.mp3";var x=$(".boostSound")[0];x.src="sounds/boost_sound.mp3";var M=$(".saltSound")[0];M.src="sounds/salt_sound.mp3";var k=$(".moveSound")[0];k.src="sounds/move_sound.mp3";var q=$(".moveSound2")[0];q.src="sounds/move_sound2.mp3";var b=$(".errorSound")[0];b.src="sounds/error_sound.mp3";var P=$(".winSound")[0];P.src="sounds/winning_sound.mp3";var g=$(".track1"),G=!0,w=1,S=1,_=1,T=1,W=null,B=null,O=!1,j=null;i.on("click",function(){$(".instructions").addClass("hide"),$(".board").removeClass("hide"),$(".controller").removeClass("hide"),$(".feedback").removeClass("hide"),d(),n(),y(),f.play()}),c.on("click",function(){O=!0,$(".instructions").addClass("hide"),$(".board").removeClass("hide"),$(".controller").removeClass("hide"),$(".feedback").removeClass("hide"),d(),n(),y(),u.text("Make your first move!"),f.play()}),O?O&&$(".reset").on("click",function(){$(".track1").removeClass("player winner"),$(".start1").addClass("player"),w=1,_=1,$(".track2").removeClass("player winner"),$(".start2").addClass("player"),S=1,T=1,$(".controller").removeClass("hide"),$(".feedback").removeClass("hide"),$(".resultBox").addClass("hide"),$(".playerOneWin").addClass("hide"),$(".aiWin").addClass("hide"),u.text("Player 1's time to shine!"),f.src="",f.src="sounds/closing_theme.mp3",f.play()}):$(".reset").on("click",function(){$(".track1").removeClass("player winner"),$(".start1").addClass("player"),w=1,_=1,$(".track2").removeClass("player winner"),$(".start2").addClass("player"),S=1,T=1,$(".controller").removeClass("hide"),$(".feedback").removeClass("hide"),$(".resultBox").addClass("hide"),$(".playerOneWin").addClass("hide"),$(".playerTwoWin").addClass("hide"),f.src="",f.src="sounds/closing_theme.mp3",f.play()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiY2hlY2tXaW5uZXIiLCJwbGF5ZXJPbmVUdXJuIiwiaW5kZXgiLCJwbGF5IiwiYWRkQ2xhc3MiLCIkd2luU291bmQiLCIkZmluaXNoMSIsInJlbW92ZUNsYXNzIiwiJGZpbmlzaDIiLCJpc09uZVBsYXllciIsImRldGVybWluZVR1cm4iLCJsb2NhdGVHYXJ5IiwiJHR1cm5UZXh0IiwibW92ZUdhcnkiLCIkbW92ZVNvdW5kIiwiUGxheWVyT25lQm9vc3RSZW1haW5pbmciLCJQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyIsIiRtb3ZlU291bmRUd28iLCJlcSIsInRleHQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCIkdHJhY2siLCJib29zdEdhcnkiLCIkYm9vc3RTb3VuZCIsInNhbHRHYXJ5IiwiUGxheWVyT25lU2FsdFJlbWFpbmluZyIsIlBsYXllclR3b1NhbHRSZW1haW5pbmciLCJhaU1vdmUiLCJwbGF5ZXJPbmVUcmFja2VyIiwic2V0VGltZW91dCIsImFpTW92ZURlY2lkZXIiLCIkc2FsdFNvdW5kIiwiY2VpbCIsIm1vdmVFdmVudCIsIiRtb3ZlIiwib24iLCJsb2ciLCJjb25zb2xlIiwiYm9vc3RFdmVudCIsIiRib29zdCIsIiRlcnJvclNvdW5kIiwic2FsdEV2ZW50IiwiJHNhbHQiLCIkc3RhcnQiLCIkc3RhcnQxUGxheWVyIiwiJGF1ZGlvVGhlbWUiLCJzcmMiXSwibWFwcGluZ3MiOiJZQUFBQSxHQUFFLFdBc0NBLFFBQVNDLEtBRFRDLEdBQ0FDLEVBQVNGLEVBQUFBLGtCQUFhRSxVQUNqQkQsS0FDREMsRUFBVUMsT0FDVkosRUFBR0csYUFBWUUsU0FBQSxRQUNiQyxFQUFBQSxTQUFBLFVBQ0FOLEVBQUVLLFNBQWFBLFVBQ2ZFLEVBQUFBLGVBQUFGLFNBQUEsUUFDQUUsRUFBQUEsaUJBQWtCQyxZQUFsQixRQUNBUixFQUFFLFVBQUFRLFlBQWVILFFBQ2pCTCxFQUFFLGNBQUFRLFlBQWlCQSxTQUVqQk4sSUFD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LEVBQUUsaUJBQWlCSyxTQUFTLFFBQzVCTCxFQUFFaUQsSUFBRixHQUNBRCxFQUFZQyxJQUFNLDJCQUNsQkQsRUFBWUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJCgoKSA9PiB7XG4gIC8vIExpc3Qgb2YgdmFyaWFibGVzIG5lZWRlZCBmb3IgdGhlIGdhbWVcbiAgY29uc3QgJHN0YXJ0ID0gJCgnLnN0YXJ0YnRuMicpO1xuICBjb25zdCAkc3RhcnQxUGxheWVyID0gJCgnLnN0YXJ0YnRuMScpO1xuICBjb25zdCAkbW92ZSA9ICQoJy5tb3ZlJyk7XG4gIGNvbnN0ICRib29zdCA9ICQoJy5ib29zdCcpO1xuICBjb25zdCAkc2FsdCA9ICQoJy5zYWx0Jyk7XG4gIGNvbnN0ICR0dXJuVGV4dCA9ICQoJy50dXJuJyk7XG4gIGNvbnN0ICRmaW5pc2gxID0gJCgnLmZpbmlzaDEnKTtcbiAgY29uc3QgJGZpbmlzaDIgPSAkKCcuZmluaXNoMicpO1xuICAvLyBBdWRpbyB2YXJpYWJsZXMuXG4gIGNvbnN0ICRhdWRpb1RoZW1lID0gJCgnLnRoZW1lJylbMF07XG4gICRhdWRpb1RoZW1lLnNyYyA9ICdzb3VuZHMvY2xvc2luZ190aGVtZS5tcDMnO1xuICBjb25zdCAkYm9vc3RTb3VuZCA9ICQoJy5ib29zdFNvdW5kJylbMF07XG4gICRib29zdFNvdW5kLnNyYyA9ICdzb3VuZHMvYm9vc3Rfc291bmQubXAzJztcbiAgY29uc3QgJHNhbHRTb3VuZCA9ICQoJy5zYWx0U291bmQnKVswXTtcbiAgJHNhbHRTb3VuZC5zcmMgPSAnc291bmRzL3NhbHRfc291bmQubXAzJztcbiAgY29uc3QgJG1vdmVTb3VuZCA9ICQoJy5tb3ZlU291bmQnKVswXTtcbiAgJG1vdmVTb3VuZC5zcmMgPSAnc291bmRzL21vdmVfc291bmQubXAzJztcbiAgY29uc3QgJG1vdmVTb3VuZFR3byA9ICQoJy5tb3ZlU291bmQyJylbMF07XG4gICRtb3ZlU291bmRUd28uc3JjID0gJ3NvdW5kcy9tb3ZlX3NvdW5kMi5tcDMnO1xuICBjb25zdCAkZXJyb3JTb3VuZCA9ICQoJy5lcnJvclNvdW5kJylbMF07XG4gICRlcnJvclNvdW5kLnNyYyA9ICdzb3VuZHMvZXJyb3Jfc291bmQubXAzJztcbiAgY29uc3QgJHdpblNvdW5kID0gJCgnLndpblNvdW5kJylbMF07XG4gICR3aW5Tb3VuZC5zcmMgPSAnc291bmRzL3dpbm5pbmdfc291bmQubXAzJztcbiAgLy8gVmFyaWFibGVzIHRoYXQgdXBkYXRlIGR1cmluZyB0aGUgZ2FtZSwgYmFzZWQgb24gdHVybi9hYmlsdGllcyB1c2VkLlxuICBsZXQgJHRyYWNrID0gJCgnLnRyYWNrMScpO1xuICBsZXQgcGxheWVyT25lVHVybiA9IHRydWU7XG4gIGxldCBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9IDE7XG4gIGxldCBQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9IDE7XG4gIGxldCBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0gMTtcbiAgbGV0IFBsYXllclR3b1NhbHRSZW1haW5pbmcgPSAxO1xuICBsZXQgaW5kZXggPSBudWxsO1xuICBsZXQgcGxheWVyT25lVHJhY2tlciA9IG51bGw7XG4gIGxldCBpc09uZVBsYXllciA9IGZhbHNlO1xuICBsZXQgYWlNb3ZlRGVjaWRlciA9IG51bGw7XG5cbiAgLy8gZnVuY3Rpb24gdGhhdCBjaGVja3MgdG8gc2VlIGlmIGVpdGhlciBwbGF5ZXIgaXMgaW4gYSB3aW5uaW5nIHBvc2l0aW9uLCBwb3N0aW9uIGlzIGRldGVybWluZXMgaWYgdGhlIGluZGV4IG9mIHRoZSBvY2N1cGllZCBzcGFjZSBpcyBlcXVhbCB0byBvciBncmVhdGVyIHRoYW4gMjEodGhlIGZpbmlzaCBsaW5lKSwgdGhlcmUgYXJlIGhpZGRlbiBydW4gb2ZmIGJveGVzIHRoYXQgYWxzbyBldmF1bGF0ZSB0aGUgd2lubmVyIGlmIHRoZSBmaW5hbCBtb3ZlIHdvdWxkIG9mIHRha2UgdGhlbiBwbGF5ZXIgcGFzc2VkIGluZGV4IDIxLlxuICBmdW5jdGlvbiBjaGVja1dpbm5lcigpe1xuICAgIGlmKHBsYXllck9uZVR1cm4pe1xuICAgICAgaW5kZXggPSAkKCcudHJhY2sxLnBsYXllcicpLmluZGV4KCk7XG4gICAgICBpZihpbmRleCA+PSAyMSl7XG4gICAgICAgICR3aW5Tb3VuZC5wbGF5KCk7XG4gICAgICAgICQoJy5mZWVkYmFjaycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICRmaW5pc2gxLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgJGZpbmlzaDEuYWRkQ2xhc3MoJ3dpbm5lcicpO1xuICAgICAgICAkKCcuY29udHJvbGxlcicpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICQoJy5wbGF5ZXJPbmVXaW4nKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAkKCcucmVzZXQnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAkKCcucmVzdWx0Qm94JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYoIXBsYXllck9uZVR1cm4pe1xuICAgICAgaW5kZXggPSAkKCcudHJhY2syLnBsYXllcicpLmluZGV4KCk7XG4gICAgICBpZihpbmRleCA+PSAyMSl7XG4gICAgICAgICR3aW5Tb3VuZC5wbGF5KCk7XG4gICAgICAgICQoJy5mZWVkYmFjaycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICRmaW5pc2gyLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgJGZpbmlzaDIuYWRkQ2xhc3MoJ3dpbm5lcicpO1xuICAgICAgICAkKCcuY29udHJvbGxlcicpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICQoJy5yZXNldCcpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgICQoJy5yZXN1bHRCb3gnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgICAgICQoJy5wbGF5ZXJUd29XaW4nKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICB9IGVsc2UgaWYoaXNPbmVQbGF5ZXIpe1xuICAgICAgICAgICQoJy5haVdpbicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyB0aGlzIGZ1bmN0aW9uIGRldGVybWluZXMgd2hvcyB0dXJuIGl0IGlzIGFuZCB1cGRhdGVzIHRoZSBvbiBzY3JlZW4gcG9ybXB0IGFjY29yZGluZ2x5LCBpdCBpcyBmaXJlZCBkaXJlY3RseSBhZnRlciB0aGUgY2xpY2sgZXZlbnQgb24gbW92ZSwgYW5kIGl0IGZpcmVkIGlmIGEgYm9vc3QgaGFwcGVucyBhZnRlciB1cGRhdGluZyB0aGUgYm9vc3QgYm9vbGVhbiwgaXQgd29ya3Mgb24gdGhlIG9uZSB2YXJpYWJsZSB3aGljaCBnZXRzIHVwZGF0ZWQgb2YgcGxheWVyT25lVHVybiBmcm9tIHRydWUgdG8gZmFsc2UuXG4gIGZ1bmN0aW9uIGRldGVybWluZVR1cm4oKXtcbiAgICBpZihwbGF5ZXJPbmVUdXJuKXtcbiAgICAgIGxvY2F0ZUdhcnkoKTtcbiAgICAgIHBsYXllck9uZVR1cm4gPSBmYWxzZTtcbiAgICAgICR0cmFjayA9ICQoJy50cmFjazInKTtcbiAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMlxcJ3MgVHVybicpO1xuICAgIH0gZWxzZSBpZighcGxheWVyT25lVHVybil7XG4gICAgICBsb2NhdGVHYXJ5KCk7XG4gICAgICBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgICAgICR0cmFjayA9ICQoJy50cmFjazEnKTtcbiAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMVxcJ3MgVHVybicpO1xuICAgIH1cbiAgfVxuXG4gIC8vIFRoaXMgZnVuY3Rpb24gbG9jYXRlcyBnYXJ5IG9uIHRoZSBib2FyZCwgdGhlIHNlcGVyYXRlIHBhcnRzIG9mIHRoZSBpZiBlbHNlIHN0YXRlbWVudCBydW4gYmFzZWQgb24gd2hpY2ggcGxheWVycyB0dXJuIGl0IGlzLCBvbmNlIGRvaW5nIHNvIGl0IGZpcmVzIG9mZiB0aGUgbW92ZUdhcnkgZnVuY3Rpb24uIE9yIGlmIGl0IGRldGVjdHMgdGhlIGJvb3N0IGhhcyBiZWVuIHVzZWQoYnkgaXQgdXBkYXRpbmcgZnJvbSAxIHRvIDAgb24gdGhlIGJvb3N0IGJ1dHRvbiBjbGljaykgaWYgZmlyZXMgb2ZmIHRoZSBib29zdEdhcnkgZnVuY3Rpb24gaW5zdGVhZCwgaXQgdGhlbiB1cGRhdGVzIHRoZSBib29zdCBjb3VudCB0byAyIHdoaWNoIGluZm9ybXMgdGhlIHVzZXIgdGhlIGJvb3N0IGhhcyBiZWVuIHVzZWQgd2hlbiBjbGlja2VkIGFnYWluLlxuICBmdW5jdGlvbiBsb2NhdGVHYXJ5KCl7XG4gICAgaWYocGxheWVyT25lVHVybil7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgIGlmKFBsYXllck9uZUJvb3N0UmVtYWluaW5nID4gMCl7XG4gICAgICAgICRtb3ZlU291bmQucGxheSgpO1xuICAgICAgICBtb3ZlR2FyeSgpO1xuICAgICAgfSBlbHNlIGlmKFBsYXllck9uZUJvb3N0UmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgIGJvb3N0R2FyeSgpO1xuICAgICAgICBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9IDI7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICghcGxheWVyT25lVHVybil7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazIucGxheWVyJykuaW5kZXgoKTtcbiAgICAgIGlmKFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID4gMCl7XG4gICAgICAgICRtb3ZlU291bmRUd28ucGxheSgpO1xuICAgICAgICBtb3ZlR2FyeSgpO1xuICAgICAgfWVsc2UgaWYoUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPT09IDApIHtcbiAgICAgICAgYm9vc3RHYXJ5KCk7XG4gICAgICAgIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID0gMjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBUaGlzIGZ1bmN0aW9uIG1vdmVzIGdhcnksIGl0IGZpcnN0IGRldGVybWluZXMgaWYgaXQgaXMgYSByZWd1bGFyIG1vdmUgb3IgYSBib29zdCBtb3ZlLCBpZiBpdCBpcyBhIHJlZ3VsYXIgbW92ZSBpdCBtb3ZlcyB0aGUgY3VycmVudCBwbGF5ZXJzIEdhcnkgYmV0d2VlbiAxIGFuZCAzIGluZGV4IHNwYWNlcyBhbG9uZywgZmluYWxseSwgaXQgcnVucyB0aGUgY2hlY2tXaW5uZXIgZnVuY3Rpb24gdG8gc2VlIGlmIGEgd2luIGNvbmRpdGlvbiBoYXMgYmVlbiBtZXQuXG4gIGZ1bmN0aW9uIG1vdmVHYXJ5KCkge1xuICAgIGlmKCFpc09uZVBsYXllcil7XG4gICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICR0cmFjay5lcShpbmRleCArIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKSArIDEgKSApLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgIGNoZWNrV2lubmVyKCk7XG4gICAgfSBlbHNlIGlmKGlzT25lUGxheWVyKXtcbiAgICAgICRtb3ZlU291bmQucGxheSgpO1xuICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIGdldFxcJ3MgbW92aW5nIScpO1xuICAgICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgICAkdHJhY2suZXEoaW5kZXggKyAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMykgKyAxICkgKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICBjaGVja1dpbm5lcigpO1xuICAgICAgaW5kZXggPSAkKCcudHJhY2sxLnBsYXllcicpLmluZGV4KCk7XG4gICAgICBpZihpbmRleCA8IDIxKXtcbiAgICAgICAgYWlNb3ZlKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gVGhpcyBmdW5jdGlvbiBmaXJlcyBvZmYgaWYgdGhlIGJvb3N0IGJ1dHRvbiBpcyBjbGlja2VkIG9uLCB0aGUgY2xpY2sgZXZlbnQgdXBkYXRlcyB0aGUgYm9vc3QgY291bnQgYW5kIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW4gdGhlIGxvY2F0ZUdhcnkgaXMgcnVubmluZy4gSXQgZ3VhcmVudGVlcyB0aGUgdXNlciBhIG1vdmUgb2YgNSBzcGFjZXMgdGhlbiBydW5zIHRoZSBjaGVjayB3aW5uZXIgZnVuY3Rpb24gdG8gc2VlIGlmIGEgd2luIGNvbmRpdGlvbiBoYXMgYmVlbiBtZXQuXG4gIGZ1bmN0aW9uIGJvb3N0R2FyeSgpIHtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgICAkdHJhY2suZXEoaW5kZXggKyA1KS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICBjaGVja1dpbm5lcigpO1xuICAgIH0gZWxzZSBpZihpc09uZVBsYXllcil7XG4gICAgICAkYm9vc3RTb3VuZC5wbGF5KCk7XG4gICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICR0cmFjay5lcShpbmRleCArIDUpLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgIGNoZWNrV2lubmVyKCk7XG4gICAgICBhaU1vdmUoKTtcbiAgICB9XG4gIH1cblxuXG4gIC8vIHRoZSBzYWx0R2FyeSBmdW5jdGlvbi5cbiAgZnVuY3Rpb24gc2FsdEdhcnkoKSB7XG4gICAgaWYoIWlzT25lUGxheWVyKXtcbiAgICAgIGlmKFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09IDApe1xuICAgICAgICBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0gMjtcbiAgICAgICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gICAgICAgIGluZGV4ID0gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDIgaGFzIGJlZW4gc2FsdGVkISBQbGF5ZXIgMSBtb3ZlcyBhZ2FpbiEnKTtcbiAgICAgICAgbW92ZUdhcnkoKTtcbiAgICAgIH0gZWxzZSBpZihQbGF5ZXJUd29TYWx0UmVtYWluaW5nID09PSAwKXtcbiAgICAgICAgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9IDI7XG4gICAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMSBoYXMgYmVlbiBzYWx0ZWQhIFBsYXllciAyIG1vdmVzIGFnYWluIScpO1xuICAgICAgICBpbmRleCA9ICQoJy50cmFjazIucGxheWVyJykuaW5kZXgoKTtcbiAgICAgICAgbW92ZUdhcnkoKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYoaXNPbmVQbGF5ZXIpe1xuICAgICAgaWYoUGxheWVyT25lU2FsdFJlbWFpbmluZyA9PT0gMCl7XG4gICAgICAgIHBsYXllck9uZVR1cm4gPSB0cnVlO1xuICAgICAgICAkdHJhY2sgPSAkKCcudHJhY2sxJyk7XG4gICAgICAgIGluZGV4ID0gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgICAkdHVyblRleHQudGV4dCgnTWVjaGEgR2FyeSBoYXMgYmVlbiBzYWx0ZWQhIFBsYXllciAxIG1vdmVzIGFnYWluIScpO1xuICAgICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgJHRyYWNrLmVxKGluZGV4ICsgKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMSApICkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0gMjtcbiAgICAgICAgY2hlY2tXaW5uZXIoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy8gZnVuY3Rpb24gYmVsb3cgaXMgZm9yIHRoZSBvbmUgcGxheWVyIG1vZGUsIGl0IHRyYWNrcyBwbGF5ZXIgMXMgcG9zdGlvbiBhbmQgc2F2ZXMgaXQgaW4gcGxheWVyIDEgdHJhY2tlciwgdGhlbiBtYWtlcyBhIGRlc2ljaW9uIGJhc2VkIG9uIHRoYXQgcG9zdGlvbiwgdGhlIGJpZ2dlciB0aGUgbnVtYmVyIGluIHBsYXllciB0cmFja2VyIHRoZSBtb3JlIGxpa2VsaW5lc3Mgb2YgaXQgdXNpbmcgb25lIG9mIHRoZSBhYmlsaXR5IG1vdmVzLlxuICBmdW5jdGlvbiBhaU1vdmUoKXtcbiAgICBwbGF5ZXJPbmVUcmFja2VyID0gaW5kZXg7XG4gICAgJHRyYWNrID0gJCgnLnRyYWNrMicpO1xuICAgIGluZGV4ID0gJCgnLnRyYWNrMi5wbGF5ZXInKS5pbmRleCgpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIGlmKHBsYXllck9uZVRyYWNrZXIgPD0gNCl7XG4gICAgICAgICRtb3ZlU291bmRUd28ucGxheSgpO1xuICAgICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgJHRyYWNrLmVxKGluZGV4ICsgKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMSApICkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICAkdHVyblRleHQudGV4dCgnTWVjaGEgR2FyeSBoYXMgbWFkZSBoaXMgbW92ZSEnKTtcbiAgICAgICAgcGxheWVyT25lVHVybiA9IGZhbHNlO1xuICAgICAgICBjaGVja1dpbm5lcigpO1xuICAgICAgICBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgICAgIH1lbHNlIGlmKHBsYXllck9uZVRyYWNrZXIgPiA0ICYmIHBsYXllck9uZVRyYWNrZXIgPCAxNSl7XG4gICAgICAgIGFpTW92ZURlY2lkZXIgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDUpO1xuICAgICAgICBpZihhaU1vdmVEZWNpZGVyIDw9IDIpe1xuICAgICAgICAgICRtb3ZlU291bmRUd28ucGxheSgpO1xuICAgICAgICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICAgICR0cmFjay5lcShpbmRleCArIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKSArIDEgKSApLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgICAkdHVyblRleHQudGV4dCgnTWVjaGEgR2FyeSBoYXMgbWFkZSBoaXMgbW92ZSEnKTtcbiAgICAgICAgICBwbGF5ZXJPbmVUdXJuID0gZmFsc2U7XG4gICAgICAgICAgY2hlY2tXaW5uZXIoKTtcbiAgICAgICAgICBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgICAgICAgfWVsc2UgaWYoYWlNb3ZlRGVjaWRlciA8PTQgJiYgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgICRib29zdFNvdW5kLnBsYXkoKTtcbiAgICAgICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgICAkdHJhY2suZXEoaW5kZXggKyA1KS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ01lY2hhIEdhcnkgaGFzIGJvb3N0ZWQhJyk7XG4gICAgICAgICAgcGxheWVyT25lVHVybiA9IGZhbHNlO1xuICAgICAgICAgIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID0gMjtcbiAgICAgICAgICBjaGVja1dpbm5lcigpO1xuICAgICAgICAgIHBsYXllck9uZVR1cm4gPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYoYWlNb3ZlRGVjaWRlciA8PTQgJiYgUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgICRtb3ZlU291bmRUd28ucGxheSgpO1xuICAgICAgICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICAgICR0cmFjay5lcShpbmRleCArIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKSArIDEgKSApLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgICAkdHVyblRleHQudGV4dCgnTWVjaGEgR2FyeSBoYXMgbWFkZSBoaXMgbW92ZSEnKTtcbiAgICAgICAgICBwbGF5ZXJPbmVUdXJuID0gZmFsc2U7XG4gICAgICAgICAgY2hlY2tXaW5uZXIoKTtcbiAgICAgICAgICBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmKGFpTW92ZURlY2lkZXIgPT09IDUgJiYgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ01lY2hhIEdhcnkgaGFzIHNhbHRlZCB5b3UsIGhlIG1vdmVzIGFnYWluIScpO1xuICAgICAgICAgICRzYWx0U291bmQucGxheSgpO1xuICAgICAgICAgIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPSAyO1xuICAgICAgICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICAgICR0cmFjay5lcShpbmRleCArIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKSArIDEgKSApLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBhaU1vdmUoKTtcbiAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgICBwbGF5ZXJPbmVUdXJuID0gZmFsc2U7XG4gICAgICAgICAgY2hlY2tXaW5uZXIoKTtcbiAgICAgICAgICBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmKGFpTW92ZURlY2lkZXIgPT09IDUgJiYgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICAgJG1vdmVTb3VuZFR3by5wbGF5KCk7XG4gICAgICAgICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgICAgICAgJHRyYWNrLmVxKGluZGV4ICsgKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMSApICkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICAgICR0dXJuVGV4dC50ZXh0KCdNZWNoYSBHYXJ5IGhhcyBtYWRlIGhpcyBtb3ZlIScpO1xuICAgICAgICAgIHBsYXllck9uZVR1cm4gPSBmYWxzZTtcbiAgICAgICAgICBjaGVja1dpbm5lcigpO1xuICAgICAgICAgIHBsYXllck9uZVR1cm4gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9ZWxzZSBpZihwbGF5ZXJPbmVUcmFja2VyID49IDE1KXtcbiAgICAgICAgYWlNb3ZlRGVjaWRlciA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogNSk7XG4gICAgICAgIGlmKGFpTW92ZURlY2lkZXIgPD0zICYmIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICAkYm9vc3RTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgICAgICAgJHRyYWNrLmVxKGluZGV4ICsgNSkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICAgICR0dXJuVGV4dC50ZXh0KCdNZWNoYSBHYXJ5IGhhcyBib29zdGVkIScpO1xuICAgICAgICAgIHBsYXllck9uZVR1cm4gPSBmYWxzZTtcbiAgICAgICAgICBQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9IDI7XG4gICAgICAgICAgY2hlY2tXaW5uZXIoKTtcbiAgICAgICAgfSBlbHNlIGlmKGFpTW92ZURlY2lkZXIgPD0zICYmIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAyICYmIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgICR0dXJuVGV4dC50ZXh0KCdNZWNoYSBHYXJ5IGhhcyBzYWx0ZWQgeW91LCBoZSBtb3ZlcyBhZ2FpbiEnKTtcbiAgICAgICAgICAkc2FsdFNvdW5kLnBsYXkoKTtcbiAgICAgICAgICBQbGF5ZXJUd29TYWx0UmVtYWluaW5nID0gMjtcbiAgICAgICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgICAkdHJhY2suZXEoaW5kZXggKyAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMykgKyAxICkgKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgYWlNb3ZlKCk7XG4gICAgICAgICAgfSwgNzUwKTtcbiAgICAgICAgICBwbGF5ZXJPbmVUdXJuID0gZmFsc2U7XG4gICAgICAgICAgY2hlY2tXaW5uZXIoKTtcbiAgICAgICAgICBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmKGFpTW92ZURlY2lkZXIgPD0zICYmIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAyKXtcbiAgICAgICAgICAkbW92ZVNvdW5kVHdvLnBsYXkoKTtcbiAgICAgICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgICAkdHJhY2suZXEoaW5kZXggKyAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMykgKyAxICkgKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ01lY2hhIEdhcnkgaGFzIG1hZGUgaGlzIG1vdmUhJyk7XG4gICAgICAgICAgcGxheWVyT25lVHVybiA9IGZhbHNlO1xuICAgICAgICAgIGNoZWNrV2lubmVyKCk7XG4gICAgICAgICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZihhaU1vdmVEZWNpZGVyIDw9NSAmJiBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICAkdHVyblRleHQudGV4dCgnTWVjaGEgR2FyeSBoYXMgc2FsdGVkIHlvdSwgaGUgbW92ZXMgYWdhaW4hJyk7XG4gICAgICAgICAgJHNhbHRTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9IDI7XG4gICAgICAgICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgICAgICAgJHRyYWNrLmVxKGluZGV4ICsgKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMSApICkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGFpTW92ZSgpO1xuICAgICAgICAgIH0sIDc1MCk7XG4gICAgICAgICAgcGxheWVyT25lVHVybiA9IGZhbHNlO1xuICAgICAgICAgIGNoZWNrV2lubmVyKCk7XG4gICAgICAgICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZihhaU1vdmVEZWNpZGVyIDw9NSAmJiBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAyKXtcbiAgICAgICAgICAkbW92ZVNvdW5kVHdvLnBsYXkoKTtcbiAgICAgICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgICAkdHJhY2suZXEoaW5kZXggKyAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMykgKyAxICkgKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ01lY2hhIEdhcnkgaGFzIG1hZGUgaGlzIG1vdmUhJyk7XG4gICAgICAgICAgcGxheWVyT25lVHVybiA9IGZhbHNlO1xuICAgICAgICAgIGNoZWNrV2lubmVyKCk7XG4gICAgICAgICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCAxNTAwKTtcbiAgfVxuICAvLyB2YXJpb3VzIGV2ZW50IGxpc3RlbmVycyBiZWxvdy5cblxuICAvLyBUaGlzIGlzIHRoZSBjbGljayBldmVudCBmb3IgdGhlIG1vdmUgYnV0dG9uLCB3aGVuIGNsaWNrZWQgaXQgZmlyZXMgb2ZmIHRoZSBkZXRlcm1pbmVUdXJuIGZ1bmN0aW9uIHdoaWNoIHNldHMgaW4gbW90aW9uIHRoZSBsb2NhdGVHYXJ5IGFuZCBtb3ZlR2FyeSBmdW5jdGlvbnMuXG4gIGZ1bmN0aW9uIG1vdmVFdmVudCgpe1xuICAgIGlmKCFpc09uZVBsYXllcil7XG4gICAgICAkbW92ZS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCcycCBtb3ZlIHJ1bicpO1xuICAgICAgICBkZXRlcm1pbmVUdXJuKCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYoaXNPbmVQbGF5ZXIpIHtcbiAgICAgICRtb3ZlLm9uKCdjbGljaycsKCkgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKCcxcCBtb3ZlIHJ1bicpO1xuICAgICAgICAkdHJhY2sgPSAkKCcudHJhY2sxJyk7XG4gICAgICAgIGluZGV4ID0gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgICBtb3ZlR2FyeSgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gdGhpcyBpcyB0aGUgY2xpY2sgZXZlbnQgZm9yIHRoZSBib29zdCBidXR0b24sIHdoZW4gY2xpY2tlZCBpdCBjaGVja3MgZmlyc3QgdG8gc2VlIGlmIHRoZSBwbGF5ZXIgaGFzIGFscmVhZHkgdXNlZCB0aGVpciBib29zdCwgaWYgbm90IGl0IHVwZGF0ZXMgdGhhdCBpbmZvcm1hdGlvbiBhbmQgcnVucyB0aGUgZGV0ZXJtaW5lVHVybiBmdW5jdGlvbiBsaWtlIGEgbm9ybWFsIG1vdmUsIHdoZW4gdGhpcyByZWFjaGVzIHRoZSBsb2NhdGVHYXJ5IGZ1bmN0aW9uLCBpdCB0YWtlcyBub3RlIHRoYXQgdGhlIGJvb3N0IGhhcyBiZWVuIHVzZWQgdG8gZmlyZSBvZmYgdGhlIGJvb3N0R2FyeSBmdW5jdGlvbiBpbnN0ZWFkIG9mIHRoZSBtb3ZlR2FyeSBmdW5jdGlvbi4gSXQgdGhlbiB1cGRhdGVzIHRoZSBib29zdCByZW1haW5pbmcgYWdhaW4sIHNvIHRoYXQgaWYgYW5vdGhlciBib29zdCBpcyBhdHRlbXB0ZWQsIGl0IGluZm9ybXMgdGhlIHVzZXIgdGhhdCB0aGVpciBib29zdCBoYXMgYWxyZWFkeSBiZWVuIHVzZWQuXG4gIGZ1bmN0aW9uIGJvb3N0RXZlbnQoKXtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgJGJvb3N0Lm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgaWYocGxheWVyT25lVHVybil7XG4gICAgICAgICAgaWYoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgICAgJGJvb3N0U291bmQucGxheSgpO1xuICAgICAgICAgICAgUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPSAwO1xuICAgICAgICAgICAgZGV0ZXJtaW5lVHVybigpO1xuICAgICAgICAgIH0gZWxzZSBpZihQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICAgICAkZXJyb3JTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDEgYm9vc3QgYWxyZWFkeSB1c2VkIScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICghcGxheWVyT25lVHVybil7XG4gICAgICAgICAgaWYoUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgICAgJGJvb3N0U291bmQucGxheSgpO1xuICAgICAgICAgICAgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPSAwO1xuICAgICAgICAgICAgZGV0ZXJtaW5lVHVybigpO1xuICAgICAgICAgIH0gZWxzZSBpZihQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICAgICAkZXJyb3JTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDIgYm9vc3QgYWxyZWFkeSB1c2VkIScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmKGlzT25lUGxheWVyKXtcbiAgICAgICRib29zdC5vbignY2xpY2snLCgpID0+e1xuICAgICAgICBpZihQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgY29uc29sZS5sb2coJzFwIGJvb3N0IHJ1bicpO1xuICAgICAgICAgICR0cmFjayA9ICQoJy50cmFjazEnKTtcbiAgICAgICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgICAgICBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9IDI7XG4gICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIHVzZXMgYm9vc3QhJyk7XG4gICAgICAgICAgYm9vc3RHYXJ5KCk7XG4gICAgICAgIH0gZWxzZSBpZiAoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgICRlcnJvclNvdW5kLnBsYXkoKTtcbiAgICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDEgaGFzIGFscmVhZHkgdXNlZCBib29zdCEnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gYmVsb3cgaXMgdGhlIGV2ZW50IGxpc3RlbmVyIGZvciB0aGUgc2FsdCBhYmlsaXR5LiBVc2luZyB0aGlzIHdpbGwgc3RvcCB5b3VyIG9wcG9uZW50cyBuZXh0IHR1cm4gYW5kIGdpdmUgZ2FyeSBhIG5vcm1hbCBnYXJ5TW92ZSB3aGlsZSB1c2luZyBpdC4gSWYgYSBwbGF5ZXIgaGFzIGFscmVhZHkgdXNlZCB0aGVpciBzYWx0IGl0IGluZm9ybXMgdGhlbSBvbiB0aGUgJHR1cm5UZXh0IGZlZWRiYWNrLlxuICBmdW5jdGlvbiBzYWx0RXZlbnQoKXtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgJHNhbHQub24oJ2NsaWNrJywoKSA9PiB7XG4gICAgICAgIGlmKHBsYXllck9uZVR1cm4pe1xuICAgICAgICAgIGlmKFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgICAgJHNhbHRTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgICBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0gMDtcbiAgICAgICAgICAgIHNhbHRHYXJ5KCk7XG4gICAgICAgICAgfSBlbHNlIGlmKFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgICAgJGVycm9yU291bmQucGxheSgpO1xuICAgICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIGhhcyBhbHJlYWR5IHVzZWQgU2FsdCEnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZighcGxheWVyT25lVHVybil7XG4gICAgICAgICAgaWYoUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgICAkc2FsdFNvdW5kLnBsYXkoKTtcbiAgICAgICAgICAgIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPSAwO1xuICAgICAgICAgICAgc2FsdEdhcnkoKTtcbiAgICAgICAgICB9IGVsc2UgaWYoUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICAgICAkZXJyb3JTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDIgaGFzIGFscmVhZHkgdXNlZCBTYWx0IScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmKGlzT25lUGxheWVyKXtcbiAgICAgICRzYWx0Lm9uKCdjbGljaycsKCkgPT4ge1xuICAgICAgICBpZihQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0gMDtcbiAgICAgICAgICAkc2FsdFNvdW5kLnBsYXkoKTtcbiAgICAgICAgICBzYWx0R2FyeSgpO1xuICAgICAgICB9IGVsc2UgaWYoUGxheWVyT25lU2FsdFJlbWFpbmluZyA9PT0yKXtcbiAgICAgICAgICAkZXJyb3JTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIGhhcyBhbHJlYWR5IHVzZWQgU2FsdCEnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gQ2xpY2sgZXZlbnQgdG8gc3RhcnQgdGhlIGdhbWUsIHJlbW92ZXMgdGhlIGluc3RydWN0aW9uIHBhZ2UgYW5kIHRoZW4gc2hvd3MgdGhlIHJhY2V0cmFjaywgZmVlZGJhY2sgYm94IGFuZCBjb250cm9sbGVyLlxuXG4gICRzdGFydC5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgJCgnLmluc3RydWN0aW9ucycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJCgnLmJvYXJkJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuY29udHJvbGxlcicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgJCgnLmZlZWRiYWNrJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICBtb3ZlRXZlbnQoKTtcbiAgICBib29zdEV2ZW50KCk7XG4gICAgc2FsdEV2ZW50KCk7XG4gICAgJGF1ZGlvVGhlbWUucGxheSgpO1xuICB9KTtcblxuICAvLyBjbGljayBldmVudCB0byBzdGFydCB0aGUgMXAgb3B0aW9uLlxuICAkc3RhcnQxUGxheWVyLm9uKCdjbGljaycsKCkgPT4ge1xuICAgIGlzT25lUGxheWVyID0gdHJ1ZTtcbiAgICAkKCcuaW5zdHJ1Y3Rpb25zJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuYm9hcmQnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICQoJy5jb250cm9sbGVyJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuZmVlZGJhY2snKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIG1vdmVFdmVudCgpO1xuICAgIGJvb3N0RXZlbnQoKTtcbiAgICBzYWx0RXZlbnQoKTtcbiAgICAkdHVyblRleHQudGV4dCgnTWFrZSB5b3VyIGZpcnN0IG1vdmUhJyk7XG4gICAgJGF1ZGlvVGhlbWUucGxheSgpO1xuICB9KTtcblxuICAvLyBFdmVudCBsaXN0ZW5lciBmb3IgdGhlIHJlc2V0IGJ1dHRvbiwgaXQgYmFzaWNhbGx5IGhpZGVzIGFsbCBvZiB0aGUgZmVlZGJhY2sgZnJvbSB0aGUgcmVtYWluaW5nIGdhbWUgYW5kIG1vdmVzIGJvdGggcGxheWVyIGljb25zIGJhY2sgdG8gdGhlIHN0YXJ0IGxpbmUsIGl0IGFsc28gcmVzZXRzIHRoZSBzYWx0IGFuZCBib29zdCBjb3VudGVycyB0byAxIHNvIHRoYXQgdGhleSBjYW4gbm93IGJlIHVzZWQgYWdhaW4uXG4gIGlmKCFpc09uZVBsYXllcil7XG4gICAgJCgnLnJlc2V0Jykub24oJ2NsaWNrJywoKSA9PiB7XG4gICAgICAkKCcudHJhY2sxJykucmVtb3ZlQ2xhc3MoJ3BsYXllciB3aW5uZXInKTtcbiAgICAgICQoJy5zdGFydDEnKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9IDE7XG4gICAgICBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0xO1xuICAgICAgJCgnLnRyYWNrMicpLnJlbW92ZUNsYXNzKCdwbGF5ZXIgd2lubmVyJyk7XG4gICAgICAkKCcuc3RhcnQyJykuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPSAxO1xuICAgICAgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9IDE7XG4gICAgICAkKCcuY29udHJvbGxlcicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAkKCcuZmVlZGJhY2snKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgJCgnLnJlc3VsdEJveCcpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAkKCcucGxheWVyT25lV2luJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICQoJy5wbGF5ZXJUd29XaW4nKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgJGF1ZGlvVGhlbWUuc3JjID0gJyc7XG4gICAgICAkYXVkaW9UaGVtZS5zcmMgPSAnc291bmRzL2Nsb3NpbmdfdGhlbWUubXAzJztcbiAgICAgICRhdWRpb1RoZW1lLnBsYXkoKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmKGlzT25lUGxheWVyKXtcbiAgICAkKCcucmVzZXQnKS5vbignY2xpY2snLCgpID0+IHtcbiAgICAgICQoJy50cmFjazEnKS5yZW1vdmVDbGFzcygncGxheWVyIHdpbm5lcicpO1xuICAgICAgJCgnLnN0YXJ0MScpLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgIFBsYXllck9uZUJvb3N0UmVtYWluaW5nID0gMTtcbiAgICAgIFBsYXllck9uZVNhbHRSZW1haW5pbmcgPTE7XG4gICAgICAkKCcudHJhY2syJykucmVtb3ZlQ2xhc3MoJ3BsYXllciB3aW5uZXInKTtcbiAgICAgICQoJy5zdGFydDInKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICBQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9IDE7XG4gICAgICBQbGF5ZXJUd29TYWx0UmVtYWluaW5nID0gMTtcbiAgICAgICQoJy5jb250cm9sbGVyJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICQoJy5mZWVkYmFjaycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAkKCcucmVzdWx0Qm94JykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICQoJy5wbGF5ZXJPbmVXaW4nKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgJCgnLmFpV2luJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMVxcJ3MgdGltZSB0byBzaGluZSEnKTtcbiAgICAgICRhdWRpb1RoZW1lLnNyYyA9ICcnO1xuICAgICAgJGF1ZGlvVGhlbWUuc3JjID0gJ3NvdW5kcy9jbG9zaW5nX3RoZW1lLm1wMyc7XG4gICAgICAkYXVkaW9UaGVtZS5wbGF5KCk7XG4gICAgfSk7XG4gIH1cbn0pO1xuIl19
