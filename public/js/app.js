"use strict";$(function(){function a(){z?(H=$(".track1.player").index())>=21&&(e(),b.addClass("player"),b.addClass("winner"),$(".playerOneWin").removeClass("hide"),$(".aiWin").addClass("hide")):z||(H=$(".track2.player").index())>=21&&(e(),M.addClass("player"),M.addClass("winner"),J?J&&$(".aiWin").removeClass("hide"):$(".playerTwoWin").removeClass("hide"))}function e(){O.play(),q.addClass("hide"),P.addClass("hide"),g.removeClass("hide"),S.removeClass("hide")}function s(){z?(l(),z=!1,j=$(".track2"),x.text("Player 2's Turn")):z||(l(),z=!0,j=$(".track1"),x.text("Player 1's Turn"))}function l(){z?(H=$(".track1.player").index(),A>0?(T.play(),r()):0===A&&(o(),A=2)):z||(H=$(".track2.player").index(),D>0?(G.play(),r()):0===D&&(o(),D=2))}function r(){J?J&&(T.play(),x.text("Player 1 get's moving!"),j.eq(H).removeClass("player"),j.eq(H+(Math.floor(3*Math.random())+1)).addClass("player"),a(),(H=$(".track1.player").index())<21&&c()):(j.eq(H).removeClass("player"),j.eq(H+(Math.floor(3*Math.random())+1)).addClass("player"),a())}function o(){J?J&&(_.play(),j.eq(H).removeClass("player"),j.eq(H+5).addClass("player"),a(),(H=$(".track1.player").index())<21&&c()):(j.eq(H).removeClass("player"),j.eq(H+5).addClass("player"),a())}function n(){J?J&&0===E&&(z=!0,j=$(".track1"),H=$(".track1.player").index(),x.text("Mecha Gary has been salted! Player 1 moves again!"),j.eq(H).removeClass("player"),j.eq(H+(Math.floor(3*Math.random())+1)).addClass("player"),E=2,a()):0===E?(E=2,z=!0,H=$(".track1.player").index(),x.text("Player 2 has been salted! Player 1 moves again!"),r()):0===F&&(F=2,x.text("Player 1 has been salted! Player 2 moves again!"),H=$(".track2.player").index(),r())}function t(){x.text("Mecha Gary has salted you, he moves again!"),W.play(),F=2,j.eq(H).removeClass("player"),j.eq(H+(Math.floor(3*Math.random())+1)).addClass("player"),setTimeout(function(){c()},750),z=!1,a(),z=!0}function d(){_.play(),j.eq(H).removeClass("player"),j.eq(H+5).addClass("player"),x.text("Mecha Gary has boosted!"),z=!1,D=2,a(),z=!0}function i(){G.play(),j.eq(H).removeClass("player"),j.eq(H+(Math.floor(3*Math.random())+1)).addClass("player"),x.text("Mecha Gary has made his move!"),z=!1,a(),z=!0}function c(){I=H,j=$(".track2"),H=$(".track2.player").index(),setTimeout(function(){I<=4?i():I>4&&I<15?(K=Math.floor(5*Math.random())+1,K<=2?i():K>2&&K<=4&&1===D?d():K>2&&K<=4&&2===A?i():5===K&&1===F?t():5===K&&2===F&&i()):I>14&&(K=Math.floor(5*Math.random())+1,K<=3&&1===D?d():K<=3&&2===D&&1===F?t():K<=3&&2===D&&2===E?i():K>3&&1===E?t():i())},1500)}function y(){J?J&&v.on("click",function(){console.log("1p move run"),j=$(".track1"),H=$(".track1.player").index(),r()}):v.on("click",function(){console.log("2p move run"),s()})}function u(){J?J&&f.on("click",function(){1===A?(j=$(".track1"),H=$(".track1.player").index(),A=2,x.text("Player 1 uses boost!"),o()):2===A&&(B.play(),x.text("Player 1 has already used boost!"))}):f.on("click",function(){z?1===A?(_.play(),A=0,s()):2===A&&(B.play(),x.text("Player 1 boost already used!")):z||(1===D?(_.play(),D=0,s()):2===D&&(B.play(),x.text("Player 2 boost already used!")))})}function p(){J?J&&k.on("click",function(){1===E?(E=0,W.play(),n()):2===E&&(B.play(),x.text("Player 1 has already used Salt!"))}):k.on("click",function(){z?1===E?(W.play(),E=0,n()):2===E&&(B.play(),x.text("Player 1 has already used Salt!")):z||(1===F?(W.play(),F=0,n()):2===F&&(B.play(),x.text("Player 2 has already used Salt!")))})}function m(){$(".track1").removeClass("player winner"),$(".start1").addClass("player"),A=1,E=1,$(".track2").removeClass("player winner"),$(".start2").addClass("player"),D=1,F=1,I=null,$(".controller").removeClass("hide"),$(".feedback").removeClass("hide"),$(".resultBox").addClass("hide"),$(".playerOneWin").addClass("hide"),w.src="",w.src="sounds/closing_theme.mp3",w.play()}var h=$(".startbtn2"),C=$(".startbtn1"),v=$(".move"),f=$(".boost"),k=$(".salt"),x=$(".turn"),b=$(".finish1"),M=$(".finish2"),q=$(".feedback"),P=$(".controller"),g=$(".reset"),S=$(".resultBox"),w=$(".theme")[0];w.src="sounds/closing_theme.mp3";var _=$(".boostSound")[0];_.src="sounds/boost_sound.mp3";var W=$(".saltSound")[0];W.src="sounds/salt_sound.mp3";var T=$(".moveSound")[0];T.src="sounds/move_sound.mp3";var G=$(".moveSound2")[0];G.src="sounds/move_sound2.mp3";var B=$(".errorSound")[0];B.src="sounds/error_sound.mp3";var O=$(".winSound")[0];O.src="sounds/winning_sound.mp3";var j=$(".track1"),z=!0,A=1,D=1,E=1,F=1,H=null,I=null,J=!1,K=null;h.on("click",function(){$(".instructions").addClass("hide"),$(".board").removeClass("hide"),$(".controller").removeClass("hide"),$(".feedback").removeClass("hide"),y(),u(),p(),w.play()}),C.on("click",function(){J=!0,$(".instructions").addClass("hide"),$(".board").removeClass("hide"),$(".controller").removeClass("hide"),$(".feedback").removeClass("hide"),y(),u(),p(),x.text("Make your first move!"),w.play()}),J?J&&g.on("click",function(){m(),$(".aiWin").addClass("hide"),x.text("Player 1's time to shine!")}):g.on("click",function(){m(),$(".playerTwoWin").addClass("hide")})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiY2hlY2tXaW5uZXIiLCJwbGF5ZXJPbmVUdXJuIiwiaW5kZXgiLCIkZmluaXNoMSIsImFsd2F5c09uV2luIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsIiRmaW5pc2gyIiwiaXNPbmVQbGF5ZXIiLCIkd2luU291bmQiLCJwbGF5IiwiJGZlZWRiYWNrIiwiJGNvbnRyb2xsZXIiLCJkZXRlcm1pbmVUdXJuIiwibG9jYXRlR2FyeSIsIiR0dXJuVGV4dCIsIm1vdmVHYXJ5IiwiJG1vdmVTb3VuZCIsIlBsYXllck9uZUJvb3N0UmVtYWluaW5nIiwiUGxheWVyVHdvQm9vc3RSZW1haW5pbmciLCIkbW92ZVNvdW5kVHdvIiwiZXEiLCJ0ZXh0IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiJHRyYWNrIiwiYm9vc3RHYXJ5IiwiJGJvb3N0U291bmQiLCJzYWx0R2FyeSIsIlBsYXllck9uZVNhbHRSZW1haW5pbmciLCJQbGF5ZXJUd29TYWx0UmVtYWluaW5nIiwiYWlTYWx0IiwiJHNhbHRTb3VuZCIsInNldFRpbWVvdXQiLCJhaU1vdmUiLCJhaUJvb3N0IiwiYWlSZWciLCJwbGF5ZXJPbmVUcmFja2VyIiwiYWlNb3ZlRGVjaWRlciIsIm1vdmVFdmVudCIsIiRtb3ZlIiwib24iLCJsb2ciLCJjb25zb2xlIiwiYm9vc3RFdmVudCIsIiRib29zdCIsIiRlcnJvclNvdW5kIiwic2FsdEV2ZW50IiwiJHNhbHQiLCJhbHdheXNPblJlc2V0Iiwic3JjIiwiJGF1ZGlvVGhlbWUiLCIkc3RhcnQiLCIkc3RhcnQxUGxheWVyIiwiJHJlc3VsdEJveCIsIiRyZXNldCJdLCJtYXBwaW5ncyI6IllBQUFBLEdBQUUsV0EwQ0EsUUFBU0MsS0FEVEMsR0FDQUMsRUFBU0YsRUFBQUEsa0JBQWFFLFVBQ2pCRCxLQUNEQyxJQUNBQyxFQUFHRCxTQUFZLFVBQ2JFLEVBQUFBLFNBQUFBLFVBQ0FELEVBQUFBLGlCQUFrQkUsWUFBbEIsUUFDQUYsRUFBQUEs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RUFBQUEsRUFDQUMsRUFBQUEsRUFDQVcsRUFBQUEsS0FDQUMsRUFBQUEsS0FDQTdCLEdBQUosRUFDSW9DLEVBQUFBLElBeVRKZSxHQUFPWCxHQUFHLFFBQVMsV0FBbkJXLEVBQUFBLGlCQUFtQi9DLFNBQUEsUUFDakJQLEVBQUUsVUFBQU0sWUFBaUJDLFFBQ25CUCxFQUFFLGVBQVVNLFlBQVksUUFDeEJOLEVBQUUsYUFBRk0sWUFBaUJBLFFBQ2pCTixJQUNBeUMsSUFDQUssSUFDQUcsRUFBQUEsU0FJRk0sRUFBQVosR0FBQSxRQUFBLFdBQ0FZLEdBQUEsRUFDRTlDLEVBQUFBLGlCQUFBRixTQUFBLFFBQ0FQLEVBQUUsVUFBQU0sWUFBaUJDLFFBQ25CUCxFQUFFLGVBQVVNLFlBQVksUUFDeEJOLEVBQUUsYUFBRk0sWUFBaUJBLFFBQ2pCTixJQUNBeUMsSUFDQUssSUFDQUcsRUFBQUEsS0FBQUEseUJBQ0FqQyxFQUFVTyxTQU1SZCxFQUNGQSxHQURGZ0QsRUFLT2QsR0FBR2xDLFFBQUFBLFdBQ1JnRCxJQUNFTixFQUFBQSxVQUFBQSxTQUFBQSxRQUNBbkQsRUFBQXVCLEtBQVloQiwrQkFSaEJrRCxFQUFJaEQsR0FBQUEsUUFBWSxXQUNkZ0QsSUFDRU4sRUFBQUEsaUJBQUFBLFNBQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiQoKCkgPT4ge1xuICAvLyBMaXN0IG9mIHZhcmlhYmxlcyBuZWVkZWQgZm9yIHRoZSBnYW1lXG4gIGNvbnN0ICRzdGFydCA9ICQoJy5zdGFydGJ0bjInKTtcbiAgY29uc3QgJHN0YXJ0MVBsYXllciA9ICQoJy5zdGFydGJ0bjEnKTtcbiAgY29uc3QgJG1vdmUgPSAkKCcubW92ZScpO1xuICBjb25zdCAkYm9vc3QgPSAkKCcuYm9vc3QnKTtcbiAgY29uc3QgJHNhbHQgPSAkKCcuc2FsdCcpO1xuICBjb25zdCAkdHVyblRleHQgPSAkKCcudHVybicpO1xuICBjb25zdCAkZmluaXNoMSA9ICQoJy5maW5pc2gxJyk7XG4gIGNvbnN0ICRmaW5pc2gyID0gJCgnLmZpbmlzaDInKTtcbiAgY29uc3QgJGZlZWRiYWNrID0gJCgnLmZlZWRiYWNrJyk7XG4gIGNvbnN0ICRjb250cm9sbGVyID0gJCgnLmNvbnRyb2xsZXInKTtcbiAgY29uc3QgJHJlc2V0ID0gJCgnLnJlc2V0Jyk7XG4gIGNvbnN0ICRyZXN1bHRCb3ggPSAkKCcucmVzdWx0Qm94Jyk7XG4gIC8vIEF1ZGlvIHZhcmlhYmxlcy5cbiAgY29uc3QgJGF1ZGlvVGhlbWUgPSAkKCcudGhlbWUnKVswXTtcbiAgJGF1ZGlvVGhlbWUuc3JjID0gJ3NvdW5kcy9jbG9zaW5nX3RoZW1lLm1wMyc7XG4gIGNvbnN0ICRib29zdFNvdW5kID0gJCgnLmJvb3N0U291bmQnKVswXTtcbiAgJGJvb3N0U291bmQuc3JjID0gJ3NvdW5kcy9ib29zdF9zb3VuZC5tcDMnO1xuICBjb25zdCAkc2FsdFNvdW5kID0gJCgnLnNhbHRTb3VuZCcpWzBdO1xuICAkc2FsdFNvdW5kLnNyYyA9ICdzb3VuZHMvc2FsdF9zb3VuZC5tcDMnO1xuICBjb25zdCAkbW92ZVNvdW5kID0gJCgnLm1vdmVTb3VuZCcpWzBdO1xuICAkbW92ZVNvdW5kLnNyYyA9ICdzb3VuZHMvbW92ZV9zb3VuZC5tcDMnO1xuICBjb25zdCAkbW92ZVNvdW5kVHdvID0gJCgnLm1vdmVTb3VuZDInKVswXTtcbiAgJG1vdmVTb3VuZFR3by5zcmMgPSAnc291bmRzL21vdmVfc291bmQyLm1wMyc7XG4gIGNvbnN0ICRlcnJvclNvdW5kID0gJCgnLmVycm9yU291bmQnKVswXTtcbiAgJGVycm9yU291bmQuc3JjID0gJ3NvdW5kcy9lcnJvcl9zb3VuZC5tcDMnO1xuICBjb25zdCAkd2luU291bmQgPSAkKCcud2luU291bmQnKVswXTtcbiAgJHdpblNvdW5kLnNyYyA9ICdzb3VuZHMvd2lubmluZ19zb3VuZC5tcDMnO1xuICAvLyBWYXJpYWJsZXMgdGhhdCB1cGRhdGUgZHVyaW5nIHRoZSBnYW1lLCBiYXNlZCBvbiB0dXJuL2FiaWx0aWVzIHVzZWQuXG4gIGxldCAkdHJhY2sgPSAkKCcudHJhY2sxJyk7XG4gIGxldCBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgbGV0IFBsYXllck9uZUJvb3N0UmVtYWluaW5nID0gMTtcbiAgbGV0IFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID0gMTtcbiAgbGV0IFBsYXllck9uZVNhbHRSZW1haW5pbmcgPSAxO1xuICBsZXQgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9IDE7XG4gIGxldCBpbmRleCA9IG51bGw7XG4gIGxldCBwbGF5ZXJPbmVUcmFja2VyID0gbnVsbDtcbiAgbGV0IGlzT25lUGxheWVyID0gZmFsc2U7XG4gIGxldCBhaU1vdmVEZWNpZGVyID0gbnVsbDtcblxuICAvLyBmdW5jdGlvbiB0aGF0IGNoZWNrcyB0byBzZWUgaWYgZWl0aGVyIHBsYXllciBpcyBpbiBhIHdpbm5pbmcgcG9zaXRpb24sIHBvc3Rpb24gaXMgZGV0ZXJtaW5lcyBpZiB0aGUgaW5kZXggb2YgdGhlIG9jY3VwaWVkIHNwYWNlIGlzIGVxdWFsIHRvIG9yIGdyZWF0ZXIgdGhhbiAyMSh0aGUgZmluaXNoIGxpbmUpLCB0aGVyZSBhcmUgaGlkZGVuIHJ1biBvZmYgYm94ZXMgdGhhdCBhbHNvIGV2YXVsYXRlIHRoZSB3aW5uZXIgaWYgdGhlIGZpbmFsIG1vdmUgd291bGQgb2YgdGFrZSB0aGVuIHBsYXllciBwYXNzZWQgaW5kZXggMjEuXG4gIGZ1bmN0aW9uIGNoZWNrV2lubmVyKCl7XG4gICAgaWYocGxheWVyT25lVHVybil7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgIGlmKGluZGV4ID49IDIxKXtcbiAgICAgICAgYWx3YXlzT25XaW4oKTtcbiAgICAgICAgJGZpbmlzaDEuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICAkZmluaXNoMS5hZGRDbGFzcygnd2lubmVyJyk7XG4gICAgICAgICQoJy5wbGF5ZXJPbmVXaW4nKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAkKCcuYWlXaW4nKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZighcGxheWVyT25lVHVybil7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazIucGxheWVyJykuaW5kZXgoKTtcbiAgICAgIGlmKGluZGV4ID49IDIxKXtcbiAgICAgICAgYWx3YXlzT25XaW4oKTtcbiAgICAgICAgJGZpbmlzaDIuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICAkZmluaXNoMi5hZGRDbGFzcygnd2lubmVyJyk7XG4gICAgICAgIGlmKCFpc09uZVBsYXllcil7XG4gICAgICAgICAgJCgnLnBsYXllclR3b1dpbicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgIH0gZWxzZSBpZihpc09uZVBsYXllcil7XG4gICAgICAgICAgJCgnLmFpV2luJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyByZWZhY3RvcmVkIGFzIHRoZXNlIGV2ZW50cyBhbHdheXMgaGFwcGVuIHJlZ2FyZGxlc3Mgb2Ygd2hvIHdpbnMuXG4gIGZ1bmN0aW9uIGFsd2F5c09uV2luKCl7XG4gICAgJHdpblNvdW5kLnBsYXkoKTtcbiAgICAkZmVlZGJhY2suYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkY29udHJvbGxlci5hZGRDbGFzcygnaGlkZScpO1xuICAgICRyZXNldC5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICRyZXN1bHRCb3gucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgfVxuXG4gIC8vIHRoaXMgZnVuY3Rpb24gZGV0ZXJtaW5lcyB3aG9zIHR1cm4gaXQgaXMgYW5kIHVwZGF0ZXMgdGhlIG9uIHNjcmVlbiBwb3JtcHQgYWNjb3JkaW5nbHksIGl0IGlzIGZpcmVkIGRpcmVjdGx5IGFmdGVyIHRoZSBjbGljayBldmVudCBvbiBtb3ZlLCBhbmQgaXQgZmlyZWQgaWYgYSBib29zdCBoYXBwZW5zIGFmdGVyIHVwZGF0aW5nIHRoZSBib29zdCBib29sZWFuLCBpdCB3b3JrcyBvbiB0aGUgb25lIHZhcmlhYmxlIHdoaWNoIGdldHMgdXBkYXRlZCBvZiBwbGF5ZXJPbmVUdXJuIGZyb20gdHJ1ZSB0byBmYWxzZS5cbiAgZnVuY3Rpb24gZGV0ZXJtaW5lVHVybigpe1xuICAgIGlmKHBsYXllck9uZVR1cm4pe1xuICAgICAgbG9jYXRlR2FyeSgpO1xuICAgICAgcGxheWVyT25lVHVybiA9IGZhbHNlO1xuICAgICAgJHRyYWNrID0gJCgnLnRyYWNrMicpO1xuICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAyXFwncyBUdXJuJyk7XG4gICAgfSBlbHNlIGlmKCFwbGF5ZXJPbmVUdXJuKXtcbiAgICAgIGxvY2F0ZUdhcnkoKTtcbiAgICAgIHBsYXllck9uZVR1cm4gPSB0cnVlO1xuICAgICAgJHRyYWNrID0gJCgnLnRyYWNrMScpO1xuICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxXFwncyBUdXJuJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gVGhpcyBmdW5jdGlvbiBsb2NhdGVzIGdhcnkgb24gdGhlIGJvYXJkLCB0aGUgc2VwZXJhdGUgcGFydHMgb2YgdGhlIGlmIGVsc2Ugc3RhdGVtZW50IHJ1biBiYXNlZCBvbiB3aGljaCBwbGF5ZXJzIHR1cm4gaXQgaXMsIG9uY2UgZG9pbmcgc28gaXQgZmlyZXMgb2ZmIHRoZSBtb3ZlR2FyeSBmdW5jdGlvbi4gT3IgaWYgaXQgZGV0ZWN0cyB0aGUgYm9vc3QgaGFzIGJlZW4gdXNlZChieSBpdCB1cGRhdGluZyBmcm9tIDEgdG8gMCBvbiB0aGUgYm9vc3QgYnV0dG9uIGNsaWNrKSBpZiBmaXJlcyBvZmYgdGhlIGJvb3N0R2FyeSBmdW5jdGlvbiBpbnN0ZWFkLCBpdCB0aGVuIHVwZGF0ZXMgdGhlIGJvb3N0IGNvdW50IHRvIDIgd2hpY2ggaW5mb3JtcyB0aGUgdXNlciB0aGUgYm9vc3QgaGFzIGJlZW4gdXNlZCB3aGVuIGNsaWNrZWQgYWdhaW4uXG4gIGZ1bmN0aW9uIGxvY2F0ZUdhcnkoKXtcbiAgICBpZihwbGF5ZXJPbmVUdXJuKXtcbiAgICAgIGluZGV4ID0gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgaWYoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPiAwKXtcbiAgICAgICAgJG1vdmVTb3VuZC5wbGF5KCk7XG4gICAgICAgIG1vdmVHYXJ5KCk7XG4gICAgICB9IGVsc2UgaWYoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDApIHtcbiAgICAgICAgYm9vc3RHYXJ5KCk7XG4gICAgICAgIFBsYXllck9uZUJvb3N0UmVtYWluaW5nID0gMjtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCFwbGF5ZXJPbmVUdXJuKXtcbiAgICAgIGluZGV4ID0gJCgnLnRyYWNrMi5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgaWYoUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPiAwKXtcbiAgICAgICAgJG1vdmVTb3VuZFR3by5wbGF5KCk7XG4gICAgICAgIG1vdmVHYXJ5KCk7XG4gICAgICB9ZWxzZSBpZihQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9PT0gMCkge1xuICAgICAgICBib29zdEdhcnkoKTtcbiAgICAgICAgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPSAyO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIFRoaXMgZnVuY3Rpb24gbW92ZXMgZ2FyeSwgaXQgZmlyc3QgZGV0ZXJtaW5lcyBpZiBpdCBpcyBhIHJlZ3VsYXIgbW92ZSBvciBhIGJvb3N0IG1vdmUsIGlmIGl0IGlzIGEgcmVndWxhciBtb3ZlIGl0IG1vdmVzIHRoZSBjdXJyZW50IHBsYXllcnMgR2FyeSBiZXR3ZWVuIDEgYW5kIDMgaW5kZXggc3BhY2VzIGFsb25nLCBmaW5hbGx5LCBpdCBydW5zIHRoZSBjaGVja1dpbm5lciBmdW5jdGlvbiB0byBzZWUgaWYgYSB3aW4gY29uZGl0aW9uIGhhcyBiZWVuIG1ldC5cbiAgZnVuY3Rpb24gbW92ZUdhcnkoKSB7XG4gICAgaWYoIWlzT25lUGxheWVyKXtcbiAgICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgJHRyYWNrLmVxKGluZGV4ICsgKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMSApICkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgY2hlY2tXaW5uZXIoKTtcbiAgICB9IGVsc2UgaWYoaXNPbmVQbGF5ZXIpe1xuICAgICAgJG1vdmVTb3VuZC5wbGF5KCk7XG4gICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDEgZ2V0XFwncyBtb3ZpbmchJyk7XG4gICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICR0cmFjay5lcShpbmRleCArIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKSArIDEgKSApLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgIGNoZWNrV2lubmVyKCk7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgIGlmKGluZGV4IDwgMjEpe1xuICAgICAgICBhaU1vdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBUaGlzIGZ1bmN0aW9uIGZpcmVzIG9mZiBpZiB0aGUgYm9vc3QgYnV0dG9uIGlzIGNsaWNrZWQgb24sIHRoZSBjbGljayBldmVudCB1cGRhdGVzIHRoZSBib29zdCBjb3VudCBhbmQgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiB0aGUgbG9jYXRlR2FyeSBpcyBydW5uaW5nLiBJdCBndWFyZW50ZWVzIHRoZSB1c2VyIGEgbW92ZSBvZiA1IHNwYWNlcyB0aGVuIHJ1bnMgdGhlIGNoZWNrIHdpbm5lciBmdW5jdGlvbiB0byBzZWUgaWYgYSB3aW4gY29uZGl0aW9uIGhhcyBiZWVuIG1ldC4gdGhpcyBpZiBmb3IgdGhlIDIgcGxheWVyIHZlcnNpb24uXG4gIGZ1bmN0aW9uIGJvb3N0R2FyeSgpIHtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgICAkdHJhY2suZXEoaW5kZXggKyA1KS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICBjaGVja1dpbm5lcigpO1xuICAgIH0gZWxzZSBpZihpc09uZVBsYXllcil7XG4gICAgICAkYm9vc3RTb3VuZC5wbGF5KCk7XG4gICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICR0cmFjay5lcShpbmRleCArIDUpLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgIGNoZWNrV2lubmVyKCk7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgIGlmKGluZGV4IDwgMjEpe1xuICAgICAgICBhaU1vdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuXG4gIC8vIHRoZSBzYWx0R2FyeSBmdW5jdGlvbi4gZm9yIHRoZSAyIHBsYXllciB2ZXJzaW9uLlxuICBmdW5jdGlvbiBzYWx0R2FyeSgpIHtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgaWYoUGxheWVyT25lU2FsdFJlbWFpbmluZyA9PT0gMCl7XG4gICAgICAgIFBsYXllck9uZVNhbHRSZW1haW5pbmcgPSAyO1xuICAgICAgICBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgICAgICAgaW5kZXggPSAkKCcudHJhY2sxLnBsYXllcicpLmluZGV4KCk7XG4gICAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMiBoYXMgYmVlbiBzYWx0ZWQhIFBsYXllciAxIG1vdmVzIGFnYWluIScpO1xuICAgICAgICBtb3ZlR2FyeSgpO1xuICAgICAgfSBlbHNlIGlmKFBsYXllclR3b1NhbHRSZW1haW5pbmcgPT09IDApe1xuICAgICAgICBQbGF5ZXJUd29TYWx0UmVtYWluaW5nID0gMjtcbiAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIGhhcyBiZWVuIHNhbHRlZCEgUGxheWVyIDIgbW92ZXMgYWdhaW4hJyk7XG4gICAgICAgIGluZGV4ID0gJCgnLnRyYWNrMi5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgICBtb3ZlR2FyeSgpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZihpc09uZVBsYXllcil7XG4gICAgICBpZihQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAwKXtcbiAgICAgICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gICAgICAgICR0cmFjayA9ICQoJy50cmFjazEnKTtcbiAgICAgICAgaW5kZXggPSAkKCcudHJhY2sxLnBsYXllcicpLmluZGV4KCk7XG4gICAgICAgICR0dXJuVGV4dC50ZXh0KCdNZWNoYSBHYXJ5IGhhcyBiZWVuIHNhbHRlZCEgUGxheWVyIDEgbW92ZXMgYWdhaW4hJyk7XG4gICAgICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICAkdHJhY2suZXEoaW5kZXggKyAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMykgKyAxICkgKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICAgIFBsYXllck9uZVNhbHRSZW1haW5pbmcgPSAyO1xuICAgICAgICBjaGVja1dpbm5lcigpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyBmdW5jdGlvbiBiZWxvdyBpcyBmb3IgdGhlIG9uZSBwbGF5ZXIgbW9kZSwgaXQgdHJhY2tzIHBsYXllciAxcyBwb3N0aW9uIGFuZCBzYXZlcyBpdCBpbiBwbGF5ZXIgMSB0cmFja2VyLCB0aGVuIG1ha2VzIGEgZGVzaWNpb24gYmFzZWQgb24gdGhhdCBwb3N0aW9uLCB0aGUgYmlnZ2VyIHRoZSBudW1iZXIgaW4gcGxheWVyIHRyYWNrZXIgdGhlIG1vcmUgbGlrZWxpbmVzcyBvZiBpdCB1c2luZyBvbmUgb2YgdGhlIGFiaWxpdHkgbW92ZXMuIFRoZSBmaXJzdCB0aHJlZSBmdW5jdGlvbnMgZGVmaW5lIHRoZSBhY3R1YWwgbW92ZSB0byBtYWtlIGl0IG1vcmUgcmVhZGFibGUgaW4gdGhlIGFjdHVhbCBhaSBkZXNpY2lvbiBmdW5jdGlvbi5cbiAgZnVuY3Rpb24gYWlTYWx0KCl7XG4gICAgJHR1cm5UZXh0LnRleHQoJ01lY2hhIEdhcnkgaGFzIHNhbHRlZCB5b3UsIGhlIG1vdmVzIGFnYWluIScpO1xuICAgICRzYWx0U291bmQucGxheSgpO1xuICAgIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPSAyO1xuICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICR0cmFjay5lcShpbmRleCArIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKSArIDEgKSApLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICBhaU1vdmUoKTtcbiAgICB9LCA3NTApO1xuICAgIHBsYXllck9uZVR1cm4gPSBmYWxzZTtcbiAgICBjaGVja1dpbm5lcigpO1xuICAgIHBsYXllck9uZVR1cm4gPSB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gYWlCb29zdCgpe1xuICAgICRib29zdFNvdW5kLnBsYXkoKTtcbiAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAkdHJhY2suZXEoaW5kZXggKyA1KS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgJHR1cm5UZXh0LnRleHQoJ01lY2hhIEdhcnkgaGFzIGJvb3N0ZWQhJyk7XG4gICAgcGxheWVyT25lVHVybiA9IGZhbHNlO1xuICAgIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID0gMjtcbiAgICBjaGVja1dpbm5lcigpO1xuICAgIHBsYXllck9uZVR1cm4gPSB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gYWlSZWcoKXtcbiAgICAkbW92ZVNvdW5kVHdvLnBsYXkoKTtcbiAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAkdHJhY2suZXEoaW5kZXggKyAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMykgKyAxICkgKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgJHR1cm5UZXh0LnRleHQoJ01lY2hhIEdhcnkgaGFzIG1hZGUgaGlzIG1vdmUhJyk7XG4gICAgcGxheWVyT25lVHVybiA9IGZhbHNlO1xuICAgIGNoZWNrV2lubmVyKCk7XG4gICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gIH1cblxuICBmdW5jdGlvbiBhaU1vdmUoKXtcbiAgICBwbGF5ZXJPbmVUcmFja2VyID0gaW5kZXg7XG4gICAgJHRyYWNrID0gJCgnLnRyYWNrMicpO1xuICAgIGluZGV4ID0gJCgnLnRyYWNrMi5wbGF5ZXInKS5pbmRleCgpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIGlmKHBsYXllck9uZVRyYWNrZXIgPD0gNCl7XG4gICAgICAgIGFpUmVnKCk7XG4gICAgICB9ZWxzZSBpZihwbGF5ZXJPbmVUcmFja2VyID4gNCAmJiBwbGF5ZXJPbmVUcmFja2VyIDwgMTUpe1xuICAgICAgICBhaU1vdmVEZWNpZGVyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNSkgKyAxO1xuICAgICAgICBpZihhaU1vdmVEZWNpZGVyIDw9IDIpe1xuICAgICAgICAgIGFpUmVnKCk7XG4gICAgICAgIH1lbHNlIGlmKGFpTW92ZURlY2lkZXIgPiAyICYmIGFpTW92ZURlY2lkZXIgPD00ICYmIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICBhaUJvb3N0KCk7XG4gICAgICAgIH0gZWxzZSBpZihhaU1vdmVEZWNpZGVyID4gMiAmJiBhaU1vdmVEZWNpZGVyIDw9NCAmJiBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICAgYWlSZWcoKTtcbiAgICAgICAgfSBlbHNlIGlmKGFpTW92ZURlY2lkZXIgPT09IDUgJiYgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgYWlTYWx0KCk7XG4gICAgICAgIH0gZWxzZSBpZihhaU1vdmVEZWNpZGVyID09PSA1ICYmIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgIGFpUmVnKCk7XG4gICAgICAgIH1cbiAgICAgIH1lbHNlIGlmKHBsYXllck9uZVRyYWNrZXIgPiAxNCl7XG4gICAgICAgIGFpTW92ZURlY2lkZXIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA1KSArIDE7XG4gICAgICAgIGlmKGFpTW92ZURlY2lkZXIgPD0zICYmIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICBhaUJvb3N0KCk7XG4gICAgICAgIH0gZWxzZSBpZihhaU1vdmVEZWNpZGVyIDw9MyAmJiBQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9PT0gMiAmJiBQbGF5ZXJUd29TYWx0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICBhaVNhbHQoKTtcbiAgICAgICAgfSBlbHNlIGlmKGFpTW92ZURlY2lkZXIgPD0zICYmIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAyICYmIFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgIGFpUmVnKCk7XG4gICAgICAgIH0gZWxzZSBpZihhaU1vdmVEZWNpZGVyID4gMyAmJiBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICBhaVNhbHQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhaVJlZygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgMTUwMCk7XG4gIH1cbiAgLy8gdmFyaW91cyBldmVudCBsaXN0ZW5lcnMgYmVsb3cuXG5cbiAgLy8gVGhpcyBpcyB0aGUgY2xpY2sgZXZlbnQgZm9yIHRoZSBtb3ZlIGJ1dHRvbiwgd2hlbiBjbGlja2VkIGl0IGZpcmVzIG9mZiB0aGUgZGV0ZXJtaW5lVHVybiBmdW5jdGlvbiB3aGljaCBzZXRzIGluIG1vdGlvbiB0aGUgbG9jYXRlR2FyeSBhbmQgbW92ZUdhcnkgZnVuY3Rpb25zLiBOb3cgaGFzIGEgc2VwZXJhdGUgcGFydCBmb3IgdGhlIDEgdmVyc2lvbiB3aGljaCBza2lwcyB0aGUgdHVybiBjaGVja2VyLlxuICBmdW5jdGlvbiBtb3ZlRXZlbnQoKXtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgJG1vdmUub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnMnAgbW92ZSBydW4nKTtcbiAgICAgICAgZGV0ZXJtaW5lVHVybigpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmKGlzT25lUGxheWVyKSB7XG4gICAgICAkbW92ZS5vbignY2xpY2snLCgpID0+e1xuICAgICAgICBjb25zb2xlLmxvZygnMXAgbW92ZSBydW4nKTtcbiAgICAgICAgJHRyYWNrID0gJCgnLnRyYWNrMScpO1xuICAgICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgICAgbW92ZUdhcnkoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIHRoaXMgaXMgdGhlIGNsaWNrIGV2ZW50IGZvciB0aGUgYm9vc3QgYnV0dG9uLCB3aGVuIGNsaWNrZWQgaXQgY2hlY2tzIGZpcnN0IHRvIHNlZSBpZiB0aGUgcGxheWVyIGhhcyBhbHJlYWR5IHVzZWQgdGhlaXIgYm9vc3QsIGlmIG5vdCBpdCB1cGRhdGVzIHRoYXQgaW5mb3JtYXRpb24gYW5kIHJ1bnMgdGhlIGRldGVybWluZVR1cm4gZnVuY3Rpb24gbGlrZSBhIG5vcm1hbCBtb3ZlLCB3aGVuIHRoaXMgcmVhY2hlcyB0aGUgbG9jYXRlR2FyeSBmdW5jdGlvbiwgaXQgdGFrZXMgbm90ZSB0aGF0IHRoZSBib29zdCBoYXMgYmVlbiB1c2VkIHRvIGZpcmUgb2ZmIHRoZSBib29zdEdhcnkgZnVuY3Rpb24gaW5zdGVhZCBvZiB0aGUgbW92ZUdhcnkgZnVuY3Rpb24uIEl0IHRoZW4gdXBkYXRlcyB0aGUgYm9vc3QgcmVtYWluaW5nIGFnYWluLCBzbyB0aGF0IGlmIGFub3RoZXIgYm9vc3QgaXMgYXR0ZW1wdGVkLCBpdCBpbmZvcm1zIHRoZSB1c2VyIHRoYXQgdGhlaXIgYm9vc3QgaGFzIGFscmVhZHkgYmVlbiB1c2VkLlxuICBmdW5jdGlvbiBib29zdEV2ZW50KCl7XG4gICAgaWYoIWlzT25lUGxheWVyKXtcbiAgICAgICRib29zdC5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGlmKHBsYXllck9uZVR1cm4pe1xuICAgICAgICAgIGlmKFBsYXllck9uZUJvb3N0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICAgICRib29zdFNvdW5kLnBsYXkoKTtcbiAgICAgICAgICAgIFBsYXllck9uZUJvb3N0UmVtYWluaW5nID0gMDtcbiAgICAgICAgICAgIGRldGVybWluZVR1cm4oKTtcbiAgICAgICAgICB9IGVsc2UgaWYoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgICAgJGVycm9yU291bmQucGxheSgpO1xuICAgICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIGJvb3N0IGFscmVhZHkgdXNlZCEnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoIXBsYXllck9uZVR1cm4pe1xuICAgICAgICAgIGlmKFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICAgICRib29zdFNvdW5kLnBsYXkoKTtcbiAgICAgICAgICAgIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID0gMDtcbiAgICAgICAgICAgIGRldGVybWluZVR1cm4oKTtcbiAgICAgICAgICB9IGVsc2UgaWYoUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgICAgJGVycm9yU291bmQucGxheSgpO1xuICAgICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAyIGJvb3N0IGFscmVhZHkgdXNlZCEnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZihpc09uZVBsYXllcil7XG4gICAgICAkYm9vc3Qub24oJ2NsaWNrJywoKSA9PntcbiAgICAgICAgaWYoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgICR0cmFjayA9ICQoJy50cmFjazEnKTtcbiAgICAgICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgICAgICBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9IDI7XG4gICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIHVzZXMgYm9vc3QhJyk7XG4gICAgICAgICAgYm9vc3RHYXJ5KCk7XG4gICAgICAgIH0gZWxzZSBpZiAoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgICRlcnJvclNvdW5kLnBsYXkoKTtcbiAgICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDEgaGFzIGFscmVhZHkgdXNlZCBib29zdCEnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gYmVsb3cgaXMgdGhlIGV2ZW50IGxpc3RlbmVyIGZvciB0aGUgc2FsdCBhYmlsaXR5LiBVc2luZyB0aGlzIHdpbGwgc3RvcCB5b3VyIG9wcG9uZW50cyBuZXh0IHR1cm4gYW5kIGdpdmUgZ2FyeSBhIG5vcm1hbCBnYXJ5TW92ZSB3aGlsZSB1c2luZyBpdC4gSWYgYSBwbGF5ZXIgaGFzIGFscmVhZHkgdXNlZCB0aGVpciBzYWx0IGl0IGluZm9ybXMgdGhlbSBvbiB0aGUgJHR1cm5UZXh0IGZlZWRiYWNrLlxuICBmdW5jdGlvbiBzYWx0RXZlbnQoKXtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgJHNhbHQub24oJ2NsaWNrJywoKSA9PiB7XG4gICAgICAgIGlmKHBsYXllck9uZVR1cm4pe1xuICAgICAgICAgIGlmKFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgICAgJHNhbHRTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgICBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0gMDtcbiAgICAgICAgICAgIHNhbHRHYXJ5KCk7XG4gICAgICAgICAgfSBlbHNlIGlmKFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgICAgJGVycm9yU291bmQucGxheSgpO1xuICAgICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIGhhcyBhbHJlYWR5IHVzZWQgU2FsdCEnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZighcGxheWVyT25lVHVybil7XG4gICAgICAgICAgaWYoUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgICAkc2FsdFNvdW5kLnBsYXkoKTtcbiAgICAgICAgICAgIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPSAwO1xuICAgICAgICAgICAgc2FsdEdhcnkoKTtcbiAgICAgICAgICB9IGVsc2UgaWYoUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICAgICAkZXJyb3JTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDIgaGFzIGFscmVhZHkgdXNlZCBTYWx0IScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmKGlzT25lUGxheWVyKXtcbiAgICAgICRzYWx0Lm9uKCdjbGljaycsKCkgPT4ge1xuICAgICAgICBpZihQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0gMDtcbiAgICAgICAgICAkc2FsdFNvdW5kLnBsYXkoKTtcbiAgICAgICAgICBzYWx0R2FyeSgpO1xuICAgICAgICB9IGVsc2UgaWYoUGxheWVyT25lU2FsdFJlbWFpbmluZyA9PT0yKXtcbiAgICAgICAgICAkZXJyb3JTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIGhhcyBhbHJlYWR5IHVzZWQgU2FsdCEnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gQ2xpY2sgZXZlbnQgdG8gc3RhcnQgdGhlIGdhbWUsIHJlbW92ZXMgdGhlIGluc3RydWN0aW9uIHBhZ2UgYW5kIHRoZW4gc2hvd3MgdGhlIHJhY2V0cmFjaywgZmVlZGJhY2sgYm94IGFuZCBjb250cm9sbGVyLlxuXG4gICRzdGFydC5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgJCgnLmluc3RydWN0aW9ucycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJCgnLmJvYXJkJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuY29udHJvbGxlcicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgJCgnLmZlZWRiYWNrJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICBtb3ZlRXZlbnQoKTtcbiAgICBib29zdEV2ZW50KCk7XG4gICAgc2FsdEV2ZW50KCk7XG4gICAgJGF1ZGlvVGhlbWUucGxheSgpO1xuICB9KTtcblxuICAvLyBjbGljayBldmVudCB0byBzdGFydCB0aGUgMXAgb3B0aW9uLlxuICAkc3RhcnQxUGxheWVyLm9uKCdjbGljaycsKCkgPT4ge1xuICAgIGlzT25lUGxheWVyID0gdHJ1ZTtcbiAgICAkKCcuaW5zdHJ1Y3Rpb25zJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuYm9hcmQnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICQoJy5jb250cm9sbGVyJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuZmVlZGJhY2snKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIG1vdmVFdmVudCgpO1xuICAgIGJvb3N0RXZlbnQoKTtcbiAgICBzYWx0RXZlbnQoKTtcbiAgICAkdHVyblRleHQudGV4dCgnTWFrZSB5b3VyIGZpcnN0IG1vdmUhJyk7XG4gICAgJGF1ZGlvVGhlbWUucGxheSgpO1xuICB9KTtcblxuICAvLyBFdmVudCBsaXN0ZW5lciBmb3IgdGhlIHJlc2V0IGJ1dHRvbiwgaXQgYmFzaWNhbGx5IGhpZGVzIGFsbCBvZiB0aGUgZmVlZGJhY2sgZnJvbSB0aGUgcmVtYWluaW5nIGdhbWUgYW5kIG1vdmVzIGJvdGggcGxheWVyIGljb25zIGJhY2sgdG8gdGhlIHN0YXJ0IGxpbmUsIGl0IGFsc28gcmVzZXRzIHRoZSBzYWx0IGFuZCBib29zdCBjb3VudGVycyB0byAxIHNvIHRoYXQgdGhleSBjYW4gbm93IGJlIHVzZWQgYWdhaW4uIGZ1bm5jdGlvbiBiZWxvdyB0aGF0IGlzIHNvbWUgcmVmYWN0b3JpbmcgZm9yIGNvbW1hbmRzIHRoYXQgaGFwcGVuIHJlZ2FyZGxlc3Mgb2YgMXAgb3IgMnAgbW9kZS5cblxuICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICRyZXNldC5vbignY2xpY2snLCgpID0+IHtcbiAgICAgIGFsd2F5c09uUmVzZXQoKTtcbiAgICAgICQoJy5wbGF5ZXJUd29XaW4nKS5hZGRDbGFzcygnaGlkZScpO1xuICAgIH0pO1xuICB9IGVsc2UgaWYoaXNPbmVQbGF5ZXIpe1xuICAgICRyZXNldC5vbignY2xpY2snLCgpID0+IHtcbiAgICAgIGFsd2F5c09uUmVzZXQoKTtcbiAgICAgICQoJy5haVdpbicpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDFcXCdzIHRpbWUgdG8gc2hpbmUhJyk7XG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gYWx3YXlzT25SZXNldCgpe1xuICAgICQoJy50cmFjazEnKS5yZW1vdmVDbGFzcygncGxheWVyIHdpbm5lcicpO1xuICAgICQoJy5zdGFydDEnKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPSAxO1xuICAgIFBsYXllck9uZVNhbHRSZW1haW5pbmcgPTE7XG4gICAgJCgnLnRyYWNrMicpLnJlbW92ZUNsYXNzKCdwbGF5ZXIgd2lubmVyJyk7XG4gICAgJCgnLnN0YXJ0MicpLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICBQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9IDE7XG4gICAgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9IDE7XG4gICAgcGxheWVyT25lVHJhY2tlciA9IG51bGw7XG4gICAgJCgnLmNvbnRyb2xsZXInKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICQoJy5mZWVkYmFjaycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgJCgnLnJlc3VsdEJveCcpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJCgnLnBsYXllck9uZVdpbicpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJGF1ZGlvVGhlbWUuc3JjID0gJyc7XG4gICAgJGF1ZGlvVGhlbWUuc3JjID0gJ3NvdW5kcy9jbG9zaW5nX3RoZW1lLm1wMyc7XG4gICAgJGF1ZGlvVGhlbWUucGxheSgpO1xuICB9XG59KTtcbiJdfQ==
