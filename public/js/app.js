"use strict";$(function(){function a(){(N=H?$(".track1.player").index():$(".track2.player").index())>=21&&(e(),(H?b:S).addClass("player winner"),H?($(".playerOneWin").removeClass("hide"),$(".aiWin").addClass("hide")):R?$(".aiWin").removeClass("hide"):$(".playerTwoWin").removeClass("hide"))}function e(){E.play(),g.addClass("hide"),W.addClass("hide"),w.removeClass("hide"),T.removeClass("hide")}function l(){r(),F=H?$(".track2"):$(".track1"),q.text(H?"Player 2's Turn":"Player 1's Turn"),H=!H}function r(){N=H?$(".track1.player").index():$(".track2.player").index(),H?I>0?(z.play(),s()):0===I&&(t(),I=2):J>0?(A.play(),s()):0===J&&(t(),J=2)}function s(){R?(z.play(),q.text("Player 1 get's moving!"),F.eq(N).removeClass("player"),F.eq(N+(Math.floor(3*Math.random())+1)).addClass("player"),a(),(N=$(".track1.player").index())<21&&c()):(F.eq(N).removeClass("player"),F.eq(N+(Math.floor(3*Math.random())+1)).addClass("player"),a())}function t(){R?(_.play(),F.eq(N).removeClass("player"),F.eq(N+5).addClass("player"),a(),(N=$(".track1.player").index())<21&&c()):(F.eq(N).removeClass("player"),F.eq(N+5).addClass("player"),a())}function n(){R?R&&0===K&&(H=!0,F=$(".track1"),N=$(".track1.player").index(),q.text("Mecha Gary has been salted!   Player 1 moves again!"),F.eq(N).removeClass("player"),F.eq(N+(Math.floor(3*Math.random())+1)).addClass("player"),K=2,a()):0===K?(K=2,H=!0,N=$(".track1.player").index(),q.text("Player 2 has been salted! Player 1 moves again!"),s()):0===L&&(L=2,q.text("Player 1 has been salted!   Player 2 moves again!"),N=$(".track2.player").index(),s())}function o(){q.text("Mecha Gary has salted you, he moves again!"),j.play(),L=2,F.eq(N).removeClass("player"),F.eq(N+(Math.floor(3*Math.random())+1)).addClass("player"),setTimeout(function(){i()},1e3),H=!1,a(),H=!0}function d(){_.play(),F.eq(N).removeClass("player"),F.eq(N+5).addClass("player"),q.text("Mecha Gary has boosted!   Player 1's turn "),H=!1,J=2,a(),H=!0}function i(){A.play(),F.eq(N).removeClass("player"),F.eq(N+(Math.floor(3*Math.random())+1)).addClass("player"),q.text("Mecha Gary has made his move!   Player 1's turn"),H=!1,a(),H=!0}function y(){N=$(".track1.player").index(),Q=N}function c(){y(),F=$(".track2"),N=$(".track2.player").index(),setTimeout(function(){Q<=4?i():Q>4&&Q<15?(U=Math.floor(5*Math.random())+1,U<=2?i():U>2&&U<=4&&1===J?d():U>2&&U<=4&&2===I?i():5===U&&1===L?o():5===U&&2===L&&i()):Q>=15&&(U=Math.floor(5*Math.random())+1,U<=3&&1===J?d():U<=3&&2===J&&1===L?o():U<=3&&2===J&&2===K?i():U>3&&1===K?o():i())},1e3)}function p(){R?(F=$(".track1"),N=$(".track1.player").index(),s()):l()}function u(){R?1===I?(F=$(".track1"),N=$(".track1.player").index(),I=2,q.text("Player 1 uses boost!"),t()):2===I&&(D.play(),q.text("Player 1 has already used boost!")):H?1===I?(_.play(),I=0,l()):2===I&&(D.play(),q.text("Player 1 boost already used!")):1===J?(_.play(),J=0,l()):2===J&&(D.play(),q.text("Player 2 boost already used!"))}function h(){R?1===K?(K=0,j.play(),n()):2===K&&(D.play(),q.text("Player 1 has already used Salt!")):H?1===K?(j.play(),K=0,n()):2===K&&(D.play(),q.text("Player 1 has already used Salt!")):1===L?(j.play(),L=0,n()):2===L&&(D.play(),q.text("Player 2 has already used Salt!"))}function m(){G.addClass("hide"),B.removeClass("hide"),W.removeClass("hide"),g.removeClass("hide"),O.play()}function C(){f(),R?$(".aiWin").addClass("hide"):$(".playerTwoWin").addClass("hide")}function f(){$(".track1").removeClass("player winner"),$(".start1").addClass("player"),I=1,K=1,$(".track2").removeClass("player winner"),$(".start2").addClass("player"),J=1,L=1,Q=null,$(".controller").removeClass("hide"),$(".feedback").removeClass("hide"),$(".resultBox").addClass("hide"),$(".playerOneWin").addClass("hide"),O.src="",O.src="sounds/closing_theme.mp3",O.play()}var v=$(".startbtn2"),k=$(".startbtn1"),x=$(".move"),M=$(".boost"),P=$(".salt"),q=$(".turn"),b=$(".finish1"),S=$(".finish2"),g=$(".feedback"),W=$(".controller"),w=$(".reset"),T=$(".resultBox"),G=$(".instructions"),B=$(".board"),O=$(".theme")[0];O.src="sounds/closing_theme.mp3";var _=$(".boostSound")[0],j=$(".saltSound")[0],z=$(".moveSound")[0],A=$(".moveSound2")[0],D=$(".errorSound")[0],E=$(".winSound")[0],F=$(".track1"),H=!0,I=1,J=1,K=1,L=1,N=null,Q=null,R=!1,U=null;x.on("click",p),M.on("click",u),P.on("click",h),v.on("click",function(){m()}),k.on("click",function(){R=!0,m(),q.text("Make your first move!")}),w.on("click",C)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiY2hlY2tXaW5uZXIiLCJpbmRleCIsInBsYXllck9uZVR1cm4iLCIkZmluaXNoMSIsIiRmaW5pc2gyIiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsImlzT25lUGxheWVyIiwiYWx3YXlzT25XaW4iLCIkd2luU291bmQiLCJwbGF5IiwiJGZlZWRiYWNrIiwiJGNvbnRyb2xsZXIiLCJkZXRlcm1pbmVUdXJuIiwibG9jYXRlR2FyeSIsIiR0cmFjayIsIm1vdmVHYXJ5IiwiJG1vdmVTb3VuZCIsIlBsYXllck9uZUJvb3N0UmVtYWluaW5nIiwiUGxheWVyVHdvQm9vc3RSZW1haW5pbmciLCIkbW92ZVNvdW5kVHdvIiwiJHR1cm5UZXh0IiwidGV4dCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImVxIiwiYm9vc3RHYXJ5IiwiJGJvb3N0U291bmQiLCJzYWx0R2FyeSIsIlBsYXllck9uZVNhbHRSZW1haW5pbmciLCJQbGF5ZXJUd29TYWx0UmVtYWluaW5nIiwiYWlTYWx0IiwiJHNhbHRTb3VuZCIsInNldFRpbWVvdXQiLCJhaVJlZyIsImFpQm9vc3QiLCJwbGF5ZXJPbmVUcmFjayIsImFpTW92ZSIsImFpTW92ZURlY2lkZXIiLCJwbGF5ZXJPbmVUcmFja2VyIiwibW92ZUV2ZW50IiwiYm9vc3RFdmVudCIsIiRlcnJvclNvdW5kIiwic2FsdEV2ZW50IiwiYWx3YXlzT25TdGFydCIsIiRpbnN0cnVjdGlvbnMiLCIkYm9hcmQiLCIkYXVkaW9UaGVtZSIsInJlc2V0IiwiYWx3YXlzT25SZXNldCIsInNyYyIsIiRzdGFydCIsIiRzdGFydDFQbGF5ZXIiLCIkbW92ZSIsIiRib29zdCIsIiRzYWx0IiwiJHJlc2V0IiwiJHJlc3VsdEJveCIsIm9uIl0sIm1hcHBpbmdzIjoiWUFBQUEsR0FBRSxXQXNDQSxRQUFTQyxNQURUQyxFQUFBQyxFQUFBSCxFQUFBLGtCQUFBRSxRQUFBRixFQUFBLGtCQUFBRSxVQUNTRCxLQUNQQyxLQUNBQyxF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WSxFQUFPRSxHQUFHLFFBQVNWIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiQoKCkgPT4ge1xuICAvLyBMaXN0IG9mIHZhcmlhYmxlcyBuZWVkZWQgZm9yIHRoZSBnYW1lXG4gIGNvbnN0ICRzdGFydCA9ICQoJy5zdGFydGJ0bjInKTtcbiAgY29uc3QgJHN0YXJ0MVBsYXllciA9ICQoJy5zdGFydGJ0bjEnKTtcbiAgY29uc3QgJG1vdmUgPSAkKCcubW92ZScpO1xuICBjb25zdCAkYm9vc3QgPSAkKCcuYm9vc3QnKTtcbiAgY29uc3QgJHNhbHQgPSAkKCcuc2FsdCcpO1xuICBjb25zdCAkdHVyblRleHQgPSAkKCcudHVybicpO1xuICBjb25zdCAkZmluaXNoMSA9ICQoJy5maW5pc2gxJyk7XG4gIGNvbnN0ICRmaW5pc2gyID0gJCgnLmZpbmlzaDInKTtcbiAgY29uc3QgJGZlZWRiYWNrID0gJCgnLmZlZWRiYWNrJyk7XG4gIGNvbnN0ICRjb250cm9sbGVyID0gJCgnLmNvbnRyb2xsZXInKTtcbiAgY29uc3QgJHJlc2V0ID0gJCgnLnJlc2V0Jyk7XG4gIGNvbnN0ICRyZXN1bHRCb3ggPSAkKCcucmVzdWx0Qm94Jyk7XG4gIGNvbnN0ICRpbnN0cnVjdGlvbnMgPSAkKCcuaW5zdHJ1Y3Rpb25zJyk7XG4gIGNvbnN0ICRib2FyZCA9ICQoJy5ib2FyZCcpO1xuICAvLyBBdWRpbyB2YXJpYWJsZXMuXG4gIGNvbnN0ICRhdWRpb1RoZW1lID0gJCgnLnRoZW1lJylbMF07XG4gICRhdWRpb1RoZW1lLnNyYyA9ICdzb3VuZHMvY2xvc2luZ190aGVtZS5tcDMnO1xuICBjb25zdCAkYm9vc3RTb3VuZCA9ICQoJy5ib29zdFNvdW5kJylbMF07XG4gIGNvbnN0ICRzYWx0U291bmQgPSAkKCcuc2FsdFNvdW5kJylbMF07XG4gIGNvbnN0ICRtb3ZlU291bmQgPSAkKCcubW92ZVNvdW5kJylbMF07XG4gIGNvbnN0ICRtb3ZlU291bmRUd28gPSAkKCcubW92ZVNvdW5kMicpWzBdO1xuICBjb25zdCAkZXJyb3JTb3VuZCA9ICQoJy5lcnJvclNvdW5kJylbMF07XG4gIGNvbnN0ICR3aW5Tb3VuZCA9ICQoJy53aW5Tb3VuZCcpWzBdO1xuICAvLyBWYXJpYWJsZXMgdGhhdCB1cGRhdGUgZHVyaW5nIHRoZSBnYW1lLCBiYXNlZCBvbiB0dXJuL2FiaWx0aWVzIHVzZWQuXG4gIGxldCAkdHJhY2sgPSAkKCcudHJhY2sxJyk7XG4gIGxldCBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgbGV0IFBsYXllck9uZUJvb3N0UmVtYWluaW5nID0gMTtcbiAgbGV0IFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID0gMTtcbiAgbGV0IFBsYXllck9uZVNhbHRSZW1haW5pbmcgPSAxO1xuICBsZXQgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9IDE7XG4gIGxldCBpbmRleCA9IG51bGw7XG4gIGxldCBwbGF5ZXJPbmVUcmFja2VyID0gbnVsbDtcbiAgbGV0IGlzT25lUGxheWVyID0gZmFsc2U7XG4gIGxldCBhaU1vdmVEZWNpZGVyID0gbnVsbDtcblxuICAvLyBmdW5jdGlvbiB0aGF0IGNoZWNrcyB0byBzZWUgaWYgZWl0aGVyIHBsYXllciBpcyBpbiBhIHdpbm5pbmcgcG9zaXRpb24sIHBvc3Rpb24gaXMgZGV0ZXJtaW5lcyBpZiB0aGUgaW5kZXggb2YgdGhlIG9jY3VwaWVkIHNwYWNlIGlzIGVxdWFsIHRvIG9yIGdyZWF0ZXIgdGhhbiAyMSh0aGUgZmluaXNoIGxpbmUpLCB0aGVyZSBhcmUgaGlkZGVuIHJ1biBvZmYgYm94ZXMgdGhhdCBhbHNvIGV2YXVsYXRlIHRoZSB3aW5uZXIgaWYgdGhlIGZpbmFsIG1vdmUgd291bGQgb2YgdGFrZSB0aGVuIHBsYXllciBwYXNzZWQgaW5kZXggMjEuXG4gIGZ1bmN0aW9uIGNoZWNrV2lubmVyKCl7XG4gICAgaW5kZXggPSBwbGF5ZXJPbmVUdXJuID8gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpIDogJCgnLnRyYWNrMi5wbGF5ZXInKS5pbmRleCgpO1xuICAgIGlmKGluZGV4ID49IDIxKSB7XG4gICAgICBhbHdheXNPbldpbigpO1xuICAgICAgKHBsYXllck9uZVR1cm4gPyAkZmluaXNoMSA6ICRmaW5pc2gyKS5hZGRDbGFzcygncGxheWVyIHdpbm5lcicpO1xuXG4gICAgICBpZihwbGF5ZXJPbmVUdXJuKSB7XG4gICAgICAgICQoJy5wbGF5ZXJPbmVXaW4nKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAkKCcuYWlXaW4nKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYoIWlzT25lUGxheWVyKXtcbiAgICAgICAgICAkKCcucGxheWVyVHdvV2luJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkKCcuYWlXaW4nKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIC8vIHJlZmFjdG9yZWQgYXMgdGhlc2UgZXZlbnRzIGFsd2F5cyBoYXBwZW4gcmVnYXJkbGVzcyBvZiB3aG8gd2lucy5cbiAgZnVuY3Rpb24gYWx3YXlzT25XaW4oKXtcbiAgICAkd2luU291bmQucGxheSgpO1xuICAgICRmZWVkYmFjay5hZGRDbGFzcygnaGlkZScpO1xuICAgICRjb250cm9sbGVyLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJHJlc2V0LnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgJHJlc3VsdEJveC5yZW1vdmVDbGFzcygnaGlkZScpO1xuICB9XG5cbiAgLy8gdGhpcyBmdW5jdGlvbiBkZXRlcm1pbmVzIHdob3MgdHVybiBpdCBpcyBhbmQgdXBkYXRlcyB0aGUgb24gc2NyZWVuIHBvcm1wdCBhY2NvcmRpbmdseSwgaXQgaXMgZmlyZWQgZGlyZWN0bHkgYWZ0ZXIgdGhlIGNsaWNrIGV2ZW50IG9uIG1vdmUsIGFuZCBpdCBmaXJlZCBpZiBhIGJvb3N0IGhhcHBlbnMgYWZ0ZXIgdXBkYXRpbmcgdGhlIGJvb3N0IGJvb2xlYW4sIGl0IHdvcmtzIG9uIHRoZSBvbmUgdmFyaWFibGUgd2hpY2ggZ2V0cyB1cGRhdGVkIG9mIHBsYXllck9uZVR1cm4gZnJvbSB0cnVlIHRvIGZhbHNlLlxuICBmdW5jdGlvbiBkZXRlcm1pbmVUdXJuKCl7XG4gICAgbG9jYXRlR2FyeSgpO1xuICAgICR0cmFjayA9IHBsYXllck9uZVR1cm4gPyAkKCcudHJhY2syJykgOiAkKCcudHJhY2sxJyk7XG4gICAgJHR1cm5UZXh0LnRleHQocGxheWVyT25lVHVybiA/ICdQbGF5ZXIgMlxcJ3MgVHVybicgOiAnUGxheWVyIDFcXCdzIFR1cm4nKTtcbiAgICBwbGF5ZXJPbmVUdXJuID0gIXBsYXllck9uZVR1cm47XG4gIH1cblxuICAvLyBUaGlzIGZ1bmN0aW9uIGxvY2F0ZXMgZ2FyeSBvbiB0aGUgYm9hcmQsIHRoZSBzZXBlcmF0ZSBwYXJ0cyBvZiB0aGUgaWYgZWxzZSBzdGF0ZW1lbnQgcnVuIGJhc2VkIG9uIHdoaWNoIHBsYXllcnMgdHVybiBpdCBpcywgb25jZSBkb2luZyBzbyBpdCBmaXJlcyBvZmYgdGhlIG1vdmVHYXJ5IGZ1bmN0aW9uLiBPciBpZiBpdCBkZXRlY3RzIHRoZSBib29zdCBoYXMgYmVlbiB1c2VkKGJ5IGl0IHVwZGF0aW5nIGZyb20gMSB0byAwIG9uIHRoZSBib29zdCBidXR0b24gY2xpY2spIGlmIGZpcmVzIG9mZiB0aGUgYm9vc3RHYXJ5IGZ1bmN0aW9uIGluc3RlYWQsIGl0IHRoZW4gdXBkYXRlcyB0aGUgYm9vc3QgY291bnQgdG8gMiB3aGljaCBpbmZvcm1zIHRoZSB1c2VyIHRoZSBib29zdCBoYXMgYmVlbiB1c2VkIHdoZW4gY2xpY2tlZCBhZ2Fpbi5cbiAgZnVuY3Rpb24gbG9jYXRlR2FyeSgpe1xuICAgIGluZGV4ID0gcGxheWVyT25lVHVybiA/ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKSA6ICQoJy50cmFjazIucGxheWVyJykuaW5kZXgoKTtcbiAgICBpZihwbGF5ZXJPbmVUdXJuKXtcbiAgICAgIGlmKFBsYXllck9uZUJvb3N0UmVtYWluaW5nID4gMCl7XG4gICAgICAgICRtb3ZlU291bmQucGxheSgpO1xuICAgICAgICBtb3ZlR2FyeSgpO1xuICAgICAgfSBlbHNlIGlmKFBsYXllck9uZUJvb3N0UmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgIGJvb3N0R2FyeSgpO1xuICAgICAgICBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9IDI7XG4gICAgICB9XG4gICAgfSBlbHNle1xuICAgICAgaWYoUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPiAwKXtcbiAgICAgICAgJG1vdmVTb3VuZFR3by5wbGF5KCk7XG4gICAgICAgIG1vdmVHYXJ5KCk7XG4gICAgICB9ZWxzZSBpZihQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9PT0gMCkge1xuICAgICAgICBib29zdEdhcnkoKTtcbiAgICAgICAgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPSAyO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIFRoaXMgZnVuY3Rpb24gbW92ZXMgZ2FyeSwgaXQgZmlyc3QgZGV0ZXJtaW5lcyBpZiBpdCBpcyBhIHJlZ3VsYXIgbW92ZSBvciBhIGJvb3N0IG1vdmUsIGlmIGl0IGlzIGEgcmVndWxhciBtb3ZlIGl0IG1vdmVzIHRoZSBjdXJyZW50IHBsYXllcnMgR2FyeSBiZXR3ZWVuIDEgYW5kIDMgaW5kZXggc3BhY2VzIGFsb25nLCBmaW5hbGx5LCBpdCBydW5zIHRoZSBjaGVja1dpbm5lciBmdW5jdGlvbiB0byBzZWUgaWYgYSB3aW4gY29uZGl0aW9uIGhhcyBiZWVuIG1ldC5cbiAgZnVuY3Rpb24gbW92ZUdhcnkoKSB7XG4gICAgaWYoIWlzT25lUGxheWVyKXtcbiAgICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgJHRyYWNrLmVxKGluZGV4ICsgKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMSApICkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgY2hlY2tXaW5uZXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJG1vdmVTb3VuZC5wbGF5KCk7XG4gICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDEgZ2V0XFwncyBtb3ZpbmchJyk7XG4gICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICR0cmFjay5lcShpbmRleCArIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKSArIDEgKSApLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgIGNoZWNrV2lubmVyKCk7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgIGlmKGluZGV4IDwgMjEpe1xuICAgICAgICBhaU1vdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBUaGlzIGZ1bmN0aW9uIGZpcmVzIG9mZiBpZiB0aGUgYm9vc3QgYnV0dG9uIGlzIGNsaWNrZWQgb24sIHRoZSBjbGljayBldmVudCB1cGRhdGVzIHRoZSBib29zdCBjb3VudCBhbmQgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiB0aGUgbG9jYXRlR2FyeSBpcyBydW5uaW5nLiBJdCBndWFyZW50ZWVzIHRoZSB1c2VyIGEgbW92ZSBvZiA1IHNwYWNlcyB0aGVuIHJ1bnMgdGhlIGNoZWNrIHdpbm5lciBmdW5jdGlvbiB0byBzZWUgaWYgYSB3aW4gY29uZGl0aW9uIGhhcyBiZWVuIG1ldC4gdGhpcyBpZiBmb3IgdGhlIDIgcGxheWVyIHZlcnNpb24uXG4gIGZ1bmN0aW9uIGJvb3N0R2FyeSgpIHtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgICAkdHJhY2suZXEoaW5kZXggKyA1KS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICBjaGVja1dpbm5lcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkYm9vc3RTb3VuZC5wbGF5KCk7XG4gICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICR0cmFjay5lcShpbmRleCArIDUpLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgIGNoZWNrV2lubmVyKCk7XG4gICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgIGlmKGluZGV4IDwgMjEpe1xuICAgICAgICBhaU1vdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuXG4gIC8vIHRoZSBzYWx0R2FyeSBmdW5jdGlvbi4gZm9yIHRoZSAyIHBsYXllciB2ZXJzaW9uLlxuICBmdW5jdGlvbiBzYWx0R2FyeSgpIHtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuXG4gICAgICBpZihQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAwKXtcbiAgICAgICAgUGxheWVyT25lU2FsdFJlbWFpbmluZyA9IDI7XG4gICAgICAgIHBsYXllck9uZVR1cm4gPSB0cnVlO1xuICAgICAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAyIGhhcyBiZWVuIHNhbHRlZCEgUGxheWVyIDEgbW92ZXMgYWdhaW4hJyk7XG4gICAgICAgIG1vdmVHYXJ5KCk7XG4gICAgICB9IGVsc2UgaWYoUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMCl7XG4gICAgICAgIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPSAyO1xuICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDEgaGFzIGJlZW4gc2FsdGVkISAgIFBsYXllciAyIG1vdmVzIGFnYWluIScpO1xuICAgICAgICBpbmRleCA9ICQoJy50cmFjazIucGxheWVyJykuaW5kZXgoKTtcbiAgICAgICAgbW92ZUdhcnkoKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYoaXNPbmVQbGF5ZXIpe1xuICAgICAgaWYoUGxheWVyT25lU2FsdFJlbWFpbmluZyA9PT0gMCl7XG4gICAgICAgIHBsYXllck9uZVR1cm4gPSB0cnVlO1xuICAgICAgICAkdHJhY2sgPSAkKCcudHJhY2sxJyk7XG4gICAgICAgIGluZGV4ID0gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgICAkdHVyblRleHQudGV4dCgnTWVjaGEgR2FyeSBoYXMgYmVlbiBzYWx0ZWQhICAgUGxheWVyIDEgbW92ZXMgYWdhaW4hJyk7XG4gICAgICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgICAkdHJhY2suZXEoaW5kZXggKyAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMykgKyAxICkgKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICAgIFBsYXllck9uZVNhbHRSZW1haW5pbmcgPSAyO1xuICAgICAgICBjaGVja1dpbm5lcigpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyBmdW5jdGlvbiBiZWxvdyBpcyBmb3IgdGhlIG9uZSBwbGF5ZXIgbW9kZSwgaXQgdHJhY2tzIHBsYXllciAxcyBwb3N0aW9uIHZpYSB0aGUgaW5kZXggYW5kIHNhdmVzIGl0IGluIHBsYXllciAxIHRyYWNrZXIsIHRoZW4gbWFrZXMgYSBkZXNpY2lvbiBiYXNlZCBvbiB0aGF0IHBvc3Rpb24sIHRoZSBiaWdnZXIgdGhlIG51bWJlciBpbiBwbGF5ZXIgdHJhY2tlciB0aGUgbW9yZSBsaWtlbGluZXNzIG9mIGl0IHVzaW5nIG9uZSBvZiB0aGUgYWJpbGl0eSBtb3Zlcy4gVGhlIGZpcnN0IHRocmVlIGZ1bmN0aW9ucyBkZWZpbmUgdGhlIGFjdHVhbCBtb3ZlIHRvIG1ha2UgaXQgbW9yZSByZWFkYWJsZSBpbiB0aGUgYWN0dWFsIGFpIGRlc2ljaW9uIGZ1bmN0aW9uLiBlYWNoIG1vdmUgY2hhbmdlcyB0byBwbGF5ZXIgMSB0dXJuIGZhbHNlIGJlZm9yZSBjYWxsaW5nIGNoZWNrV2lubmVyIHNvIGNhbiB1c2UgdGhlIHNhbWUgZnVuY3Rpb24gaW4gYm90aCAxIHAgYW5kIDIgcCB2ZXJzaW9uLlxuICBmdW5jdGlvbiBhaVNhbHQoKXtcbiAgICAkdHVyblRleHQudGV4dCgnTWVjaGEgR2FyeSBoYXMgc2FsdGVkIHlvdSwgaGUgbW92ZXMgYWdhaW4hJyk7XG4gICAgJHNhbHRTb3VuZC5wbGF5KCk7XG4gICAgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9IDI7XG4gICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgJHRyYWNrLmVxKGluZGV4ICsgKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMSApICkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIGFpUmVnKCk7XG4gICAgfSwgMTAwMCk7XG4gICAgcGxheWVyT25lVHVybiA9IGZhbHNlO1xuICAgIGNoZWNrV2lubmVyKCk7XG4gICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gIH1cblxuICBmdW5jdGlvbiBhaUJvb3N0KCl7XG4gICAgJGJvb3N0U291bmQucGxheSgpO1xuICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICR0cmFjay5lcShpbmRleCArIDUpLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAkdHVyblRleHQudGV4dCgnTWVjaGEgR2FyeSBoYXMgYm9vc3RlZCEgICBQbGF5ZXIgMVxcJ3MgdHVybiAnKTtcbiAgICBwbGF5ZXJPbmVUdXJuID0gZmFsc2U7XG4gICAgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPSAyO1xuICAgIGNoZWNrV2lubmVyKCk7XG4gICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gIH1cblxuICBmdW5jdGlvbiBhaVJlZygpe1xuICAgICRtb3ZlU291bmRUd28ucGxheSgpO1xuICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICR0cmFjay5lcShpbmRleCArIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKSArIDEgKSApLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAkdHVyblRleHQudGV4dCgnTWVjaGEgR2FyeSBoYXMgbWFkZSBoaXMgbW92ZSEgICBQbGF5ZXIgMVxcJ3MgdHVybicpO1xuICAgIHBsYXllck9uZVR1cm4gPSBmYWxzZTtcbiAgICBjaGVja1dpbm5lcigpO1xuICAgIHBsYXllck9uZVR1cm4gPSB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyT25lVHJhY2soKXtcbiAgICBpbmRleCA9ICQoJy50cmFjazEucGxheWVyJykuaW5kZXgoKTtcbiAgICBwbGF5ZXJPbmVUcmFja2VyID0gaW5kZXg7XG4gIH1cblxuICBmdW5jdGlvbiBhaU1vdmUoKXtcbiAgICBwbGF5ZXJPbmVUcmFjaygpO1xuICAgICR0cmFjayA9ICQoJy50cmFjazInKTtcbiAgICBpbmRleCA9ICQoJy50cmFjazIucGxheWVyJykuaW5kZXgoKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICBpZihwbGF5ZXJPbmVUcmFja2VyIDw9IDQpe1xuICAgICAgICBhaVJlZygpO1xuICAgICAgfWVsc2UgaWYocGxheWVyT25lVHJhY2tlciA+IDQgJiYgcGxheWVyT25lVHJhY2tlciA8IDE1KXtcbiAgICAgICAgYWlNb3ZlRGVjaWRlciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDUpICsgMTtcbiAgICAgICAgaWYoYWlNb3ZlRGVjaWRlciA8PSAyKXtcbiAgICAgICAgICBhaVJlZygpO1xuICAgICAgICB9ZWxzZSBpZihhaU1vdmVEZWNpZGVyID4gMiAmJiBhaU1vdmVEZWNpZGVyIDw9NCAmJiBQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgYWlCb29zdCgpO1xuICAgICAgICB9IGVsc2UgaWYoYWlNb3ZlRGVjaWRlciA+IDIgJiYgYWlNb3ZlRGVjaWRlciA8PTQgJiYgUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgIGFpUmVnKCk7XG4gICAgICAgIH0gZWxzZSBpZihhaU1vdmVEZWNpZGVyID09PSA1ICYmIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgIGFpU2FsdCgpO1xuICAgICAgICB9IGVsc2UgaWYoYWlNb3ZlRGVjaWRlciA9PT0gNSAmJiBQbGF5ZXJUd29TYWx0UmVtYWluaW5nID09PSAyKXtcbiAgICAgICAgICBhaVJlZygpO1xuICAgICAgICB9XG4gICAgICB9ZWxzZSBpZihwbGF5ZXJPbmVUcmFja2VyID49IDE1KXtcbiAgICAgICAgYWlNb3ZlRGVjaWRlciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDUpICsgMTtcbiAgICAgICAgaWYoYWlNb3ZlRGVjaWRlciA8PTMgJiYgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgIGFpQm9vc3QoKTtcbiAgICAgICAgfSBlbHNlIGlmKGFpTW92ZURlY2lkZXIgPD0zICYmIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAyICYmIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgIGFpU2FsdCgpO1xuICAgICAgICB9IGVsc2UgaWYoYWlNb3ZlRGVjaWRlciA8PTMgJiYgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPT09IDIgJiYgUGxheWVyT25lU2FsdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICAgYWlSZWcoKTtcbiAgICAgICAgfSBlbHNlIGlmKGFpTW92ZURlY2lkZXIgPiAzICYmIFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgIGFpU2FsdCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFpUmVnKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCAxMDAwKTtcbiAgfVxuICAvLyB2YXJpb3VzIGV2ZW50IGxpc3RlbmVycyBiZWxvdy5cblxuICAvLyBUaGlzIGlzIHRoZSBjbGljayBldmVudCBmb3IgdGhlIG1vdmUgYnV0dG9uLCB3aGVuIGNsaWNrZWQgaXQgZmlyZXMgb2ZmIHRoZSBkZXRlcm1pbmVUdXJuIGZ1bmN0aW9uIHdoaWNoIHNldHMgaW4gbW90aW9uIHRoZSBsb2NhdGVHYXJ5IGFuZCBtb3ZlR2FyeSBmdW5jdGlvbnMuIE5vdyBoYXMgYSBzZXBlcmF0ZSBwYXJ0IGZvciB0aGUgMSB2ZXJzaW9uIHdoaWNoIHNraXBzIHRoZSB0dXJuIGNoZWNrZXIuXG4gIGZ1bmN0aW9uIG1vdmVFdmVudCgpe1xuICAgIGlmKCFpc09uZVBsYXllcil7XG4gICAgICBkZXRlcm1pbmVUdXJuKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICR0cmFjayA9ICQoJy50cmFjazEnKTtcbiAgICAgIGluZGV4ID0gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgbW92ZUdhcnkoKTtcbiAgICB9XG4gIH1cbiAgJG1vdmUub24oJ2NsaWNrJywgbW92ZUV2ZW50KTtcblxuICAvLyB0aGlzIGlzIHRoZSBjbGljayBldmVudCBmb3IgdGhlIGJvb3N0IGJ1dHRvbiwgd2hlbiBjbGlja2VkIGl0IGNoZWNrcyBmaXJzdCB0byBzZWUgaWYgdGhlIHBsYXllciBoYXMgYWxyZWFkeSB1c2VkIHRoZWlyIGJvb3N0LCBpZiBub3QgaXQgdXBkYXRlcyB0aGF0IGluZm9ybWF0aW9uIGFuZCBydW5zIHRoZSBkZXRlcm1pbmVUdXJuIGZ1bmN0aW9uIGxpa2UgYSBub3JtYWwgbW92ZSwgd2hlbiB0aGlzIHJlYWNoZXMgdGhlIGxvY2F0ZUdhcnkgZnVuY3Rpb24sIGl0IHRha2VzIG5vdGUgdGhhdCB0aGUgYm9vc3QgaGFzIGJlZW4gdXNlZCB0byBmaXJlIG9mZiB0aGUgYm9vc3RHYXJ5IGZ1bmN0aW9uIGluc3RlYWQgb2YgdGhlIG1vdmVHYXJ5IGZ1bmN0aW9uLiBJdCB0aGVuIHVwZGF0ZXMgdGhlIGJvb3N0IHJlbWFpbmluZyBhZ2Fpbiwgc28gdGhhdCBpZiBhbm90aGVyIGJvb3N0IGlzIGF0dGVtcHRlZCwgaXQgaW5mb3JtcyB0aGUgdXNlciB0aGF0IHRoZWlyIGJvb3N0IGhhcyBhbHJlYWR5IGJlZW4gdXNlZC5cbiAgZnVuY3Rpb24gYm9vc3RFdmVudCgpe1xuICAgIGlmKCFpc09uZVBsYXllcil7XG5cbiAgICAgIGlmKHBsYXllck9uZVR1cm4pe1xuICAgICAgICBpZihQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgJGJvb3N0U291bmQucGxheSgpO1xuICAgICAgICAgIFBsYXllck9uZUJvb3N0UmVtYWluaW5nID0gMDtcbiAgICAgICAgICBkZXRlcm1pbmVUdXJuKCk7XG4gICAgICAgIH0gZWxzZSBpZihQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICAgJGVycm9yU291bmQucGxheSgpO1xuICAgICAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMSBib29zdCBhbHJlYWR5IHVzZWQhJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmKFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICAkYm9vc3RTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPSAwO1xuICAgICAgICAgIGRldGVybWluZVR1cm4oKTtcbiAgICAgICAgfSBlbHNlIGlmKFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAyKXtcbiAgICAgICAgICAkZXJyb3JTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAyIGJvb3N0IGFscmVhZHkgdXNlZCEnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZihQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICR0cmFjayA9ICQoJy50cmFjazEnKTtcbiAgICAgICAgaW5kZXggPSAkKCcudHJhY2sxLnBsYXllcicpLmluZGV4KCk7XG4gICAgICAgIFBsYXllck9uZUJvb3N0UmVtYWluaW5nID0gMjtcbiAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIHVzZXMgYm9vc3QhJyk7XG4gICAgICAgIGJvb3N0R2FyeSgpO1xuICAgICAgfSBlbHNlIGlmIChQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICRlcnJvclNvdW5kLnBsYXkoKTtcbiAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIGhhcyBhbHJlYWR5IHVzZWQgYm9vc3QhJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gICRib29zdC5vbignY2xpY2snLCBib29zdEV2ZW50KTtcbiAgLy8gYmVsb3cgaXMgdGhlIGV2ZW50IGxpc3RlbmVyIGZvciB0aGUgc2FsdCBhYmlsaXR5LiBVc2luZyB0aGlzIHdpbGwgc3RvcCB5b3VyIG9wcG9uZW50cyBuZXh0IHR1cm4gYW5kIGdpdmUgZ2FyeSBhIG5vcm1hbCBnYXJ5TW92ZSB3aGlsZSB1c2luZyBpdC4gSWYgYSBwbGF5ZXIgaGFzIGFscmVhZHkgdXNlZCB0aGVpciBzYWx0IGl0IGluZm9ybXMgdGhlbSBvbiB0aGUgJHR1cm5UZXh0IGZlZWRiYWNrLlxuICBmdW5jdGlvbiBzYWx0RXZlbnQoKXtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgaWYocGxheWVyT25lVHVybil7XG4gICAgICAgIGlmKFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgICRzYWx0U291bmQucGxheSgpO1xuICAgICAgICAgIFBsYXllck9uZVNhbHRSZW1haW5pbmcgPSAwO1xuICAgICAgICAgIHNhbHRHYXJ5KCk7XG4gICAgICAgIH0gZWxzZSBpZihQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAyKXtcbiAgICAgICAgICAkZXJyb3JTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIGhhcyBhbHJlYWR5IHVzZWQgU2FsdCEnKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYoUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgJHNhbHRTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9IDA7XG4gICAgICAgICAgc2FsdEdhcnkoKTtcbiAgICAgICAgfSBlbHNlIGlmKFBsYXllclR3b1NhbHRSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgICRlcnJvclNvdW5kLnBsYXkoKTtcbiAgICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDIgaGFzIGFscmVhZHkgdXNlZCBTYWx0IScpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmKFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0gMDtcbiAgICAgICAgJHNhbHRTb3VuZC5wbGF5KCk7XG4gICAgICAgIHNhbHRHYXJ5KCk7XG4gICAgICB9IGVsc2UgaWYoUGxheWVyT25lU2FsdFJlbWFpbmluZyA9PT0yKXtcbiAgICAgICAgJGVycm9yU291bmQucGxheSgpO1xuICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDEgaGFzIGFscmVhZHkgdXNlZCBTYWx0IScpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAkc2FsdC5vbignY2xpY2snLCBzYWx0RXZlbnQpO1xuICAvLyBDbGljayBldmVudCB0byBzdGFydCB0aGUgZ2FtZSwgcmVtb3ZlcyB0aGUgaW5zdHJ1Y3Rpb24gcGFnZSBhbmQgdGhlbiBzaG93cyB0aGUgcmFjZXRyYWNrLCBmZWVkYmFjayBib3ggYW5kIGNvbnRyb2xsZXIuIEhhdmUgbW92ZWQgZXZlbnRzIHRoYXQgaGFwcGVuIGluIGJvdGggdG8gdGhlIGFsd2FzeSBvbiBzdGFydCBmdW5jdGlvbi5cbiAgJHN0YXJ0Lm9uKCdjbGljaycsICgpID0+IHtcbiAgICBhbHdheXNPblN0YXJ0KCk7XG4gIH0pO1xuXG4gIC8vIGNsaWNrIGV2ZW50IHRvIHN0YXJ0IHRoZSAxcCBvcHRpb24uXG4gICRzdGFydDFQbGF5ZXIub24oJ2NsaWNrJywoKSA9PiB7XG4gICAgaXNPbmVQbGF5ZXIgPSB0cnVlO1xuICAgIGFsd2F5c09uU3RhcnQoKTtcbiAgICAkdHVyblRleHQudGV4dCgnTWFrZSB5b3VyIGZpcnN0IG1vdmUhJyk7XG5cbiAgfSk7XG5cbiAgZnVuY3Rpb24gYWx3YXlzT25TdGFydCgpe1xuICAgICRpbnN0cnVjdGlvbnMuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkYm9hcmQucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkY29udHJvbGxlci5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICRhdWRpb1RoZW1lLnBsYXkoKTtcbiAgfVxuXG4gIC8vIEV2ZW50IGxpc3RlbmVyIGZvciB0aGUgcmVzZXQgYnV0dG9uLCBpdCBiYXNpY2FsbHkgaGlkZXMgYWxsIG9mIHRoZSBmZWVkYmFjayBmcm9tIHRoZSByZW1haW5pbmcgZ2FtZSBhbmQgbW92ZXMgYm90aCBwbGF5ZXIgaWNvbnMgYmFjayB0byB0aGUgc3RhcnQgbGluZSwgaXQgYWxzbyByZXNldHMgdGhlIHNhbHQgYW5kIGJvb3N0IGNvdW50ZXJzIHRvIDEgc28gdGhhdCB0aGV5IGNhbiBub3cgYmUgdXNlZCBhZ2Fpbi4gZnVubmN0aW9uIGJlbG93IHRoYXQgaXMgc29tZSByZWZhY3RvcmluZyBmb3IgY29tbWFuZHMgdGhhdCBoYXBwZW4gcmVnYXJkbGVzcyBvZiAxcCBvciAycCBtb2RlLlxuICBmdW5jdGlvbiByZXNldCgpe1xuICAgIGFsd2F5c09uUmVzZXQoKTtcbiAgICAhaXNPbmVQbGF5ZXIgPyAkKCcucGxheWVyVHdvV2luJykuYWRkQ2xhc3MoJ2hpZGUnKSA6ICQoJy5haVdpbicpLmFkZENsYXNzKCdoaWRlJyk7XG4gIH1cbiAgJHJlc2V0Lm9uKCdjbGljaycsIHJlc2V0KTtcblxuICBmdW5jdGlvbiBhbHdheXNPblJlc2V0KCl7XG4gICAgJCgnLnRyYWNrMScpLnJlbW92ZUNsYXNzKCdwbGF5ZXIgd2lubmVyJyk7XG4gICAgJCgnLnN0YXJ0MScpLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9IDE7XG4gICAgUGxheWVyT25lU2FsdFJlbWFpbmluZyA9MTtcbiAgICAkKCcudHJhY2syJykucmVtb3ZlQ2xhc3MoJ3BsYXllciB3aW5uZXInKTtcbiAgICAkKCcuc3RhcnQyJykuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID0gMTtcbiAgICBQbGF5ZXJUd29TYWx0UmVtYWluaW5nID0gMTtcbiAgICBwbGF5ZXJPbmVUcmFja2VyID0gbnVsbDtcbiAgICAkKCcuY29udHJvbGxlcicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgJCgnLmZlZWRiYWNrJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcucmVzdWx0Qm94JykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcucGxheWVyT25lV2luJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkYXVkaW9UaGVtZS5zcmMgPSAnJztcbiAgICAkYXVkaW9UaGVtZS5zcmMgPSAnc291bmRzL2Nsb3NpbmdfdGhlbWUubXAzJztcbiAgICAkYXVkaW9UaGVtZS5wbGF5KCk7XG4gIH1cbn0pO1xuIl19
