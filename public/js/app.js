"use strict";$(function(){function a(){(N=H?$(".track1.player").index():$(".track2.player").index())>=21&&(e(),(H?b:S).addClass("player winner"),H?($(".playerOneWin").removeClass("hide"),$(".aiWin").addClass("hide")):R?$(".aiWin").removeClass("hide"):$(".playerTwoWin").removeClass("hide"))}function e(){E.play(),g.addClass("hide"),W.addClass("hide"),w.removeClass("hide"),T.removeClass("hide")}function l(){r(),F=H?$(".track2"):$(".track1"),q.text(H?"Player 2's Turn":"Player 1's Turn"),H=!H}function r(){N=H?$(".track1.player").index():$(".track2.player").index(),H?I>0?(z.play(),s()):0===I&&(t(),I=2):J>0?(A.play(),s()):0===J&&(t(),J=2)}function s(){R?R&&(z.play(),q.text("Player 1 get's moving!"),F.eq(N).removeClass("player"),F.eq(N+(Math.floor(3*Math.random())+1)).addClass("player"),a(),(N=$(".track1.player").index())<21&&c()):(F.eq(N).removeClass("player"),F.eq(N+(Math.floor(3*Math.random())+1)).addClass("player"),a())}function t(){R?(_.play(),F.eq(N).removeClass("player"),F.eq(N+5).addClass("player"),a(),(N=$(".track1.player").index())<21&&c()):(F.eq(N).removeClass("player"),F.eq(N+5).addClass("player"),a())}function n(){R?R&&0===K&&(H=!0,F=$(".track1"),N=$(".track1.player").index(),q.text("Mecha Gary has been salted!   Player 1 moves again!"),F.eq(N).removeClass("player"),F.eq(N+(Math.floor(3*Math.random())+1)).addClass("player"),K=2,a()):0===K?(K=2,H=!0,N=$(".track1.player").index(),q.text("Player 2 has been salted! Player 1 moves again!"),s()):0===L&&(L=2,q.text("Player 1 has been salted!   Player 2 moves again!"),N=$(".track2.player").index(),s())}function o(){q.text("Mecha Gary has salted you, he moves again!"),j.play(),L=2,F.eq(N).removeClass("player"),F.eq(N+(Math.floor(3*Math.random())+1)).addClass("player"),setTimeout(function(){i()},1e3),H=!1,a(),H=!0}function d(){_.play(),F.eq(N).removeClass("player"),F.eq(N+5).addClass("player"),q.text("Mecha Gary has boosted!   Player 1's turn "),H=!1,J=2,a(),H=!0}function i(){A.play(),F.eq(N).removeClass("player"),F.eq(N+(Math.floor(3*Math.random())+1)).addClass("player"),q.text("Mecha Gary has made his move!   Player 1's turn"),H=!1,a(),H=!0}function y(){N=$(".track1.player").index(),Q=N}function c(){y(),F=$(".track2"),N=$(".track2.player").index(),setTimeout(function(){Q<=4?i():Q>4&&Q<15?(U=Math.floor(5*Math.random())+1,U<=2?i():U>2&&U<=4&&1===J?d():U>2&&U<=4&&2===I?i():5===U&&1===L?o():5===U&&2===L&&i()):Q>=15&&(U=Math.floor(5*Math.random())+1,U<=3&&1===J?d():U<=3&&2===J&&1===L?o():U<=3&&2===J&&2===K?i():U>3&&1===K?o():i())},1e3)}function p(){R?(F=$(".track1"),N=$(".track1.player").index(),s()):l()}function u(){R?1===I?(F=$(".track1"),N=$(".track1.player").index(),I=2,q.text("Player 1 uses boost!"),t()):2===I&&(D.play(),q.text("Player 1 has already used boost!")):H?1===I?(_.play(),I=0,l()):2===I&&(D.play(),q.text("Player 1 boost already used!")):1===J?(_.play(),J=0,l()):2===J&&(D.play(),q.text("Player 2 boost already used!"))}function h(){R?1===K?(K=0,j.play(),n()):2===K&&(D.play(),q.text("Player 1 has already used Salt!")):H?1===K?(j.play(),K=0,n()):2===K&&(D.play(),q.text("Player 1 has already used Salt!")):1===L?(j.play(),L=0,n()):2===L&&(D.play(),q.text("Player 2 has already used Salt!"))}function m(){G.addClass("hide"),B.removeClass("hide"),W.removeClass("hide"),g.removeClass("hide"),O.play()}function C(){f(),R?$(".aiWin").addClass("hide"):$(".playerTwoWin").addClass("hide")}function f(){$(".track1").removeClass("player winner"),$(".start1").addClass("player"),I=1,K=1,$(".track2").removeClass("player winner"),$(".start2").addClass("player"),J=1,L=1,Q=null,$(".controller").removeClass("hide"),$(".feedback").removeClass("hide"),$(".resultBox").addClass("hide"),$(".playerOneWin").addClass("hide"),O.src="",O.src="sounds/closing_theme.mp3",O.play()}var v=$(".startbtn2"),k=$(".startbtn1"),x=$(".move"),M=$(".boost"),P=$(".salt"),q=$(".turn"),b=$(".finish1"),S=$(".finish2"),g=$(".feedback"),W=$(".controller"),w=$(".reset"),T=$(".resultBox"),G=$(".instructions"),B=$(".board"),O=$(".theme")[0];O.src="sounds/closing_theme.mp3";var _=$(".boostSound")[0],j=$(".saltSound")[0],z=$(".moveSound")[0],A=$(".moveSound2")[0],D=$(".errorSound")[0],E=$(".winSound")[0],F=$(".track1"),H=!0,I=1,J=1,K=1,L=1,N=null,Q=null,R=!1,U=null;x.on("click",p),M.on("click",u),P.on("click",h),v.on("click",function(){m()}),k.on("click",function(){R=!0,m(),q.text("Make your first move!")}),w.on("click",C)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiY2hlY2tXaW5uZXIiLCJpbmRleCIsInBsYXllck9uZVR1cm4iLCIkZmluaXNoMSIsIiRmaW5pc2gyIiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsImlzT25lUGxheWVyIiwiYWx3YXlzT25XaW4iLCIkd2luU291bmQiLCJwbGF5IiwiJGZlZWRiYWNrIiwiJGNvbnRyb2xsZXIiLCJkZXRlcm1pbmVUdXJuIiwibG9jYXRlR2FyeSIsIiR0cmFjayIsIm1vdmVHYXJ5IiwiJG1vdmVTb3VuZCIsIlBsYXllck9uZUJvb3N0UmVtYWluaW5nIiwiUGxheWVyVHdvQm9vc3RSZW1haW5pbmciLCIkbW92ZVNvdW5kVHdvIiwiZXEiLCIkdHVyblRleHQiLCJ0ZXh0IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiYm9vc3RHYXJ5IiwiJGJvb3N0U291bmQiLCJzYWx0R2FyeSIsIlBsYXllck9uZVNhbHRSZW1haW5pbmciLCJQbGF5ZXJUd29TYWx0UmVtYWluaW5nIiwiYWlTYWx0IiwiJHNhbHRTb3VuZCIsInNldFRpbWVvdXQiLCJhaVJlZyIsImFpQm9vc3QiLCJwbGF5ZXJPbmVUcmFjayIsImFpTW92ZSIsImFpTW92ZURlY2lkZXIiLCJwbGF5ZXJPbmVUcmFja2VyIiwibW92ZUV2ZW50IiwiYm9vc3RFdmVudCIsIiRlcnJvclNvdW5kIiwic2FsdEV2ZW50IiwiYWx3YXlzT25TdGFydCIsIiRpbnN0cnVjdGlvbnMiLCIkYm9hcmQiLCIkYXVkaW9UaGVtZSIsInJlc2V0IiwiYWx3YXlzT25SZXNldCIsInNyYyIsIiRzdGFydCIsIiRzdGFydDFQbGF5ZXIiLCIkbW92ZSIsIiRib29zdCIsIiRzYWx0IiwiJHJlc2V0IiwiJHJlc3VsdEJveCIsIm9uIl0sIm1hcHBpbmdzIjoiWUFBQUEsR0FBRSxXQXNDQSxRQUFTQyxNQURUQyxFQUFBQyxFQUFBSCxFQUFBLGtCQUFBRSxRQUFBRixFQUFBLGtCQUFBRSxVQUNTRCxLQUNQQyxLQUNBQyxF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QSwyQkFrQkZZLEVBQU9FLEdBQUcsUUFBU1YiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJCgoKSA9PiB7XG4gIC8vIExpc3Qgb2YgdmFyaWFibGVzIG5lZWRlZCBmb3IgdGhlIGdhbWVcbiAgY29uc3QgJHN0YXJ0ID0gJCgnLnN0YXJ0YnRuMicpO1xuICBjb25zdCAkc3RhcnQxUGxheWVyID0gJCgnLnN0YXJ0YnRuMScpO1xuICBjb25zdCAkbW92ZSA9ICQoJy5tb3ZlJyk7XG4gIGNvbnN0ICRib29zdCA9ICQoJy5ib29zdCcpO1xuICBjb25zdCAkc2FsdCA9ICQoJy5zYWx0Jyk7XG4gIGNvbnN0ICR0dXJuVGV4dCA9ICQoJy50dXJuJyk7XG4gIGNvbnN0ICRmaW5pc2gxID0gJCgnLmZpbmlzaDEnKTtcbiAgY29uc3QgJGZpbmlzaDIgPSAkKCcuZmluaXNoMicpO1xuICBjb25zdCAkZmVlZGJhY2sgPSAkKCcuZmVlZGJhY2snKTtcbiAgY29uc3QgJGNvbnRyb2xsZXIgPSAkKCcuY29udHJvbGxlcicpO1xuICBjb25zdCAkcmVzZXQgPSAkKCcucmVzZXQnKTtcbiAgY29uc3QgJHJlc3VsdEJveCA9ICQoJy5yZXN1bHRCb3gnKTtcbiAgY29uc3QgJGluc3RydWN0aW9ucyA9ICQoJy5pbnN0cnVjdGlvbnMnKTtcbiAgY29uc3QgJGJvYXJkID0gJCgnLmJvYXJkJyk7XG4gIC8vIEF1ZGlvIHZhcmlhYmxlcy5cbiAgY29uc3QgJGF1ZGlvVGhlbWUgPSAkKCcudGhlbWUnKVswXTtcbiAgJGF1ZGlvVGhlbWUuc3JjID0gJ3NvdW5kcy9jbG9zaW5nX3RoZW1lLm1wMyc7XG4gIGNvbnN0ICRib29zdFNvdW5kID0gJCgnLmJvb3N0U291bmQnKVswXTtcbiAgY29uc3QgJHNhbHRTb3VuZCA9ICQoJy5zYWx0U291bmQnKVswXTtcbiAgY29uc3QgJG1vdmVTb3VuZCA9ICQoJy5tb3ZlU291bmQnKVswXTtcbiAgY29uc3QgJG1vdmVTb3VuZFR3byA9ICQoJy5tb3ZlU291bmQyJylbMF07XG4gIGNvbnN0ICRlcnJvclNvdW5kID0gJCgnLmVycm9yU291bmQnKVswXTtcbiAgY29uc3QgJHdpblNvdW5kID0gJCgnLndpblNvdW5kJylbMF07XG4gIC8vIFZhcmlhYmxlcyB0aGF0IHVwZGF0ZSBkdXJpbmcgdGhlIGdhbWUsIGJhc2VkIG9uIHR1cm4vYWJpbHRpZXMgdXNlZC5cbiAgbGV0ICR0cmFjayA9ICQoJy50cmFjazEnKTtcbiAgbGV0IHBsYXllck9uZVR1cm4gPSB0cnVlO1xuICBsZXQgUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPSAxO1xuICBsZXQgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPSAxO1xuICBsZXQgUGxheWVyT25lU2FsdFJlbWFpbmluZyA9IDE7XG4gIGxldCBQbGF5ZXJUd29TYWx0UmVtYWluaW5nID0gMTtcbiAgbGV0IGluZGV4ID0gbnVsbDtcbiAgbGV0IHBsYXllck9uZVRyYWNrZXIgPSBudWxsO1xuICBsZXQgaXNPbmVQbGF5ZXIgPSBmYWxzZTtcbiAgbGV0IGFpTW92ZURlY2lkZXIgPSBudWxsO1xuXG4gIC8vIGZ1bmN0aW9uIHRoYXQgY2hlY2tzIHRvIHNlZSBpZiBlaXRoZXIgcGxheWVyIGlzIGluIGEgd2lubmluZyBwb3NpdGlvbiwgcG9zdGlvbiBpcyBkZXRlcm1pbmVzIGlmIHRoZSBpbmRleCBvZiB0aGUgb2NjdXBpZWQgc3BhY2UgaXMgZXF1YWwgdG8gb3IgZ3JlYXRlciB0aGFuIDIxKHRoZSBmaW5pc2ggbGluZSksIHRoZXJlIGFyZSBoaWRkZW4gcnVuIG9mZiBib3hlcyB0aGF0IGFsc28gZXZhdWxhdGUgdGhlIHdpbm5lciBpZiB0aGUgZmluYWwgbW92ZSB3b3VsZCBvZiB0YWtlIHRoZW4gcGxheWVyIHBhc3NlZCBpbmRleCAyMS5cbiAgZnVuY3Rpb24gY2hlY2tXaW5uZXIoKXtcbiAgICBpbmRleCA9IHBsYXllck9uZVR1cm4gPyAkKCcudHJhY2sxLnBsYXllcicpLmluZGV4KCkgOiAkKCcudHJhY2syLnBsYXllcicpLmluZGV4KCk7XG4gICAgaWYoaW5kZXggPj0gMjEpIHtcbiAgICAgIGFsd2F5c09uV2luKCk7XG4gICAgICAocGxheWVyT25lVHVybiA/ICRmaW5pc2gxIDogJGZpbmlzaDIpLmFkZENsYXNzKCdwbGF5ZXIgd2lubmVyJyk7XG5cbiAgICAgIGlmKHBsYXllck9uZVR1cm4pIHtcbiAgICAgICAgJCgnLnBsYXllck9uZVdpbicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgICQoJy5haVdpbicpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgICAgICQoJy5wbGF5ZXJUd29XaW4nKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICQoJy5haVdpbicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy8gcmVmYWN0b3JlZCBhcyB0aGVzZSBldmVudHMgYWx3YXlzIGhhcHBlbiByZWdhcmRsZXNzIG9mIHdobyB3aW5zLlxuICBmdW5jdGlvbiBhbHdheXNPbldpbigpe1xuICAgICR3aW5Tb3VuZC5wbGF5KCk7XG4gICAgJGZlZWRiYWNrLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJGNvbnRyb2xsZXIuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkcmVzZXQucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkcmVzdWx0Qm94LnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gIH1cblxuICAvLyB0aGlzIGZ1bmN0aW9uIGRldGVybWluZXMgd2hvcyB0dXJuIGl0IGlzIGFuZCB1cGRhdGVzIHRoZSBvbiBzY3JlZW4gcG9ybXB0IGFjY29yZGluZ2x5LCBpdCBpcyBmaXJlZCBkaXJlY3RseSBhZnRlciB0aGUgY2xpY2sgZXZlbnQgb24gbW92ZSwgYW5kIGl0IGZpcmVkIGlmIGEgYm9vc3QgaGFwcGVucyBhZnRlciB1cGRhdGluZyB0aGUgYm9vc3QgYm9vbGVhbiwgaXQgd29ya3Mgb24gdGhlIG9uZSB2YXJpYWJsZSB3aGljaCBnZXRzIHVwZGF0ZWQgb2YgcGxheWVyT25lVHVybiBmcm9tIHRydWUgdG8gZmFsc2UuXG4gIGZ1bmN0aW9uIGRldGVybWluZVR1cm4oKXtcbiAgICBsb2NhdGVHYXJ5KCk7XG4gICAgJHRyYWNrID0gcGxheWVyT25lVHVybiA/ICQoJy50cmFjazInKSA6ICQoJy50cmFjazEnKTtcbiAgICAkdHVyblRleHQudGV4dChwbGF5ZXJPbmVUdXJuID8gJ1BsYXllciAyXFwncyBUdXJuJyA6ICdQbGF5ZXIgMVxcJ3MgVHVybicpO1xuICAgIHBsYXllck9uZVR1cm4gPSAhcGxheWVyT25lVHVybjtcbiAgfVxuXG4gIC8vIFRoaXMgZnVuY3Rpb24gbG9jYXRlcyBnYXJ5IG9uIHRoZSBib2FyZCwgdGhlIHNlcGVyYXRlIHBhcnRzIG9mIHRoZSBpZiBlbHNlIHN0YXRlbWVudCBydW4gYmFzZWQgb24gd2hpY2ggcGxheWVycyB0dXJuIGl0IGlzLCBvbmNlIGRvaW5nIHNvIGl0IGZpcmVzIG9mZiB0aGUgbW92ZUdhcnkgZnVuY3Rpb24uIE9yIGlmIGl0IGRldGVjdHMgdGhlIGJvb3N0IGhhcyBiZWVuIHVzZWQoYnkgaXQgdXBkYXRpbmcgZnJvbSAxIHRvIDAgb24gdGhlIGJvb3N0IGJ1dHRvbiBjbGljaykgaWYgZmlyZXMgb2ZmIHRoZSBib29zdEdhcnkgZnVuY3Rpb24gaW5zdGVhZCwgaXQgdGhlbiB1cGRhdGVzIHRoZSBib29zdCBjb3VudCB0byAyIHdoaWNoIGluZm9ybXMgdGhlIHVzZXIgdGhlIGJvb3N0IGhhcyBiZWVuIHVzZWQgd2hlbiBjbGlja2VkIGFnYWluLlxuICBmdW5jdGlvbiBsb2NhdGVHYXJ5KCl7XG4gICAgaW5kZXggPSBwbGF5ZXJPbmVUdXJuID8gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpIDogJCgnLnRyYWNrMi5wbGF5ZXInKS5pbmRleCgpO1xuICAgIGlmKHBsYXllck9uZVR1cm4pe1xuICAgICAgaWYoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPiAwKXtcbiAgICAgICAgJG1vdmVTb3VuZC5wbGF5KCk7XG4gICAgICAgIG1vdmVHYXJ5KCk7XG4gICAgICB9IGVsc2UgaWYoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDApIHtcbiAgICAgICAgYm9vc3RHYXJ5KCk7XG4gICAgICAgIFBsYXllck9uZUJvb3N0UmVtYWluaW5nID0gMjtcbiAgICAgIH1cbiAgICB9IGVsc2V7XG4gICAgICBpZihQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA+IDApe1xuICAgICAgICAkbW92ZVNvdW5kVHdvLnBsYXkoKTtcbiAgICAgICAgbW92ZUdhcnkoKTtcbiAgICAgIH1lbHNlIGlmKFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgIGJvb3N0R2FyeSgpO1xuICAgICAgICBQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9IDI7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gVGhpcyBmdW5jdGlvbiBtb3ZlcyBnYXJ5LCBpdCBmaXJzdCBkZXRlcm1pbmVzIGlmIGl0IGlzIGEgcmVndWxhciBtb3ZlIG9yIGEgYm9vc3QgbW92ZSwgaWYgaXQgaXMgYSByZWd1bGFyIG1vdmUgaXQgbW92ZXMgdGhlIGN1cnJlbnQgcGxheWVycyBHYXJ5IGJldHdlZW4gMSBhbmQgMyBpbmRleCBzcGFjZXMgYWxvbmcsIGZpbmFsbHksIGl0IHJ1bnMgdGhlIGNoZWNrV2lubmVyIGZ1bmN0aW9uIHRvIHNlZSBpZiBhIHdpbiBjb25kaXRpb24gaGFzIGJlZW4gbWV0LlxuICBmdW5jdGlvbiBtb3ZlR2FyeSgpIHtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuICAgICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgICAkdHJhY2suZXEoaW5kZXggKyAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMykgKyAxICkgKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgICBjaGVja1dpbm5lcigpO1xuICAgIH0gZWxzZSBpZihpc09uZVBsYXllcil7XG4gICAgICAkbW92ZVNvdW5kLnBsYXkoKTtcbiAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMSBnZXRcXCdzIG1vdmluZyEnKTtcbiAgICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgJHRyYWNrLmVxKGluZGV4ICsgKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMSApICkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgY2hlY2tXaW5uZXIoKTtcbiAgICAgIGluZGV4ID0gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgaWYoaW5kZXggPCAyMSl7XG4gICAgICAgIGFpTW92ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIFRoaXMgZnVuY3Rpb24gZmlyZXMgb2ZmIGlmIHRoZSBib29zdCBidXR0b24gaXMgY2xpY2tlZCBvbiwgdGhlIGNsaWNrIGV2ZW50IHVwZGF0ZXMgdGhlIGJvb3N0IGNvdW50IGFuZCB0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuIHRoZSBsb2NhdGVHYXJ5IGlzIHJ1bm5pbmcuIEl0IGd1YXJlbnRlZXMgdGhlIHVzZXIgYSBtb3ZlIG9mIDUgc3BhY2VzIHRoZW4gcnVucyB0aGUgY2hlY2sgd2lubmVyIGZ1bmN0aW9uIHRvIHNlZSBpZiBhIHdpbiBjb25kaXRpb24gaGFzIGJlZW4gbWV0LiB0aGlzIGlmIGZvciB0aGUgMiBwbGF5ZXIgdmVyc2lvbi5cbiAgZnVuY3Rpb24gYm9vc3RHYXJ5KCkge1xuICAgIGlmKCFpc09uZVBsYXllcil7XG4gICAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAgICR0cmFjay5lcShpbmRleCArIDUpLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgIGNoZWNrV2lubmVyKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICRib29zdFNvdW5kLnBsYXkoKTtcbiAgICAgICR0cmFjay5lcShpbmRleCkucmVtb3ZlQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgJHRyYWNrLmVxKGluZGV4ICsgNSkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICAgY2hlY2tXaW5uZXIoKTtcbiAgICAgIGluZGV4ID0gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgaWYoaW5kZXggPCAyMSl7XG4gICAgICAgIGFpTW92ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG5cbiAgLy8gdGhlIHNhbHRHYXJ5IGZ1bmN0aW9uLiBmb3IgdGhlIDIgcGxheWVyIHZlcnNpb24uXG4gIGZ1bmN0aW9uIHNhbHRHYXJ5KCkge1xuICAgIGlmKCFpc09uZVBsYXllcil7XG5cbiAgICAgIGlmKFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09IDApe1xuICAgICAgICBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0gMjtcbiAgICAgICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gICAgICAgIGluZGV4ID0gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDIgaGFzIGJlZW4gc2FsdGVkISBQbGF5ZXIgMSBtb3ZlcyBhZ2FpbiEnKTtcbiAgICAgICAgbW92ZUdhcnkoKTtcbiAgICAgIH0gZWxzZSBpZihQbGF5ZXJUd29TYWx0UmVtYWluaW5nID09PSAwKXtcbiAgICAgICAgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9IDI7XG4gICAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMSBoYXMgYmVlbiBzYWx0ZWQhICAgUGxheWVyIDIgbW92ZXMgYWdhaW4hJyk7XG4gICAgICAgIGluZGV4ID0gJCgnLnRyYWNrMi5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgICBtb3ZlR2FyeSgpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZihpc09uZVBsYXllcil7XG4gICAgICBpZihQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAwKXtcbiAgICAgICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gICAgICAgICR0cmFjayA9ICQoJy50cmFjazEnKTtcbiAgICAgICAgaW5kZXggPSAkKCcudHJhY2sxLnBsYXllcicpLmluZGV4KCk7XG4gICAgICAgICR0dXJuVGV4dC50ZXh0KCdNZWNoYSBHYXJ5IGhhcyBiZWVuIHNhbHRlZCEgICBQbGF5ZXIgMSBtb3ZlcyBhZ2FpbiEnKTtcbiAgICAgICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgICAgICR0cmFjay5lcShpbmRleCArIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKSArIDEgKSApLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICAgICAgUGxheWVyT25lU2FsdFJlbWFpbmluZyA9IDI7XG4gICAgICAgIGNoZWNrV2lubmVyKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIC8vIGZ1bmN0aW9uIGJlbG93IGlzIGZvciB0aGUgb25lIHBsYXllciBtb2RlLCBpdCB0cmFja3MgcGxheWVyIDFzIHBvc3Rpb24gdmlhIHRoZSBpbmRleCBhbmQgc2F2ZXMgaXQgaW4gcGxheWVyIDEgdHJhY2tlciwgdGhlbiBtYWtlcyBhIGRlc2ljaW9uIGJhc2VkIG9uIHRoYXQgcG9zdGlvbiwgdGhlIGJpZ2dlciB0aGUgbnVtYmVyIGluIHBsYXllciB0cmFja2VyIHRoZSBtb3JlIGxpa2VsaW5lc3Mgb2YgaXQgdXNpbmcgb25lIG9mIHRoZSBhYmlsaXR5IG1vdmVzLiBUaGUgZmlyc3QgdGhyZWUgZnVuY3Rpb25zIGRlZmluZSB0aGUgYWN0dWFsIG1vdmUgdG8gbWFrZSBpdCBtb3JlIHJlYWRhYmxlIGluIHRoZSBhY3R1YWwgYWkgZGVzaWNpb24gZnVuY3Rpb24uIGVhY2ggbW92ZSBjaGFuZ2VzIHRvIHBsYXllciAxIHR1cm4gZmFsc2UgYmVmb3JlIGNhbGxpbmcgY2hlY2tXaW5uZXIgc28gY2FuIHVzZSB0aGUgc2FtZSBmdW5jdGlvbiBpbiBib3RoIDEgcCBhbmQgMiBwIHZlcnNpb24uXG4gIGZ1bmN0aW9uIGFpU2FsdCgpe1xuICAgICR0dXJuVGV4dC50ZXh0KCdNZWNoYSBHYXJ5IGhhcyBzYWx0ZWQgeW91LCBoZSBtb3ZlcyBhZ2FpbiEnKTtcbiAgICAkc2FsdFNvdW5kLnBsYXkoKTtcbiAgICBQbGF5ZXJUd29TYWx0UmVtYWluaW5nID0gMjtcbiAgICAkdHJhY2suZXEoaW5kZXgpLnJlbW92ZUNsYXNzKCdwbGF5ZXInKTtcbiAgICAkdHJhY2suZXEoaW5kZXggKyAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMykgKyAxICkgKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgYWlSZWcoKTtcbiAgICB9LCAxMDAwKTtcbiAgICBwbGF5ZXJPbmVUdXJuID0gZmFsc2U7XG4gICAgY2hlY2tXaW5uZXIoKTtcbiAgICBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFpQm9vc3QoKXtcbiAgICAkYm9vc3RTb3VuZC5wbGF5KCk7XG4gICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgJHRyYWNrLmVxKGluZGV4ICsgNSkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICR0dXJuVGV4dC50ZXh0KCdNZWNoYSBHYXJ5IGhhcyBib29zdGVkISAgIFBsYXllciAxXFwncyB0dXJuICcpO1xuICAgIHBsYXllck9uZVR1cm4gPSBmYWxzZTtcbiAgICBQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9IDI7XG4gICAgY2hlY2tXaW5uZXIoKTtcbiAgICBwbGF5ZXJPbmVUdXJuID0gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFpUmVnKCl7XG4gICAgJG1vdmVTb3VuZFR3by5wbGF5KCk7XG4gICAgJHRyYWNrLmVxKGluZGV4KS5yZW1vdmVDbGFzcygncGxheWVyJyk7XG4gICAgJHRyYWNrLmVxKGluZGV4ICsgKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMSApICkuYWRkQ2xhc3MoJ3BsYXllcicpO1xuICAgICR0dXJuVGV4dC50ZXh0KCdNZWNoYSBHYXJ5IGhhcyBtYWRlIGhpcyBtb3ZlISAgIFBsYXllciAxXFwncyB0dXJuJyk7XG4gICAgcGxheWVyT25lVHVybiA9IGZhbHNlO1xuICAgIGNoZWNrV2lubmVyKCk7XG4gICAgcGxheWVyT25lVHVybiA9IHRydWU7XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJPbmVUcmFjaygpe1xuICAgIGluZGV4ID0gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpO1xuICAgIHBsYXllck9uZVRyYWNrZXIgPSBpbmRleDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFpTW92ZSgpe1xuICAgIHBsYXllck9uZVRyYWNrKCk7XG4gICAgJHRyYWNrID0gJCgnLnRyYWNrMicpO1xuICAgIGluZGV4ID0gJCgnLnRyYWNrMi5wbGF5ZXInKS5pbmRleCgpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIGlmKHBsYXllck9uZVRyYWNrZXIgPD0gNCl7XG4gICAgICAgIGFpUmVnKCk7XG4gICAgICB9ZWxzZSBpZihwbGF5ZXJPbmVUcmFja2VyID4gNCAmJiBwbGF5ZXJPbmVUcmFja2VyIDwgMTUpe1xuICAgICAgICBhaU1vdmVEZWNpZGVyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNSkgKyAxO1xuICAgICAgICBpZihhaU1vdmVEZWNpZGVyIDw9IDIpe1xuICAgICAgICAgIGFpUmVnKCk7XG4gICAgICAgIH1lbHNlIGlmKGFpTW92ZURlY2lkZXIgPiAyICYmIGFpTW92ZURlY2lkZXIgPD00ICYmIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICBhaUJvb3N0KCk7XG4gICAgICAgIH0gZWxzZSBpZihhaU1vdmVEZWNpZGVyID4gMiAmJiBhaU1vdmVEZWNpZGVyIDw9NCAmJiBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICAgYWlSZWcoKTtcbiAgICAgICAgfSBlbHNlIGlmKGFpTW92ZURlY2lkZXIgPT09IDUgJiYgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgYWlTYWx0KCk7XG4gICAgICAgIH0gZWxzZSBpZihhaU1vdmVEZWNpZGVyID09PSA1ICYmIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgIGFpUmVnKCk7XG4gICAgICAgIH1cbiAgICAgIH1lbHNlIGlmKHBsYXllck9uZVRyYWNrZXIgPj0gMTUpe1xuICAgICAgICBhaU1vdmVEZWNpZGVyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNSkgKyAxO1xuICAgICAgICBpZihhaU1vdmVEZWNpZGVyIDw9MyAmJiBQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgYWlCb29zdCgpO1xuICAgICAgICB9IGVsc2UgaWYoYWlNb3ZlRGVjaWRlciA8PTMgJiYgUGxheWVyVHdvQm9vc3RSZW1haW5pbmcgPT09IDIgJiYgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgYWlTYWx0KCk7XG4gICAgICAgIH0gZWxzZSBpZihhaU1vdmVEZWNpZGVyIDw9MyAmJiBQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9PT0gMiAmJiBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAyKXtcbiAgICAgICAgICBhaVJlZygpO1xuICAgICAgICB9IGVsc2UgaWYoYWlNb3ZlRGVjaWRlciA+IDMgJiYgUGxheWVyT25lU2FsdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgYWlTYWx0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWlSZWcoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIDEwMDApO1xuICB9XG4gIC8vIHZhcmlvdXMgZXZlbnQgbGlzdGVuZXJzIGJlbG93LlxuXG4gIC8vIFRoaXMgaXMgdGhlIGNsaWNrIGV2ZW50IGZvciB0aGUgbW92ZSBidXR0b24sIHdoZW4gY2xpY2tlZCBpdCBmaXJlcyBvZmYgdGhlIGRldGVybWluZVR1cm4gZnVuY3Rpb24gd2hpY2ggc2V0cyBpbiBtb3Rpb24gdGhlIGxvY2F0ZUdhcnkgYW5kIG1vdmVHYXJ5IGZ1bmN0aW9ucy4gTm93IGhhcyBhIHNlcGVyYXRlIHBhcnQgZm9yIHRoZSAxIHZlcnNpb24gd2hpY2ggc2tpcHMgdGhlIHR1cm4gY2hlY2tlci5cbiAgZnVuY3Rpb24gbW92ZUV2ZW50KCl7XG4gICAgaWYoIWlzT25lUGxheWVyKXtcbiAgICAgIGRldGVybWluZVR1cm4oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJHRyYWNrID0gJCgnLnRyYWNrMScpO1xuICAgICAgaW5kZXggPSAkKCcudHJhY2sxLnBsYXllcicpLmluZGV4KCk7XG4gICAgICBtb3ZlR2FyeSgpO1xuICAgIH1cbiAgfVxuXG4gICRtb3ZlLm9uKCdjbGljaycsIG1vdmVFdmVudCk7XG5cbiAgLy8gdGhpcyBpcyB0aGUgY2xpY2sgZXZlbnQgZm9yIHRoZSBib29zdCBidXR0b24sIHdoZW4gY2xpY2tlZCBpdCBjaGVja3MgZmlyc3QgdG8gc2VlIGlmIHRoZSBwbGF5ZXIgaGFzIGFscmVhZHkgdXNlZCB0aGVpciBib29zdCwgaWYgbm90IGl0IHVwZGF0ZXMgdGhhdCBpbmZvcm1hdGlvbiBhbmQgcnVucyB0aGUgZGV0ZXJtaW5lVHVybiBmdW5jdGlvbiBsaWtlIGEgbm9ybWFsIG1vdmUsIHdoZW4gdGhpcyByZWFjaGVzIHRoZSBsb2NhdGVHYXJ5IGZ1bmN0aW9uLCBpdCB0YWtlcyBub3RlIHRoYXQgdGhlIGJvb3N0IGhhcyBiZWVuIHVzZWQgdG8gZmlyZSBvZmYgdGhlIGJvb3N0R2FyeSBmdW5jdGlvbiBpbnN0ZWFkIG9mIHRoZSBtb3ZlR2FyeSBmdW5jdGlvbi4gSXQgdGhlbiB1cGRhdGVzIHRoZSBib29zdCByZW1haW5pbmcgYWdhaW4sIHNvIHRoYXQgaWYgYW5vdGhlciBib29zdCBpcyBhdHRlbXB0ZWQsIGl0IGluZm9ybXMgdGhlIHVzZXIgdGhhdCB0aGVpciBib29zdCBoYXMgYWxyZWFkeSBiZWVuIHVzZWQuXG4gIGZ1bmN0aW9uIGJvb3N0RXZlbnQoKXtcbiAgICBpZighaXNPbmVQbGF5ZXIpe1xuXG4gICAgICBpZihwbGF5ZXJPbmVUdXJuKXtcbiAgICAgICAgaWYoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgICRib29zdFNvdW5kLnBsYXkoKTtcbiAgICAgICAgICBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9IDA7XG4gICAgICAgICAgZGV0ZXJtaW5lVHVybigpO1xuICAgICAgICB9IGVsc2UgaWYoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAgICRlcnJvclNvdW5kLnBsYXkoKTtcbiAgICAgICAgICAkdHVyblRleHQudGV4dCgnUGxheWVyIDEgYm9vc3QgYWxyZWFkeSB1c2VkIScpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZihQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9PT0gMSl7XG4gICAgICAgICAgJGJvb3N0U291bmQucGxheSgpO1xuICAgICAgICAgIFBsYXllclR3b0Jvb3N0UmVtYWluaW5nID0gMDtcbiAgICAgICAgICBkZXRlcm1pbmVUdXJuKCk7XG4gICAgICAgIH0gZWxzZSBpZihQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICAgJGVycm9yU291bmQucGxheSgpO1xuICAgICAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMiBib29zdCBhbHJlYWR5IHVzZWQhJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAkdHJhY2sgPSAkKCcudHJhY2sxJyk7XG4gICAgICAgIGluZGV4ID0gJCgnLnRyYWNrMS5wbGF5ZXInKS5pbmRleCgpO1xuICAgICAgICBQbGF5ZXJPbmVCb29zdFJlbWFpbmluZyA9IDI7XG4gICAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMSB1c2VzIGJvb3N0IScpO1xuICAgICAgICBib29zdEdhcnkoKTtcbiAgICAgIH0gZWxzZSBpZiAoUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPT09IDIpe1xuICAgICAgICAkZXJyb3JTb3VuZC5wbGF5KCk7XG4gICAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMSBoYXMgYWxyZWFkeSB1c2VkIGJvb3N0IScpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAkYm9vc3Qub24oJ2NsaWNrJywgYm9vc3RFdmVudCk7XG4gIC8vIGJlbG93IGlzIHRoZSBldmVudCBsaXN0ZW5lciBmb3IgdGhlIHNhbHQgYWJpbGl0eS4gVXNpbmcgdGhpcyB3aWxsIHN0b3AgeW91ciBvcHBvbmVudHMgbmV4dCB0dXJuIGFuZCBnaXZlIGdhcnkgYSBub3JtYWwgZ2FyeU1vdmUgd2hpbGUgdXNpbmcgaXQuIElmIGEgcGxheWVyIGhhcyBhbHJlYWR5IHVzZWQgdGhlaXIgc2FsdCBpdCBpbmZvcm1zIHRoZW0gb24gdGhlICR0dXJuVGV4dCBmZWVkYmFjay5cbiAgZnVuY3Rpb24gc2FsdEV2ZW50KCl7XG4gICAgaWYoIWlzT25lUGxheWVyKXtcbiAgICAgIGlmKHBsYXllck9uZVR1cm4pe1xuICAgICAgICBpZihQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgICAkc2FsdFNvdW5kLnBsYXkoKTtcbiAgICAgICAgICBQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID0gMDtcbiAgICAgICAgICBzYWx0R2FyeSgpO1xuICAgICAgICB9IGVsc2UgaWYoUGxheWVyT25lU2FsdFJlbWFpbmluZyA9PT0gMil7XG4gICAgICAgICAgJGVycm9yU291bmQucGxheSgpO1xuICAgICAgICAgICR0dXJuVGV4dC50ZXh0KCdQbGF5ZXIgMSBoYXMgYWxyZWFkeSB1c2VkIFNhbHQhJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmKFBsYXllclR3b1NhbHRSZW1haW5pbmcgPT09IDEpe1xuICAgICAgICAgICRzYWx0U291bmQucGxheSgpO1xuICAgICAgICAgIFBsYXllclR3b1NhbHRSZW1haW5pbmcgPSAwO1xuICAgICAgICAgIHNhbHRHYXJ5KCk7XG4gICAgICAgIH0gZWxzZSBpZihQbGF5ZXJUd29TYWx0UmVtYWluaW5nID09PSAyKXtcbiAgICAgICAgICAkZXJyb3JTb3VuZC5wbGF5KCk7XG4gICAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAyIGhhcyBhbHJlYWR5IHVzZWQgU2FsdCEnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZihQbGF5ZXJPbmVTYWx0UmVtYWluaW5nID09PSAxKXtcbiAgICAgICAgUGxheWVyT25lU2FsdFJlbWFpbmluZyA9IDA7XG4gICAgICAgICRzYWx0U291bmQucGxheSgpO1xuICAgICAgICBzYWx0R2FyeSgpO1xuICAgICAgfSBlbHNlIGlmKFBsYXllck9uZVNhbHRSZW1haW5pbmcgPT09Mil7XG4gICAgICAgICRlcnJvclNvdW5kLnBsYXkoKTtcbiAgICAgICAgJHR1cm5UZXh0LnRleHQoJ1BsYXllciAxIGhhcyBhbHJlYWR5IHVzZWQgU2FsdCEnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgJHNhbHQub24oJ2NsaWNrJywgc2FsdEV2ZW50KTtcbiAgLy8gQ2xpY2sgZXZlbnQgdG8gc3RhcnQgdGhlIGdhbWUsIHJlbW92ZXMgdGhlIGluc3RydWN0aW9uIHBhZ2UgYW5kIHRoZW4gc2hvd3MgdGhlIHJhY2V0cmFjaywgZmVlZGJhY2sgYm94IGFuZCBjb250cm9sbGVyLiBIYXZlIG1vdmVkIGV2ZW50cyB0aGF0IGhhcHBlbiBpbiBib3RoIHRvIHRoZSBhbHdhc3kgb24gc3RhcnQgZnVuY3Rpb24uXG4gICRzdGFydC5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgYWx3YXlzT25TdGFydCgpO1xuICB9KTtcblxuICAvLyBjbGljayBldmVudCB0byBzdGFydCB0aGUgMXAgb3B0aW9uLlxuICAkc3RhcnQxUGxheWVyLm9uKCdjbGljaycsKCkgPT4ge1xuICAgIGlzT25lUGxheWVyID0gdHJ1ZTtcbiAgICBhbHdheXNPblN0YXJ0KCk7XG4gICAgJHR1cm5UZXh0LnRleHQoJ01ha2UgeW91ciBmaXJzdCBtb3ZlIScpO1xuXG4gIH0pO1xuXG4gIGZ1bmN0aW9uIGFsd2F5c09uU3RhcnQoKXtcbiAgICAkaW5zdHJ1Y3Rpb25zLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJGJvYXJkLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgJGNvbnRyb2xsZXIucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkYXVkaW9UaGVtZS5wbGF5KCk7XG4gIH1cblxuICAvLyBFdmVudCBsaXN0ZW5lciBmb3IgdGhlIHJlc2V0IGJ1dHRvbiwgaXQgYmFzaWNhbGx5IGhpZGVzIGFsbCBvZiB0aGUgZmVlZGJhY2sgZnJvbSB0aGUgcmVtYWluaW5nIGdhbWUgYW5kIG1vdmVzIGJvdGggcGxheWVyIGljb25zIGJhY2sgdG8gdGhlIHN0YXJ0IGxpbmUsIGl0IGFsc28gcmVzZXRzIHRoZSBzYWx0IGFuZCBib29zdCBjb3VudGVycyB0byAxIHNvIHRoYXQgdGhleSBjYW4gbm93IGJlIHVzZWQgYWdhaW4uIGZ1bm5jdGlvbiBiZWxvdyB0aGF0IGlzIHNvbWUgcmVmYWN0b3JpbmcgZm9yIGNvbW1hbmRzIHRoYXQgaGFwcGVuIHJlZ2FyZGxlc3Mgb2YgMXAgb3IgMnAgbW9kZS5cbiAgZnVuY3Rpb24gcmVzZXQoKXtcbiAgICBhbHdheXNPblJlc2V0KCk7XG4gICAgIWlzT25lUGxheWVyID8gJCgnLnBsYXllclR3b1dpbicpLmFkZENsYXNzKCdoaWRlJykgOiAkKCcuYWlXaW4nKS5hZGRDbGFzcygnaGlkZScpO1xuICB9XG4gICRyZXNldC5vbignY2xpY2snLCByZXNldCk7XG5cbiAgZnVuY3Rpb24gYWx3YXlzT25SZXNldCgpe1xuICAgICQoJy50cmFjazEnKS5yZW1vdmVDbGFzcygncGxheWVyIHdpbm5lcicpO1xuICAgICQoJy5zdGFydDEnKS5hZGRDbGFzcygncGxheWVyJyk7XG4gICAgUGxheWVyT25lQm9vc3RSZW1haW5pbmcgPSAxO1xuICAgIFBsYXllck9uZVNhbHRSZW1haW5pbmcgPTE7XG4gICAgJCgnLnRyYWNrMicpLnJlbW92ZUNsYXNzKCdwbGF5ZXIgd2lubmVyJyk7XG4gICAgJCgnLnN0YXJ0MicpLmFkZENsYXNzKCdwbGF5ZXInKTtcbiAgICBQbGF5ZXJUd29Cb29zdFJlbWFpbmluZyA9IDE7XG4gICAgUGxheWVyVHdvU2FsdFJlbWFpbmluZyA9IDE7XG4gICAgcGxheWVyT25lVHJhY2tlciA9IG51bGw7XG4gICAgJCgnLmNvbnRyb2xsZXInKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICQoJy5mZWVkYmFjaycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgJCgnLnJlc3VsdEJveCcpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJCgnLnBsYXllck9uZVdpbicpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJGF1ZGlvVGhlbWUuc3JjID0gJyc7XG4gICAgJGF1ZGlvVGhlbWUuc3JjID0gJ3NvdW5kcy9jbG9zaW5nX3RoZW1lLm1wMyc7XG4gICAgJGF1ZGlvVGhlbWUucGxheSgpO1xuICB9XG59KTtcbiJdfQ==
